<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    
    
    <meta property="article:tag" content="ctf" />
    
    <meta property="article:tag" content="capture-the-flag" />
    
    <meta property="article:tag" content="challenges" />
    
    <meta property="article:tag" content="challenge-write-ups" />
    
    <meta property="article:tag" content="write-ups" />
    
    <meta property="article:tag" content="writeups" />
    
    <meta property="article:tag" content="write-up" />
    
    <meta property="article:tag" content="writeup" />
    
    <meta property="article:tag" content="rootcon" />
    
    <meta property="article:tag" content="rootcon easter egg hunt" />
    
    <meta property="article:tag" content="rootcon-easter-egg-hunt" />
    
    <meta property="article:tag" content="easter egg hunt" />
    
    <meta property="article:tag" content="easter-egg-hunt" />
    
    <meta property="article:tag" content="solutions" />
    
    <meta property="article:tag" content="2020" />
    
    <meta property="article:tag" content="time" />
    
    <meta property="article:tag" content="one time pad" />
    
    <meta property="article:tag" content="one-time-pad" />
    
    <meta property="article:tag" content="key reuse" />
    
    <meta property="article:tag" content="key-reuse" />
    
    <meta property="article:tag" content="stream cipher" />
    
    <meta property="article:tag" content="stream-cipher" />
    
    <meta property="article:tag" content="xor" />
        

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="Time Challenge">
    <meta name="twitter:description" content="These cryptic messages seem to have some similarities. Perhaps the same key was used? Although it is naught but a guess of mine, pray do help in figuring it out. ">
    <meta name="twitter:site" content="@jebidiah-anthony" />
    <meta name="twitter:creator" content="@feeeellliix">

    
    <meta property="og:image" content="https://jebidiah-anthony.github.io/chals/ctf/2020_ROOTCONEasterEggHunt/screenshots/banner.png" />
    

    
    <meta property="og:title" content="Time Challenge" />
    

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Time Challenge | jebidiah-anthony</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Time Challenge" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="These cryptic messages seem to have some similarities. Perhaps the same key was used? Although it is naught but a guess of mine, pray do help in figuring it out." />
<meta property="og:description" content="These cryptic messages seem to have some similarities. Perhaps the same key was used? Although it is naught but a guess of mine, pray do help in figuring it out." />
<link rel="canonical" href="https://jebidiah-anthony.github.io/chals/ctf/2020_ROOTCONEasterEggHunt/Time.html" />
<meta property="og:url" content="https://jebidiah-anthony.github.io/chals/ctf/2020_ROOTCONEasterEggHunt/Time.html" />
<meta property="og:site_name" content="jebidiah-anthony" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"Time Challenge","url":"https://jebidiah-anthony.github.io/chals/ctf/2020_ROOTCONEasterEggHunt/Time.html","description":"These cryptic messages seem to have some similarities. Perhaps the same key was used? Although it is naught but a guess of mine, pray do help in figuring it out.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <style>
      .user_host { color: green; }
      .sys_dir { color: #779ECB; }
      p { color:#aaa; }
      header { margin-bottom: 0px; }
      .header .navbtn {
	position: fixed;
	width: 0px;
	visibility: hidden;
      }
      .header .title { 
	padding-left: 69px;
	vertical-align: middle;
      }
      .header .title h2 { margin: 0; } 

      .container {
	max-width: 1200px;
      }
      .sidebar {
        border-right: 1px dashed #b5e853;
	bottom: 0;
        height: 100%;
	overflow: auto;
	padding: 10px 10px 10px 10px;
        position: fixed;
	top: 0;
        width: 230px;
      }
      .openbtn { 
	color:#b5e853;
	font-size:30px;
	cursor:pointer
      }
      .closebtn {
	color:#b5e853;
	font-size:69px;
	cursor:pointer;
	position:absolute;
	top:0;
	right:25px;
	font-size:36px;
	margin-left:50px;
	visibility:hidden;
      }
      
      .ctf_content {
        margin-left: 250px;
	padding-bottom: 5px;
      }
      .ctf_content h2 {	padding: 20px 0px 0px 10px; }
      .ctf_content h3 { margin: 20px 0px 0px 10px; }
      .ctf_content img {
 	display: block;
	margin-left: auto;
	margin-right: auto;
	max-width: 100%;
	padding: 0 10px 0 0;
      }
      .ctf_content table { padding: 0 15px; }

      #main_content h1 { padding: 20px 0px 0px 8px; }
      #main_content h2, p, pre { 
	padding-right:10px;
	padding-left:15px; 
      }
      #main_content h4 { 
        margin: 20px 0px 10px 0px; 
        padding-left: 25px; 
      }
      #main_content ol, ul { margin: 0 0 0 10px; }

      .highlighter-rouge { padding: 0 10px 0 10px; }

      .section-divider{
        border-bottom: 1.5px solid #b5e853;
        padding-top:28px;
        width:55%;
      }
      
      @media screen and (min-width: 801px) {
	.ctf_content {
          margin-left: 250px;
	  padding-bottom: 5px;
        }
      }
      @media screen and (max-width: 800px) {
        header {
	  background-color: #202020;
	  height: 80px;
	  padding: 0px 0 0 0;
	  position: fixed;
	  top: 0;
	}
        .header .navbtn {
          height: 80px;
	  padding: 18px 0 0 20px;
          visibility: visible;
	  width: 100px;
        }
	.header .title { padding-left: 100px; }
	.header .title h1 { padding-top: 5px; }
        .header .title h2 { margin: 0; }

	.container {
	  width:100%;
	}
	.sidebar {
          width: 0;
          z-index: 1;
          overflow-x: hidden;
	  padding: 0;
          transition: 0.5s;
	}
	.sidebar h2 { 
	  font-size: 18px; 
	  padding: 10px 10px 5px 10px;
	}
	.sidebar div { 
	  font-size: 15px; 
	  padding: 5px 10px 5px 10px;
	}
	.closebtn { visibility:visible; }

	.highlighter-rouge { padding: 0 0 0 0; }

	.ctf_content {
	  margin: 0;
	}
	.ctf_content h2 { padding: 15px 0px 0px 5px; }
        .ctf_content h3 { margin: 15px 10px 0px 15px; }
        .ctf_content img {
	  max-width: 100%;
	  padding: 0 10px 0 0;
        }
	.ctf_content table { 
	  margin: 0 10px 0px -8px;
	  min-width: 800px;
	}

        #main_content { margin-top:80px; }
	#main_content code { font-size: 15px; }
	#main_content h1 { font-size: 25px; }
	#main_content h2 { font-size: 22px; }
	#main_content h3 { font-size: 18px; }
	#main_content h4 { padding-left: 20px; }
	#main_content ol, ul {
	  font-size: 14px;
	  margin: 0 0 0 12px;
	  padding: 0 0 0 25px;
	}
	#main_content table { font-size: 14px; }
      }

      @media screen and (max-width: 480px) {
        header {
	  background-color: #202020;
	  height: 70px;
	  padding: 0px 0 0 0;
	  position: fixed;
	  top: 0;
	}
        .header .navbtn {
          height: 70px;
	  padding: 14px 0 0 18px;
        }
	.header .title { padding-left: 100px; }
	.header .title h1 { font-size:22px; }
        .header .title h2 { font-size:16px; }

	#main_content code { font-size: 13px; }
        #main_content ol, ul {
	  font-size: 13px;
	  margin: 0 0 0 12px;
	  padding: 0 0 0 25px;
	}
	#main_content table { font-size: 13px; }
      }
    </style>

  </head>

  <body>
    <div class="container">
       <div id="sidebar" class="sidebar">
         <span class="closebtn" onclick="closeNav()">&times;</span>      
	 <div><h2 style="margin-bottom:0; padding-top:20px">[SITE PAGES]</h2>

<div style="padding-top:10px">
  
  > <a href="/">whoami</a>
  
</div>
<div style="padding-top:10px">  
  >  <a href="/htb.html">
    
    htb writeups
    
  </a>
</div>
<div style="padding-top:10px">
  > <a href="/ctf.html">
    
    <strong style="color:orange">ctf writeups</strong>
    
  </a>
</div>
<div style="padding-top:10px">
  > <a href="/projects.html">
    
    projects
    
  </a>
</div>
</div>
	 <div style="padding-bottom:20px">
           
	     <h2 style="margin-bottom:0; padding-top: 20px">[HTB CHALLENGES]</h2>


<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/htb/challenges.html#for">
  
  Forensics
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/htb/challenges.html#mob">
  
  Mobile
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/htb/challenges.html#pwn">
  
  Pwn
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/htb/challenges.html#web">
  
  Web
  
  </a>
</div>


             <h2 style="margin-bottom:0; padding-top:20px">[CTF EVENTS]</h2>


<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2020-ROOTCONEasterEggHunt.html">
  
  <strong style="color:orange;text-decoration:none">ROOTCON Easter Egg Hunt 2020</strong>
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-XMASCTF.html">
  
  X-MAS CTF 2019
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-CyberSEAGame.html">
  
  Cyber SEA Game 2019
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-NACTF.html">
  
  NACTF 2019
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-TGHack.html">
  
  TG:Hack 2019
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-TJCTF.html">
  
  TJCTF 2019
  
  </a>
</div>


	   
	 </div>
       </div>
       <div id="content" class="ctf_content">
	 <header>
           <div class="header">
             <div class="navbtn">
               <span class="openbtn" onclick="openNav()">&#9776;</span>
	     </div>
	     <div class="title">
               <h1>jebidiah-anthony</h1>
               <h2 style="padding:0 0 0 0">write-ups and what not</h2>
	     </div>
           </div>
         </header>
         <section id="main_content"><div class="paragraph">
<p><span><h1 style="color:red">Time Challenge</h1></span></p>
</div>
<hr>
<div class="sect1">
<h2 id="part-1-challenge-description">PART 1 : CHALLENGE DESCRIPTION</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Opening the <a href="http://easteregg.rootcon.net/rceaster/time/">challenge</a> brings you to:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./screenshots/time_home.png" alt="time home">
</div>
</div>
<div class="paragraph">
<p>which reads the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>I think someone stole the eggs here.
They were pretty messy. Leaving these crumbs everywhere.
I gathered them for you to compare adventurer. Go forth. Hydaelyn awaits for you valiant success
in uncovering the secrets of these "eggs" that have spawned on the Second Umbral Moon of our time.


Urianger's Notes:

These cryptic messages seem to have some similarities. Perhaps the same key was used?
Although it is naught but a guess of mine, pray do help in figuring it out.

Message 1: 83d7f7966225c71b556cfd1fa28aa1cb364903c74bfad82400a5b8326ebf110cf610Q
Message 2: 8380cb903366dd4b7822ba48a9dacf8b6b4b6aa81df1f14b46afd4736ae9111ee2</pre>
</div>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="part-2-identifying-the-cipher">PART 2 : IDENTIFYING THE CIPHER</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We are given two ciphertexts with lengths <strong>68</strong> and <strong>66</strong> (as hex characters) respectively. Since it has different lengths, I dropped the assumption that it was encrypted using a block cipher which also removes substitution-permutation. Also with the limited given, it doesn&#8217;t seem to involve assymetric cryptography and based on the randomness of each character byte, it doesn&#8217;t look like a direct substitution either.</p>
</div>
<div class="paragraph">
<p>What was said, however, was that <strong style="color:orange">the same key was perhaps used to encrypt</strong> both ciphertexts and the arbitrary lengths led me to believe that the plaintext was hidden using a repeated XOR key or maybe <strong>a One Time Pad which coincides well with the challenge theme</strong>.</p>
</div>
<div class="paragraph">
<p>Other things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There is a <strong><code>Q</code></strong> character at the end of <strong><code>Message1</code></strong> but I found it quite irrelevant.</p>
</li>
<li>
<p>I couldn&#8217;t find a cipher that ends with a <strong><code>Q</code></strong>.</p>
</li>
<li>
<p>Counting it with the ciphertext brings the length to an odd number so I dropped it.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="part-3-getting-the-flag">PART 3 : GETTING THE FLAG</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If this is ineed a <span style="color:orange">One Time Pad</span> and the key was reused for both ciphertexts, then it may be decrypted via a <span style="color:red">Crib Dragging</span> attack.</p>
</div>
<div class="paragraph">
<p><strong style="color:red">Crib Dragging</strong></p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>It is where you decrypt a ciphertext by XORing a known portion of the plaintext then shifting it right until another likely plaintext string is revealed.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>With <strong>One Time Pads</strong>,The ciphertext (\(Ciphertext_n\)) is produced by XORing (\(\oplus\)) the plaintext (\(Message_n\)) and the key (\(K\)) where the key and plaintext has the same length.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><span style="color:orange"> \(Ciphertext_1 = Message_1 \oplus K\) </span></p>
</li>
<li>
<p><span style="color:orange"> \(Ciphertext_2 = Message_2 \oplus K\) </span></p>
</li>
</ol>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>How does this help with the attack?</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Consider this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><span style="color:orange"> \(Ciphertext_1 \oplus Ciphertext_2\) </span></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>By substituting values, we get:</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p><span style="color:orange"> \((Message_1 \oplus K) \oplus (Message_2 \oplus K)\) </span></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>And since the key (\(K\)) is reused for both messages:</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p><span style="color:orange"> \((Message_1 \oplus K) \oplus (Message_2 \oplus K) = Message_1 \oplus Message_2\) </span></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If <strong>\(Ciphertext_1 \oplus Ciphertext_2 = (Message_1 \oplus K) \oplus (Message_2 \oplus K)\)</strong>, then:</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p><span style="color:orange"> \(Ciphertext_1 \oplus Ciphertext_2 = Message_1 \oplus Message_2\) </span></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Which also means that:</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p><span style="color:orange"> \((Ciphertext_1 \oplus Ciphertext_2) \oplus Message_1 = Message_2\) </span></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Which is the general idea of the <strong>crib dragging</strong> attack.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Proceeding to the attack:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Finding the value of <strong>\(Ciphertext_1 \oplus Ciphertext_2\)</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    83d7f7966225c71b556cfd1fa28aa1cb364903c74bfad82400a5b8326ebf110cf610
XOR 8380cb903366dd4b7822ba48a9dacf8b6b4b6aa81df1f14b46afd4736ae9111ee2
------------------------------------------------------------------------
    00573c0651431a502d4e47570b506e405d02696f560b296f460a6c41045600121493</pre>
</div>
</div>
<div class="paragraph">
<p>Now, we guess a portion of the plaintext then encode it in hex. It is advisable to use simple words first but to each their own:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>easter =&gt; 656173746572</pre>
</div>
</div>
<div class="paragraph">
<p>Then, XOR it with the value from <strong>\(Ciphertext_1 \oplus Ciphertext_2\)</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    <mark>00573c065143</mark>1a502d4e47570b506e405d02696f560b296f460a6c41045600121493
XOR <mark>656173746572</mark> (easter)
------------------------------------------------------------------------
    <mark>65364f723431</mark> (e6Or41)</pre>
</div>
</div>
<div class="paragraph">
<p>But the value returned is gibberish, so then we shift the XOR to the right:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    00573c<mark>0651431a502d</mark>4e47570b506e405d02696f560b296f460a6c41045600121493
XOR       <mark>656173746572</mark> (easter)
------------------------------------------------------------------------
          <mark>6330306e355f</mark> (c00n5_)</pre>
</div>
</div>
<div class="paragraph">
<p>Shifting three bytes to the right returns <code>c00n5_</code> which looks like a portion of the flag. Now, trying the flag format, <code>rc_easter{</code> which fits well with the shift returns:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    <mark>00573c0651431a502d4e</mark>47570b506e405d02696f560b296f460a6c41045600121493
XOR <mark>72635f6561737465727b</mark> (rc_easter{)
------------------------------------------------------------------------
    <mark>7234636330306e355f35</mark> (r4cc00n5_5)</pre>
</div>
</div>
<div class="paragraph">
<p>We get the word, <span style="color:orange">r4cc00n5</span>, in 1337 speak followed by what seems to be a word that starts with <span style="color:orange">5</span> (<code>letter S</code>). According to the challenge, eggs were stolen and the image references to an <strong>evil plotting raccoon meme</strong> which made me try to guess the string one word at a time along the lines of <span style="color:red">the raccoons stole the eggs</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre>    00573c0651431a502d4e47570b506e405d02696f560b296f460a6c41045600121493
XOR 7234636330306e355f3574306c335f346c6c5f30665f793075725f336767352121 (r4cc00n5_5t0l3_4ll_0f_y0ur_3gg5!!)
------------------------------------------------------------------------
    72635f6561737465727b336767633174316e365f3054505f337833726331353335 (rc_easter{3ggc1t1n6_0TP_3x3rc1535)</pre>
</div>
</div>
<div class="paragraph">
<p>To my surprise, the flag was revealed.</p>
</div>
</blockquote>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="flag-rc_easter3ggc1t1n6_0tp_3x3rc1535">FLAG : <strong>rc_easter{3ggc1t1n6_0TP_3x3rc1535}</strong></h2>
<div class="sectionbody">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</div>
</div></section>
       </div>
    </div>

    <script>
      function openNav() {
        document.getElementById("sidebar").style.width = "250px";
        document.getElementById("content").style.marginLeft = "250px";
      }
      function closeNav() {
        document.getElementById("sidebar").removeAttribute("style");
        document.getElementById("content").removeAttribute("style");
      } 
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'true', 'auto');
        ga('send', 'pageview');
      </script>
    
  </body>
</html>
