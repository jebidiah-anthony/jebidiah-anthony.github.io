<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    
    
    <meta property="article:tag" content="xmas" />
    
    <meta property="article:tag" content="x-mas" />
    
    <meta property="article:tag" content="xmas ctf" />
    
    <meta property="article:tag" content="x-mas ctf" />
    
    <meta property="article:tag" content="2019" />
    
    <meta property="article:tag" content="ctf" />
    
    <meta property="article:tag" content="challenge" />
    
    <meta property="article:tag" content="writeup" />
    
    <meta property="article:tag" content="write-up" />
    
    <meta property="article:tag" content="solution" />
    
    <meta property="article:tag" content="web" />
    
    <meta property="article:tag" content="web exploitation" />
    
    <meta property="article:tag" content="rigged election" />
    
    <meta property="article:tag" content="md5" />
    
    <meta property="article:tag" content="javascript" />
    
    <meta property="article:tag" content="code audit" />
    
    <meta property="article:tag" content="code auditing" />
    
    <meta property="article:tag" content="scripting" />
        

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="Rigged Election [web 50]">
    <meta name="twitter:description" content="X-MAS CTF 2019 [Web] Rigged Election (50 pts)">
    <meta name="twitter:site" content="@jebidiah-anthony" />
    <meta name="twitter:creator" content="@feeeellliix">

    
    <meta property="og:image" content="https://jebidiah-anthony.github.io/chals/ctf/2019_XMASCTF/xmas_ctf_2019.png" />
    

    
    <meta property="og:title" content="Rigged Election [web 50]" />
    

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Rigged Election [web 50] | jebidiah-anthony</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Rigged Election [web 50]" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="X-MAS CTF 2019 [Web] Rigged Election (50 pts)" />
<meta property="og:description" content="X-MAS CTF 2019 [Web] Rigged Election (50 pts)" />
<link rel="canonical" href="https://jebidiah-anthony.github.io/chals/ctf/2019_XMASCTF/web/3_Rigged_Election.html" />
<meta property="og:url" content="https://jebidiah-anthony.github.io/chals/ctf/2019_XMASCTF/web/3_Rigged_Election.html" />
<meta property="og:site_name" content="jebidiah-anthony" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"Rigged Election [web 50]","url":"https://jebidiah-anthony.github.io/chals/ctf/2019_XMASCTF/web/3_Rigged_Election.html","description":"X-MAS CTF 2019 [Web] Rigged Election (50 pts)","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <style>
      .user_host { color: green; }
      .sys_dir { color: #779ECB; }
      p { color:#aaa; }
      header { margin-bottom: 0px; }
      .header .navbtn {
	position: fixed;
	width: 0px;
	visibility: hidden;
      }
      .header .title { 
	padding-left: 69px;
	vertical-align: middle;
      }
      .header .title h2 { margin: 0; } 

      .container {
	max-width: 1200px;
      }
      .sidebar {
        border-right: 1px dashed #b5e853;
	bottom: 0;
        height: 100%;
	overflow: auto;
	padding: 10px 10px 10px 10px;
        position: fixed;
	top: 0;
        width: 230px;
      }
      .openbtn { 
	color:#b5e853;
	font-size:30px;
	cursor:pointer
      }
      .closebtn {
	color:#b5e853;
	font-size:69px;
	cursor:pointer;
	position:absolute;
	top:0;
	right:25px;
	font-size:36px;
	margin-left:50px;
	visibility:hidden;
      }
      
      .ctf_content {
        margin-left: 250px;
	padding-bottom: 5px;
      }
      .ctf_content h2 {	padding: 20px 0px 0px 10px; }
      .ctf_content h3 { margin: 20px 0px 0px 10px; }
      .ctf_content img {
 	display: block;
	margin-left: auto;
	margin-right: auto;
	max-width: 100%;
	padding: 0 10px 0 0;
      }
      .ctf_content table { padding: 0 15px; }

      #main_content h1 { padding: 20px 0px 0px 8px; }
      #main_content h2, p, pre { 
	padding-right:10px;
	padding-left:15px; 
      }
      #main_content h4 { 
        margin: 20px 0px 10px 0px; 
        padding-left: 25px; 
      }
      #main_content ol, ul { margin: 0 0 0 10px; }

      .highlighter-rouge { padding: 0 10px 0 10px; }

      .section-divider{
        border-bottom: 1.5px solid #b5e853;
        padding-top:28px;
        width:55%;
      }
      
      @media screen and (min-width: 801px) {
	.ctf_content {
          margin-left: 250px;
	  padding-bottom: 5px;
        }
      }
      @media screen and (max-width: 800px) {
        header {
	  background-color: #202020;
	  height: 80px;
	  padding: 0px 0 0 0;
	  position: fixed;
	  top: 0;
	}
        .header .navbtn {
          height: 80px;
	  padding: 18px 0 0 20px;
          visibility: visible;
	  width: 100px;
        }
	.header .title { padding-left: 100px; }
	.header .title h1 { padding-top: 5px; }
        .header .title h2 { margin: 0; }

	.container {
	  width:100%;
	}
	.sidebar {
          width: 0;
          z-index: 1;
          overflow-x: hidden;
	  padding: 0;
          transition: 0.5s;
	}
	.sidebar h2 { 
	  font-size: 18px; 
	  padding: 10px 10px 5px 10px;
	}
	.sidebar div { 
	  font-size: 15px; 
	  padding: 5px 10px 5px 10px;
	}
	.closebtn { visibility:visible; }

	.highlighter-rouge { padding: 0 0 0 0; }

	.ctf_content {
	  margin: 0;
	}
	.ctf_content h2 { padding: 15px 0px 0px 5px; }
        .ctf_content h3 { margin: 15px 10px 0px 15px; }
        .ctf_content img {
	  max-width: 100%;
	  padding: 0 10px 0 0;
        }
	.ctf_content table { 
	  margin: 0 10px 0px -8px;
	  min-width: 800px;
	}

        #main_content { margin-top:80px; }
	#main_content code { font-size: 15px; }
	#main_content h1 { font-size: 25px; }
	#main_content h2 { font-size: 22px; }
	#main_content h3 { font-size: 18px; }
	#main_content h4 { padding-left: 20px; }
	#main_content ol, ul {
	  font-size: 14px;
	  margin: 0 0 0 12px;
	  padding: 0 0 0 25px;
	}
	#main_content table { font-size: 14px; }
      }

      @media screen and (max-width: 480px) {
        header {
	  background-color: #202020;
	  height: 70px;
	  padding: 0px 0 0 0;
	  position: fixed;
	  top: 0;
	}
        .header .navbtn {
          height: 70px;
	  padding: 14px 0 0 18px;
        }
	.header .title { padding-left: 100px; }
	.header .title h1 { font-size:22px; }
        .header .title h2 { font-size:16px; }

	#main_content code { font-size: 13px; }
        #main_content ol, ul {
	  font-size: 13px;
	  margin: 0 0 0 12px;
	  padding: 0 0 0 25px;
	}
	#main_content table { font-size: 13px; }
      }
    </style>

  </head>

  <body>
    <div class="container">
       <div id="sidebar" class="sidebar">
         <span class="closebtn" onclick="closeNav()">&times;</span>      
	 <div><h2 style="margin-bottom:0; padding-top:20px">[SITE PAGES]</h2>

<div style="padding-top:10px">
  
  > <a href="/">whoami</a>
  
</div>
<div style="padding-top:10px">  
  >  <a href="/htb.html">
    
    htb writeups
    
  </a>
</div>
<div style="padding-top:10px">
  > <a href="/ctf.html">
    
    <strong style="color:orange">ctf writeups</strong>
    
  </a>
</div>
<div style="padding-top:10px">
  > <a href="/projects.html">
    
    projects
    
  </a>
</div>
</div>
	 <div style="padding-bottom:20px">
           
	     <h2 style="margin-bottom:0; padding-top: 20px">[HTB CHALLENGES]</h2>


<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/htb/challenges.html#for">
  
  Forensics
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/htb/challenges.html#mob">
  
  Mobile
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/htb/challenges.html#pwn">
  
  Pwn
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/htb/challenges.html#web">
  
  <strong style="color:orange">Web</strong>
  
  </a>
</div>


             <h2 style="margin-bottom:0; padding-top:20px">[CTF EVENTS]</h2>


<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2020-ROOTCONEasterEggHunt.html">
  
  ROOTCON Easter Egg Hunt 2020
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-XMASCTF.html">
  
  <strong style="color:orange;text-decoration:none">X-MAS CTF 2019</strong>
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-CyberSEAGame.html">
  
  Cyber SEA Game 2019
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-NACTF.html">
  
  NACTF 2019
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-TGHack.html">
  
  TG:Hack 2019
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-TJCTF.html">
  
  TJCTF 2019
  
  </a>
</div>


	   
	 </div>
       </div>
       <div id="content" class="ctf_content">
	 <header>
           <div class="header">
             <div class="navbtn">
               <span class="openbtn" onclick="openNav()">&#9776;</span>
	     </div>
	     <div class="title">
               <h1>jebidiah-anthony</h1>
               <h2 style="padding:0 0 0 0">write-ups and what not</h2>
	     </div>
           </div>
         </header>
         <section id="main_content"><h1 id="rigged-election-50-pts"><span style="color:red">Rigged Election (50 pts)</span></h1>

<hr />

<h2 id="part-1--challenge-description">PART 1 : CHALLENGE DESCRIPTION</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Come one, come all! We've opened up a brand new website that allows the Lapland people to vote the next big town hall project! Just upload your ideas on the platform and vote using your CPU power. We've made sure voting takes a great amount of effort, so there's no easy way to play the system.

If you are indeed able to vote more than 250 times, you will be congratulated as an active Lapland citizen and receive a prize worthy of this title.

Remote server: http://challs.xmas.htsp.ro:11001
Author: Milkdrop
Note: The ideas you post are public and logged, posting any X-MAS flags may disqualify your team
Note 2: You must send all 250 votes from the same PHP session, otherwise the server will not be able to send you the flag.
</code></pre></div></div>

<hr />

<h2 id="part-2--viewing-the-source">PART 2 : VIEWING THE SOURCE</h2>

<p>Opening the web application leads you to this page:</p>

<p><img src="./screenshots/3_rigged_election_feed.png" alt="Landing Page" /></p>

<p>The goal is to vote for an idea by pressing <strong style="color:orange">I agree</strong> or <strong style="color:orange">I disagree</strong> more than 250 times using the same session ID.</p>

<p>But how does the voting work?</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"idea special"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;b</span> <span class="na">class=</span><span class="s">"name"</span><span class="nt">&gt;</span>jebidiah<span class="nt">&lt;/b&gt;</span> / 811 Points
	<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"vote"</span><span class="nt">&gt;</span>
						
		<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"agree"</span> <span class="na">onclick=</span><span class="s">"vote(19863, 1)"</span><span class="nt">&gt;</span>(I agree)<span class="nt">&lt;/div&gt;</span> / 
						
		<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"disagree"</span> <span class="na">onclick=</span><span class="s">"vote(19863, 0)"</span><span class="nt">&gt;</span>(I disagree)<span class="nt">&lt;/div&gt;</span>
	<span class="nt">&lt;/div&gt;</span>
	<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"ideaText"</span><span class="nt">&gt;</span>bakanaman<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>

...omitted...

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"/index.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div></div>

<p>Voting triggers a <strong><code class="highlighter-rouge">vote()</code></strong> function which uses the idea ID and a boolean value as parameters.</p>

<p>Looking at the included javascript file:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">generateRandom</span> <span class="p">(</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">characters</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789</span><span class="dl">'</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">charactersLength</span> <span class="o">=</span> <span class="nx">characters</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
        <span class="nx">result</span> <span class="o">+=</span> <span class="nx">characters</span><span class="p">.</span><span class="nx">charAt</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span> <span class="p">()</span> <span class="o">*</span> <span class="nx">charactersLength</span><span class="p">));</span>

        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">vote</span> <span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">upvote</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">xhttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span> <span class="p">();</span>
    <span class="nx">xhttp</span><span class="p">.</span><span class="nx">open</span> <span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">/vote.php?g=1</span><span class="dl">"</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="nx">xhttp</span><span class="p">.</span><span class="nx">send</span> <span class="p">();</span>
    <span class="kd">var</span> <span class="nx">work</span> <span class="o">=</span> <span class="nx">xhttp</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">statusElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span> <span class="p">(</span><span class="dl">"</span><span class="s2">status</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">statusElement</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">status</span><span class="dl">"</span><span class="p">;</span>
    <span class="nx">statusElement</span><span class="p">.</span><span class="nx">innerText</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">CPU Voting on Idea #</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">id</span> <span class="o">+</span> <span class="dl">"</span><span class="s2"> ...</span><span class="dl">"</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">found</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="nx">found</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">var</span> <span class="nx">randomLength</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span> <span class="p">(</span><span class="mi">7</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span> <span class="p">()</span> <span class="o">*</span> <span class="mi">18</span><span class="p">);</span>
	<span class="kd">var</span> <span class="nx">stringGen</span> <span class="o">=</span> <span class="nx">generateRandom</span> <span class="p">(</span><span class="nx">randomLength</span><span class="p">);</span>
	<span class="kd">var</span> <span class="nx">md5Gen</span> <span class="o">=</span> <span class="nx">md5</span> <span class="p">(</span><span class="dl">"</span><span class="s2">watch__bisqwit__</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">stringGen</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="nx">md5Gen</span><span class="p">.</span><span class="nx">substring</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">work</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">localeCompare</span> <span class="p">(</span><span class="nx">work</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
	    <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/vote.php?id=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">id</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;h=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">stringGen</span><span class="p">;</span>
	    <span class="k">if</span> <span class="p">(</span><span class="nx">upvote</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span>
		<span class="nx">url</span> <span class="o">+=</span> <span class="dl">"</span><span class="s2">&amp;u=1</span><span class="dl">"</span><span class="p">;</span>

	    <span class="nx">xhttp</span><span class="p">.</span><span class="nx">open</span> <span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
	    <span class="nx">xhttp</span><span class="p">.</span><span class="nx">send</span> <span class="p">();</span>
	    <span class="nx">found</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
	<span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="program-flow">PROGRAM FLOW</h3>

<ol>
  <li>A request to <strong><code class="highlighter-rouge">/vote.php?g=1</code></strong> is made to get <strong><code class="highlighter-rouge">work</code></strong> (a 6 character long hex string)</li>
  <li>A random string with characters from <strong><code class="highlighter-rouge">[a-zA-Z0-9]</code></strong> and with length 7-25 is generated.</li>
  <li>The randomly generated string id concatenated to the string <strong><code class="highlighter-rouge">watch__bisqwit__</code></strong></li>
  <li>The newly formed string is then hashed using MD5 and if its first 6 characters matches with <strong><code class="highlighter-rouge">work</code></strong>, the vote is counted.</li>
</ol>

<p>The value of <strong><code class="highlighter-rouge">work</code></strong> changes with each attempt to vote.</p>

<hr />

<h2 id="part-3--getting-the-flag">PART 3 : GETTING THE FLAG</h2>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">requests</span> <span class="k">as</span> <span class="n">r</span>

<span class="c1">#session = { "PHPSESSID": "s5jb4edoqsl1njt0jcnhkgtks1" }
</span><span class="n">session</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"PHPSESSID"</span><span class="p">:</span> <span class="s">"d9lie5oloqadnfrjlvrnhdaouj"</span> <span class="p">}</span>

<span class="k">def</span> <span class="nf">get_work</span><span class="p">():</span>

    <span class="n">work</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://challs.xmas.htsp.ro:11001/vote.php?g=1"</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">work</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">generate_work</span><span class="p">(</span><span class="n">stringGen</span><span class="p">):</span>

    <span class="n">md5</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>
    <span class="n">md5</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="s">"watch__bisqwit__"</span> <span class="o">+</span> <span class="n">stringGen</span><span class="p">))</span>
    <span class="n">md5_hex</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">md5</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">md5_hex</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>

    <span class="n">characters</span> <span class="o">=</span> <span class="s">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>
    <span class="n">length</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">char_indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">)]</span>

    <span class="n">vote_ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">possible_works</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">vote_ctr</span> <span class="o">&lt;</span> <span class="mi">252</span><span class="p">:</span>

        <span class="n">work</span> <span class="o">=</span> <span class="n">get_work</span><span class="p">()</span>

        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>

            <span class="n">stringGen</span> <span class="o">=</span> <span class="n">possible_works</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">stringGen</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"id"</span><span class="p">:</span> <span class="mi">19863</span><span class="p">,</span> <span class="s">"h"</span><span class="p">:</span> <span class="n">stringGen</span><span class="p">,</span> <span class="s">"u"</span><span class="p">:</span> <span class="mi">1</span> <span class="p">}</span> 
                <span class="n">req</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://challs.xmas.htsp.ro:11001/vote.php"</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
                <span class="n">vote_ctr</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="k">print</span><span class="p">(</span><span class="n">vote_ctr</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">possible_works</span><span class="p">[</span><span class="n">work</span><span class="p">])</span>
                <span class="k">print</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                <span class="k">break</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">stringGen</span> <span class="o">=</span> <span class="s">""</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">characters</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">char_indices</span><span class="p">])</span>

                <span class="n">new_work</span> <span class="o">=</span> <span class="n">generate_work</span><span class="p">(</span><span class="n">stringGen</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">possible_works</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">new_work</span><span class="p">,</span> <span class="bp">True</span><span class="p">):</span>
                    <span class="n">possible_works</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">new_work</span><span class="p">,</span> <span class="n">stringGen</span><span class="p">)</span>

                <span class="n">char_indices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">char_indices</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">characters</span><span class="p">):</span> 
                        <span class="n">char_indices</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="n">char_indices</span><span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span> <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<p>My solution initializes an empty dictionary which is serve as a lookup table for found “<strong><code class="highlighter-rouge">work</code></strong>” values; otherwise, the program will add unique “<strong><code class="highlighter-rouge">work</code></strong>” values to the dictionary until the required value is found.</p>

<p>Executing the program:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>199, <span class="s1">'e25810'</span>, <span class="s1">'ADCV2Y'</span><span class="o">)</span>
Your md5 is: e25810e0ac4307b0eb6ad372259b95ae&lt;br&gt;Work required is: e25810&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>200, <span class="s1">'39f8ad'</span>, <span class="s1">'ABh1Yl'</span><span class="o">)</span>
Your md5 is: 39f8adc872b073969742aa611cc513e1&lt;br&gt;Work required is: 39f8ad&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>201, <span class="s1">'2d590f'</span>, <span class="s1">'AA5O4y'</span><span class="o">)</span>
Your md5 is: 2d590f28ab656e81f30a9b7ab937f6ba&lt;br&gt;Work required is: 2d590f&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>202, <span class="s1">'f94710'</span>, <span class="s1">'AAHOJv'</span><span class="o">)</span>
Your md5 is: f94710ed72c9c86b752fc59937a51db2&lt;br&gt;Work required is: f94710&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>203, <span class="s1">'8cb7a2'</span>, <span class="s1">'ABF0vM'</span><span class="o">)</span>
Your md5 is: 8cb7a2d386f3fd72e0ef89e006c91c2f&lt;br&gt;Work required is: 8cb7a2&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>204, <span class="s1">'40c367'</span>, <span class="s1">'AAe1Jy'</span><span class="o">)</span>
Your md5 is: 40c367d81026896b6c9ca6ff9511a7b1&lt;br&gt;Work required is: 40c367&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>205, <span class="s1">'83491d'</span>, <span class="s1">'ABDCe7'</span><span class="o">)</span>
Your md5 is: 83491dffa9597ac9bff79b0c7cec0bcc&lt;br&gt;Work required is: 83491d&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>206, <span class="s1">'d4aef2'</span>, <span class="s1">'AEFEkZ'</span><span class="o">)</span>
Your md5 is: d4aef2796d5d40093d63be6bd8a5cd23&lt;br&gt;Work required is: d4aef2&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>207, <span class="s1">'3187d0'</span>, <span class="s1">'AA5gj8'</span><span class="o">)</span>
Your md5 is: 3187d085884578273467eda5f61b554e&lt;br&gt;Work required is: 3187d0&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>208, <span class="s1">'f358ea'</span>, <span class="s1">'ACBhv8'</span><span class="o">)</span>
Your md5 is: f358ea5338abfe00f7fa262263144df9&lt;br&gt;Work required is: f358ea&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>209, <span class="s1">'041ca5'</span>, <span class="s1">'ACsDY9'</span><span class="o">)</span>
Your md5 is: 041ca5eed5801155bb0323b4379f4c81&lt;br&gt;Work required is: 041ca5&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>210, <span class="s1">'d536e1'</span>, <span class="s1">'AAAu5b'</span><span class="o">)</span>
Your md5 is: d536e1856b834891f5f3bd23984fe6e3&lt;br&gt;Work required is: d536e1&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>211, <span class="s1">'d6e5ac'</span>, <span class="s1">'ABDOTg'</span><span class="o">)</span>
Your md5 is: d6e5ac73375f55d8974270bed9d6c601&lt;br&gt;Work required is: d6e5ac&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>212, <span class="s1">'896cfa'</span>, <span class="s1">'AAaD59'</span><span class="o">)</span>
Your md5 is: 896cfaf0d18c41a1ecb5b9af788d1cd8&lt;br&gt;Work required is: 896cfa&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>213, <span class="s1">'73189e'</span>, <span class="s1">'ABIdrf'</span><span class="o">)</span>
Your md5 is: 73189ed7a28a4906176dcc5c85e72ba8&lt;br&gt;Work required is: 73189e&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>214, <span class="s1">'5263ab'</span>, <span class="s1">'ABbPSI'</span><span class="o">)</span>
Your md5 is: 5263abf6d3bcd8b018162b1dc734f68a&lt;br&gt;Work required is: 5263ab&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>215, <span class="s1">'823c6d'</span>, <span class="s1">'AAmoNa'</span><span class="o">)</span>
Your md5 is: 823c6da3d235e6cda95cbfbf06d00222&lt;br&gt;Work required is: 823c6d&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>216, <span class="s1">'06f182'</span>, <span class="s1">'ABZSrF'</span><span class="o">)</span>
Your md5 is: 06f182f1debc17a57e57b129e8f2a575&lt;br&gt;Work required is: 06f182&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>217, <span class="s1">'e17963'</span>, <span class="s1">'AJIGSz'</span><span class="o">)</span>
Your md5 is: e17963c13643cc7dd550c4f50e9dada8&lt;br&gt;Work required is: e17963&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>218, <span class="s1">'21a58f'</span>, <span class="s1">'ACZ8pn'</span><span class="o">)</span>
Your md5 is: 21a58f1a316d46efbaab9b72fd2ed9b8&lt;br&gt;Work required is: 21a58f&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>219, <span class="s1">'e5f301'</span>, <span class="s1">'AAiTZE'</span><span class="o">)</span>
Your md5 is: e5f30138b55a61a0160dab1c8854534a&lt;br&gt;Work required is: e5f301&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>220, <span class="s1">'86327b'</span>, <span class="s1">'AABXOz'</span><span class="o">)</span>
Your md5 is: 86327ba71421e4f15a12e68014964deb&lt;br&gt;Work required is: 86327b&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>221, <span class="s1">'d04195'</span>, <span class="s1">'ABKm3I'</span><span class="o">)</span>
Your md5 is: d04195c1e36578086d025cfa58704fc7&lt;br&gt;Work required is: d04195&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>222, <span class="s1">'b3108a'</span>, <span class="s1">'ABEHVu'</span><span class="o">)</span>
Your md5 is: b3108aa40efdcae667cd12580331cef0&lt;br&gt;Work required is: b3108a&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>223, <span class="s1">'e79b14'</span>, <span class="s1">'AAINhM'</span><span class="o">)</span>
Your md5 is: e79b14fbfb48e6cb9e40ffc6a0522093&lt;br&gt;Work required is: e79b14&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>224, <span class="s1">'14d579'</span>, <span class="s1">'AAhXC7'</span><span class="o">)</span>
Your md5 is: 14d5791141fdab3519fbf91184a1bce6&lt;br&gt;Work required is: 14d579&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>225, <span class="s1">'1a378f'</span>, <span class="s1">'AAImvS'</span><span class="o">)</span>
Your md5 is: 1a378f8c602351fa2ac09e87777230de&lt;br&gt;Work required is: 1a378f&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>226, <span class="s1">'9a03de'</span>, <span class="s1">'AAMelU'</span><span class="o">)</span>
Your md5 is: 9a03defc2743a605a01860e1d7885b75&lt;br&gt;Work required is: 9a03de&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>227, <span class="s1">'d69a1c'</span>, <span class="s1">'AEMBAR'</span><span class="o">)</span>
Your md5 is: d69a1c1c3d6c6b27419605624ca113e6&lt;br&gt;Work required is: d69a1c&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>228, <span class="s1">'06349e'</span>, <span class="s1">'AA29f4'</span><span class="o">)</span>
Your md5 is: 06349e1b27f7d87fc8e477f9cbb4d9d8&lt;br&gt;Work required is: 06349e&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>229, <span class="s1">'ce4d56'</span>, <span class="s1">'ACH3ij'</span><span class="o">)</span>
Your md5 is: ce4d56d2ee7b206864191795be555d64&lt;br&gt;Work required is: ce4d56&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>230, <span class="s1">'ac210d'</span>, <span class="s1">'ACphHF'</span><span class="o">)</span>
Your md5 is: ac210dd089b4a95781b638d0e72dce25&lt;br&gt;Work required is: ac210d&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>231, <span class="s1">'abdcf2'</span>, <span class="s1">'AAwyDF'</span><span class="o">)</span>
Your md5 is: abdcf2a27c60e6cd8c90bb2381b857d6&lt;br&gt;Work required is: abdcf2&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>232, <span class="s1">'2e6fa7'</span>, <span class="s1">'AALEgC'</span><span class="o">)</span>
Your md5 is: 2e6fa789c2d62aec8c4043a256c8b1dd&lt;br&gt;Work required is: 2e6fa7&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>233, <span class="s1">'be3a81'</span>, <span class="s1">'AC72a4'</span><span class="o">)</span>
Your md5 is: be3a81655a10622d30946a1ba33961c3&lt;br&gt;Work required is: be3a81&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>234, <span class="s1">'b2f8cd'</span>, <span class="s1">'AAUWRl'</span><span class="o">)</span>
Your md5 is: b2f8cd836d97ae228b5b32623384b85d&lt;br&gt;Work required is: b2f8cd&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>235, <span class="s1">'e5b8ac'</span>, <span class="s1">'AASjX6'</span><span class="o">)</span>
Your md5 is: e5b8ac4581129b925175549e2cafa10a&lt;br&gt;Work required is: e5b8ac&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>236, <span class="s1">'039fd7'</span>, <span class="s1">'AAD4yL'</span><span class="o">)</span>
Your md5 is: 039fd7a2519092980eeacd5d7ca7b64b&lt;br&gt;Work required is: 039fd7&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>237, <span class="s1">'95e0a2'</span>, <span class="s1">'AAVwZX'</span><span class="o">)</span>
Your md5 is: 95e0a2c231a4df83c839d507089ed2e3&lt;br&gt;Work required is: 95e0a2&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>238, <span class="s1">'260df1'</span>, <span class="s1">'ABn7wD'</span><span class="o">)</span>
Your md5 is: 260df14c25dc5c817483779d589732da&lt;br&gt;Work required is: 260df1&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>239, <span class="s1">'1c9d38'</span>, <span class="s1">'ABKBmM'</span><span class="o">)</span>
Your md5 is: 1c9d38a88edcade21c241897376c6acb&lt;br&gt;Work required is: 1c9d38&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>240, <span class="s1">'5b4a16'</span>, <span class="s1">'AA1nzJ'</span><span class="o">)</span>
Your md5 is: 5b4a1668046308f403ede1a164b22fc8&lt;br&gt;Work required is: 5b4a16&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>241, <span class="s1">'97a4d2'</span>, <span class="s1">'ABK4Ua'</span><span class="o">)</span>
Your md5 is: 97a4d24e5b28e1c3ca53fd7bad1365ed&lt;br&gt;Work required is: 97a4d2&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>242, <span class="s1">'623e95'</span>, <span class="s1">'ABRhcT'</span><span class="o">)</span>
Your md5 is: 623e95190811435da9cf6350f9aadd45&lt;br&gt;Work required is: 623e95&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>243, <span class="s1">'098157'</span>, <span class="s1">'ACTXzx'</span><span class="o">)</span>
Your md5 is: 0981574288f437cba970575f1186c710&lt;br&gt;Work required is: 098157&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>244, <span class="s1">'f49b03'</span>, <span class="s1">'ABHyXq'</span><span class="o">)</span>
Your md5 is: f49b036fa611e0fce1f0ed947ff212b6&lt;br&gt;Work required is: f49b03&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>245, <span class="s1">'f8c697'</span>, <span class="s1">'ABkUCq'</span><span class="o">)</span>
Your md5 is: f8c69736ffda7e1b08d32767d1449685&lt;br&gt;Work required is: f8c697&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>246, <span class="s1">'f6d8e5'</span>, <span class="s1">'AAWAIp'</span><span class="o">)</span>
Your md5 is: f6d8e5dc8be18b7cd2239f687ff58f8d&lt;br&gt;Work required is: f6d8e5&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>247, <span class="s1">'0df37b'</span>, <span class="s1">'AAHPmE'</span><span class="o">)</span>
Your md5 is: 0df37b1da1f19ba979b9a1830a26e55c&lt;br&gt;Work required is: 0df37b&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>248, <span class="s1">'b342f1'</span>, <span class="s1">'ABtRnJ'</span><span class="o">)</span>
Your md5 is: b342f194116e3a8c256e32bee0a482b1&lt;br&gt;Work required is: b342f1&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>249, <span class="s1">'526bed'</span>, <span class="s1">'AA10ec'</span><span class="o">)</span>
Your md5 is: 526bedf3995272b65e3cccc3811035f0&lt;br&gt;Work required is: 526bed&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>250, <span class="s1">'359cd4'</span>, <span class="s1">'ACdSvm'</span><span class="o">)</span>
Your md5 is: 359cd4b7639165215f424f70504b66bf&lt;br&gt;Work required is: 359cd4&lt;br&gt;Work confirmed. Your vote has been registered.
<span class="o">(</span>251, <span class="s1">'1f29b6'</span>, <span class="s1">'AAcVY1'</span><span class="o">)</span>
Your md5 is: 1f29b6a10128ae69db7c6f6982fe54f0&lt;br&gt;Work required is: 1f29b6&lt;br&gt;Work confirmed. Your vote has been registered.
</code></pre></div></div>

<p>Now looking back at the idea posted:</p>

<p><img src="./screenshots/rigged_election_jebidiah.png" alt="jebidiah bakanaman" /></p>

<p>And requesting the page once again with the <strong><code class="highlighter-rouge">PHSSESSID</code></strong> used for voting:</p>

<p><img src="./screenshots/rigged_election_flag.png" alt="Rigged Election Flag" /></p>

<hr />

<div style="width:100%;overflow-x:auto"><h2>FLAG : <strong>X-MAS{NASA_aint_got_n0thin_on_m3}</strong></h2></div>
</section>
       </div>
    </div>

    <script>
      function openNav() {
        document.getElementById("sidebar").style.width = "250px";
        document.getElementById("content").style.marginLeft = "250px";
      }
      function closeNav() {
        document.getElementById("sidebar").removeAttribute("style");
        document.getElementById("content").removeAttribute("style");
      } 
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'true', 'auto');
        ga('send', 'pageview');
      </script>
    
  </body>
</html>
