<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    
    
    <meta property="article:tag" content="ctf" />
    
    <meta property="article:tag" content="capture-the-flag" />
    
    <meta property="article:tag" content="challenges" />
    
    <meta property="article:tag" content="challenge-write-ups" />
    
    <meta property="article:tag" content="write-ups" />
    
    <meta property="article:tag" content="writeups" />
    
    <meta property="article:tag" content="write-up" />
    
    <meta property="article:tag" content="writeup" />
    
    <meta property="article:tag" content="rootcon" />
    
    <meta property="article:tag" content="rootcon easter egg hunt" />
    
    <meta property="article:tag" content="rootcon-easter-egg-hunt" />
    
    <meta property="article:tag" content="easter egg hunt" />
    
    <meta property="article:tag" content="easter-egg-hunt" />
    
    <meta property="article:tag" content="solutions" />
    
    <meta property="article:tag" content="2020" />
    
    <meta property="article:tag" content="mind" />
        

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="Mind Challenge">
    <meta name="twitter:description" content="If you're reading this‌‌‌‌‍‬‌, the second part of the secret is in this file. Look closely and do it fast! Bonny Stark and the whole world is waiting. The first one, well.. if you‌‌‌‌‌‌‌'re really from Eggshield you should be able to figure it out. Let's go back in time :)">
    <meta name="twitter:site" content="@jebidiah-anthony" />
    <meta name="twitter:creator" content="@feeeellliix">

    
    <meta property="og:image" content="https://jebidiah-anthony.github.io/chals/ctf/2020_ROOTCONEasterEggHunt/screenshots/banner.png" />
    

    
    <meta property="og:title" content="Mind Challenge" />
    

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Mind Challenge | jebidiah-anthony</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Mind Challenge" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="If you’re reading this‌‌‌‌‍‬‌, the second part of the secret is in this file. Look closely and do it fast! Bonny Stark and the whole world is waiting. The first one, well.. if you‌‌‌‌‌‌‌’re really from Eggshield you should be able to figure it out. Let’s go back in time :)" />
<meta property="og:description" content="If you’re reading this‌‌‌‌‍‬‌, the second part of the secret is in this file. Look closely and do it fast! Bonny Stark and the whole world is waiting. The first one, well.. if you‌‌‌‌‌‌‌’re really from Eggshield you should be able to figure it out. Let’s go back in time :)" />
<link rel="canonical" href="https://jebidiah-anthony.github.io/chals/ctf/2020_ROOTCONEasterEggHunt/Mind.html" />
<meta property="og:url" content="https://jebidiah-anthony.github.io/chals/ctf/2020_ROOTCONEasterEggHunt/Mind.html" />
<meta property="og:site_name" content="jebidiah-anthony" />
<script type="application/ld+json">
{"description":"If you’re reading this‌‌‌‌‍‬‌, the second part of the secret is in this file. Look closely and do it fast! Bonny Stark and the whole world is waiting. The first one, well.. if you‌‌‌‌‌‌‌’re really from Eggshield you should be able to figure it out. Let’s go back in time :)","@type":"WebPage","headline":"Mind Challenge","url":"https://jebidiah-anthony.github.io/chals/ctf/2020_ROOTCONEasterEggHunt/Mind.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <style>
      .user_host { color: green; }
      .sys_dir { color: #779ECB; }
      p { color:#aaa; }
      header { margin-bottom: 0px; }
      .header .navbtn {
	position: fixed;
	width: 0px;
	visibility: hidden;
      }
      .header .title { 
	padding-left: 69px;
	vertical-align: middle;
      }
      .header .title h2 { margin: 0; } 

      .container {
	max-width: 1200px;
      }
      .sidebar {
        border-right: 1px dashed #b5e853;
	bottom: 0;
        height: 100%;
	overflow: auto;
	padding: 10px 10px 10px 10px;
        position: fixed;
	top: 0;
        width: 230px;
      }
      .openbtn { 
	color:#b5e853;
	font-size:30px;
	cursor:pointer
      }
      .closebtn {
	color:#b5e853;
	font-size:69px;
	cursor:pointer;
	position:absolute;
	top:0;
	right:25px;
	font-size:36px;
	margin-left:50px;
	visibility:hidden;
      }
      
      .ctf_content {
        margin-left: 250px;
	padding-bottom: 5px;
      }
      .ctf_content h2 {	padding: 20px 0px 0px 10px; }
      .ctf_content h3 { margin: 20px 0px 0px 10px; }
      .ctf_content img {
 	display: block;
	margin-left: auto;
	margin-right: auto;
	max-width: 100%;
	padding: 0 10px 0 0;
      }
      .ctf_content table { padding: 0 15px; }

      #main_content h1 { padding: 20px 0px 0px 8px; }
      #main_content h2, p, pre { 
	padding-right:10px;
	padding-left:15px; 
      }
      #main_content h4 { 
        margin: 20px 0px 10px 0px; 
        padding-left: 25px; 
      }
      #main_content ol, ul { margin: 0 0 0 10px; }

      .highlighter-rouge { padding: 0 10px 0 10px; }

      .section-divider{
        border-bottom: 1.5px solid #b5e853;
        padding-top:28px;
        width:55%;
      }
      
      @media screen and (min-width: 801px) {
	.ctf_content {
          margin-left: 250px;
	  padding-bottom: 5px;
        }
      }
      @media screen and (max-width: 800px) {
        header {
	  background-color: #202020;
	  height: 80px;
	  padding: 0px 0 0 0;
	  position: fixed;
	  top: 0;
	}
        .header .navbtn {
          height: 80px;
	  padding: 18px 0 0 20px;
          visibility: visible;
	  width: 100px;
        }
	.header .title { padding-left: 100px; }
	.header .title h1 { padding-top: 5px; }
        .header .title h2 { margin: 0; }

	.container {
	  width:100%;
	}
	.sidebar {
          width: 0;
          z-index: 1;
          overflow-x: hidden;
	  padding: 0;
          transition: 0.5s;
	}
	.sidebar h2 { 
	  font-size: 18px; 
	  padding: 10px 10px 5px 10px;
	}
	.sidebar div { 
	  font-size: 15px; 
	  padding: 5px 10px 5px 10px;
	}
	.closebtn { visibility:visible; }

	.highlighter-rouge { padding: 0 0 0 0; }

	.ctf_content {
	  margin: 0;
	}
	.ctf_content h2 { padding: 15px 0px 0px 5px; }
        .ctf_content h3 { margin: 15px 10px 0px 15px; }
        .ctf_content img {
	  max-width: 100%;
	  padding: 0 10px 0 0;
        }
	.ctf_content table { 
	  margin: 0 10px 0px -8px;
	  min-width: 800px;
	}

        #main_content { margin-top:80px; }
	#main_content code { font-size: 15px; }
	#main_content h1 { font-size: 25px; }
	#main_content h2 { font-size: 22px; }
	#main_content h3 { font-size: 18px; }
	#main_content h4 { padding-left: 20px; }
	#main_content ol, ul {
	  font-size: 14px;
	  margin: 0 0 0 12px;
	  padding: 0 0 0 25px;
	}
	#main_content table { font-size: 14px; }
      }

      @media screen and (max-width: 480px) {
        header {
	  background-color: #202020;
	  height: 70px;
	  padding: 0px 0 0 0;
	  position: fixed;
	  top: 0;
	}
        .header .navbtn {
          height: 70px;
	  padding: 14px 0 0 18px;
        }
	.header .title { padding-left: 100px; }
	.header .title h1 { font-size:22px; }
        .header .title h2 { font-size:16px; }

	#main_content code { font-size: 13px; }
        #main_content ol, ul {
	  font-size: 13px;
	  margin: 0 0 0 12px;
	  padding: 0 0 0 25px;
	}
	#main_content table { font-size: 13px; }
      }
    </style>

  </head>

  <body>
    <div class="container">
       <div id="sidebar" class="sidebar">
         <span class="closebtn" onclick="closeNav()">&times;</span>      
	 <div><h2 style="margin-bottom:0; padding-top:20px">[SITE PAGES]</h2>

<div style="padding-top:10px">
  
  > <a href="/">whoami</a>
  
</div>
<div style="padding-top:10px">  
  >  <a href="/htb.html">
    
    htb writeups
    
  </a>
</div>
<div style="padding-top:10px">
  > <a href="/ctf.html">
    
    <strong style="color:orange">ctf writeups</strong>
    
  </a>
</div>
<div style="padding-top:10px">
  > <a href="/projects.html">
    
    projects
    
  </a>
</div>
</div>
	 <div style="padding-bottom:20px">
           
	     <h2 style="margin-bottom:0; padding-top: 20px">[HTB CHALLENGES]</h2>


<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/htb/challenges.html#for">
  
  Forensics
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/htb/challenges.html#mob">
  
  Mobile
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/htb/challenges.html#pwn">
  
  Pwn
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/htb/challenges.html#web">
  
  Web
  
  </a>
</div>


             <h2 style="margin-bottom:0; padding-top:20px">[CTF EVENTS]</h2>


<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2020-ROOTCON_CTF_Finals.html">
  
  ROOTCON CTF Finals 2020
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2020-ROOTCONEasterEggHunt.html">
  
  <strong style="color:orange;text-decoration:none">ROOTCON Easter Egg Hunt 2020</strong>
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-XMASCTF.html">
  
  X-MAS CTF 2019
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-CyberSEAGame.html">
  
  Cyber SEA Game 2019
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-NACTF.html">
  
  NACTF 2019
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-TGHack.html">
  
  TG:Hack 2019
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="https://jebidiah-anthony.github.io/chals/ctf/2019-TJCTF.html">
  
  TJCTF 2019
  
  </a>
</div>


	   
	 </div>
       </div>
       <div id="content" class="ctf_content">
	 <header>
           <div class="header">
             <div class="navbtn">
               <span class="openbtn" onclick="openNav()">&#9776;</span>
	     </div>
	     <div class="title">
               <h1>jebidiah-anthony</h1>
               <h2 style="padding:0 0 0 0">write-ups and what not</h2>
	     </div>
           </div>
         </header>
         <section id="main_content"><div class="paragraph">
<p><span><h1 style="color:red">Mind Challenge</h1></span></p>
</div>
<hr>
<div class="sect1">
<h2 id="part-1-given-files">PART 1 : GIVEN FILES</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>mind.tar.gz (The file is too big to host&#8230;&#8203;)</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span><span class="nb">md5sum </span>mind.tar.gz

  b38fd751f8fc2ccd8dc292ef5285b2d3  mind.tar.gz

<span class="nv">$ </span><span class="nb">sha1sum </span>mind.tar.gz

  aa4300366226b596cce3b85e89b30795d6b3e0c3  mind.tar.gz

<span class="nv">$ </span><span class="nb">gzip</span> <span class="nt">-d</span> mind.tar.gz

<span class="nv">$ </span><span class="nb">tar </span>xvf mind.tar.gz

  mind/hint.txt
  mind/To Wanda.txt
  mind/vision</code></pre>
</div>
</div>
</blockquote>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="part-2-a-message-to-wanda">PART 2 : A MESSAGE TO WANDA</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The file, <span style="color:orange"><code>To Wanda.txt</code></span>, contains what the challenge is all about. I cleaned it a little bit so it reads:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="listingblock">
<div class="content">
<pre>If you're reading this, I sacrificed my thoughts and memories to protect the‌‌‌‌‍‬‬‌ Mind Egg.

To protect you.

Doing so will make me forget you and every moment we had together.

But doing so also gives us more time to spend new memories once this is all over.


Love,

Victor
---------------------‌‌‌‌‍‍-------------------------------------------------------------------
Eggshield Agent,

If you're reading this‌‌‌‌‍‬‌, the second part of the secret is in this file. Look closely and do it fast! Bonny Stark and the whole world is waiting.

The first one, well.. if you‌‌‌‌‌'re really from Eggshield you should be able to figure it out. Let's go back in time :)

Once you ‌‌‌‌‍‍‬have the secret, use that to open the deepest part of my memories. My treasures.

Lastly, please do tell the Avengersto take care of Wanda for me.

Till then,
Victor</pre>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>A secret is split into two&#8201;&#8212;&#8201;in the file itself,  <span style="color:orange"><code>To Wanda.txt</code></span>, and in the file, <span style="color:orange"><code>vision</code></span></p>
</div>
<div class="paragraph">
<p>Looking back at the hexdump of the original <span style="color:orange"><code>To Wanda.txt</code></span>:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span><span class="nb">cat </span>To<span class="se">\ </span>Wanda.txt | xxd <span class="nt">-p</span> | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s1">'\n'</span> | <span class="nb">fold</span> <span class="nt">-w</span> 100

  496620796f752772652072656164696e6720746869732c20492073616372696669636564206d792074686f75676874732061
  6e64206d656d6f7269657320746f2070726f7465637420746865<mark>e2808ce2808ce2808ce2808ce2808de280ace280ace2808c</mark>
  204d696e64204567672e0a0a546f2070726f7465637420796f752e0a0a446f696e6720736f2077696c6c206d616b65206d65
  20666f7267657420796f7520616e64206576657279206d6f6d656e742077652068616420746f6765746865722e0a0a427574
  20646f696e6720736f20616c736f206769766573207573206d6f72652074696d6520746f207370656e64206e6577206d656d
  6f72696573206f6e6365207468697320697320616c6c206f7665722e0a0a0a4c6f76652c0a0a566963746f720a0a<mark>e2808ce2</mark>
  <span class="c"><mark>808ce2808ce2808ce2808de2808defbbbfefbbbf</mark>0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a<mark>e2808ce2808ce2808ce2</mark></span>
  <span class="c"><mark>808ce2808de280acefbbbfe2808d</mark>0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a<mark>e2808ce2808c</mark></span>
  <span class="c"><mark>e2808ce2808ce2808defbbbfe280ace2808d</mark>0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a</span>
  0a0a0a2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d<mark>e2808ce2808ce2808ce2808ce2808de2808defbbbfefbbbf</mark>2d2d
  2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d
  2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d0a456767736869656c64204167656e742c0a0a496620796f752772652072656164696e
  672074686973<mark>e2808ce2808ce2808ce2808ce2808de280acefbbbfe2808c</mark>2c20746865207365636f6e642070617274206f66
  207468652073656372657420697320696e20746869732066696c652e204c6f6f6b20636c6f73656c7920616e6420646f2069
  7420666173742120426f6e6e7920537461726b20616e64207468652077686f6c6520776f726c642069732077616974696e67
  2e0a0a546865206669727374206f6e652c2077656c6c2e2e20696620796f75<mark>e2808ce2808ce2808ce2808ce2808cefbbbfe2</mark>
  <span class="c"><mark>808ce2808c</mark>277265207265616c6c792066726f6d20456767736869656c6420796f752073686f756c642062652061626c6520</span>
  746f20666967757265206974206f75742e204c6574277320676f206261636b20696e2074696d65203a290a0a4f6e63652079
  6f7520<mark>e2808ce2808ce2808ce2808ce2808defbbbfe2808de280ac</mark>6861766520746865207365637265742c20757365207468
  617420746f206f70656e2074686520646565706573742070617274206f66206d79206d656d6f726965732e204d7920747265
  6173757265732e0a0a4c6173746c792c20706c6561736520646f2074656c6c20746865204176656e67657273746f2074616b
  652063617265206f662057616e646120666f72206d652e0a0a54696c6c207468656e2c0a566963746f72#<mark>e2808ce2808ce280</mark>
  <span class="c"><mark>8ce2808ce2808cefbbbfe2808cefbbbf</mark></span></code></pre>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>There are 9 hex strings consisting of the unicode characters&#8201;&#8212;&#8201;<span style="color:orange">e2808c</span>, <span style="color:orange">e2808d</span>, <span style="color:orange">e280ac</span>, <span style="color:orange">efbbbf</span>&#8201;&#8212;&#8201;that are scattered all over the text:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="listingblock">
<div class="content">
<pre>e2808c : U+200C : ZERO WIDTH NON-JOINER
e2808d : U+200D : ZERO WIDTH JOINER
e280ac : U+202C : POP DIRECTIONAL FORMATTING
efbbbf : U+FEFF : ZERO WIDTH NO-BREAK SPACE</pre>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><span style="color:orange">Zero width characters</span> are non-printing and if you search for how to hide text using such characters, you&#8217;ll come across this&#8201;&#8212;&#8201;<a href="https://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters</a>.</p>
</div>
<div class="paragraph">
<p>I recreated the process of encoding characters to zero width (for fun&#8217;s sake and this writeup) in order to find out how it works:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The zero width characters that will be used are set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="js"><span class="nx">chars</span> <span class="o">=</span> <span class="dl">'</span><span class="se">\</span><span class="s1">u200c</span><span class="se">\</span><span class="s1">u200d</span><span class="se">\</span><span class="s1">u202c</span><span class="se">\</span><span class="s1">ufeff</span><span class="dl">'</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>
<span class="c1">// chars = ['\u200c', '\u200d', '\u202c', '\ufeff'];</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, the following values are set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="js"><span class="nx">radix</span> <span class="o">=</span> <span class="nx">chars</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="c1">// radix = 4;</span>

<span class="nx">codelengthText</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">65536</span><span class="p">)</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">radix</span><span class="p">))</span>
<span class="c1">// codelengthText = 8;</span>

<span class="kd">var</span> <span class="nx">base</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">codelengthText</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span> <span class="nx">base</span> <span class="o">+=</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span>
<span class="c1">// base = '00000000';</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, to perform the encoding:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="js"><span class="nx">charToEncode</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">A</span><span class="dl">'</span><span class="p">;</span>
<span class="c1">// FOR EXAMPLE ONLY</span>

<span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">charToEncode</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="c1">// c = 65;</span>

<span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="nx">radix</span><span class="p">);</span>
<span class="c1">// d = c.toString(4);</span>
<span class="c1">// d = 1001;</span>
<span class="c1">// 65 was converted from decimal to base4</span>

<span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">(</span><span class="nx">base</span> <span class="o">+</span> <span class="nx">d</span><span class="p">).</span><span class="nx">substr</span><span class="p">(</span><span class="o">-</span><span class="nx">codelengthText</span><span class="p">);</span>
<span class="c1">// result = ('00000000' + 1001).substr(-8);</span>
<span class="c1">// result = '00001001';</span>

<span class="kd">var</span> <span class="nx">encodedCharacter</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">result</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nx">encodedCharacter</span> <span class="o">+=</span> <span class="nx">chars</span><span class="p">[</span><span class="nx">result</span><span class="p">[</span><span class="nx">i</span><span class="p">]];</span> <span class="p">}</span>
<span class="c1">// encodedCharacter = '\u200c\u200c\u200c\u200c\u200d\u200c\u200c\u200d'</span>
<span class="c1">// or in hex:</span>
<span class="c1">// encodedCharacter = 'e2808ce2808ce2808ce2808ce2808de2808ce2808ce2808d'</span></code></pre>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>And true enough when reversing the process after gathering the hex strings from the hexdump earlier:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="n">characters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">"e2808c e2808c e2808c e2808c e2808d e280ac e280ac e2808c"</span><span class="p">,</span>
    <span class="s">"e2808c e2808c e2808c e2808c e2808d e2808d efbbbf efbbbf"</span><span class="p">,</span>
    <span class="s">"e2808c e2808c e2808c e2808c e2808d e280ac efbbbf e2808d"</span><span class="p">,</span>
    <span class="s">"e2808c e2808c e2808c e2808c e2808d efbbbf e280ac e2808d"</span><span class="p">,</span>
    <span class="s">"e2808c e2808c e2808c e2808c e2808d e2808d efbbbf efbbbf"</span><span class="p">,</span>
    <span class="s">"e2808c e2808c e2808c e2808c e2808d e280ac efbbbf e2808c"</span><span class="p">,</span>
    <span class="s">"e2808c e2808c e2808c e2808c e2808c efbbbf e2808c e2808c"</span><span class="p">,</span>
    <span class="s">"e2808c e2808c e2808c e2808c e2808d efbbbf e2808d e280ac"</span><span class="p">,</span>
    <span class="s">"e2808c e2808c e2808c e2808c e2808c efbbbf e2808c efbbbf"</span>
<span class="p">]</span>

<span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="s">"e2808c"</span><span class="p">,</span> <span class="s">"e2808d"</span><span class="p">,</span> <span class="s">"e280ac"</span><span class="p">,</span> <span class="s">"efbbbf"</span><span class="p">]</span>

<span class="n">secret</span> <span class="o">=</span> <span class="s">""</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">characters</span><span class="p">:</span>

    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">" "</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)):</span>
        <span class="n">i</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">subs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span>

    <span class="n">secret</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">secret</span><span class="p">)</span> <span class="c1"># h_my_l0v3</span></code></pre>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The second part of the secret is revealed to be <span style="color:orange">h_my_l0v3</span>!!</p>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="part-3-visions-memory">PART 3 : VISION&#8217;S MEMORY</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s run the file, <span style="color:orange">vision</span>, in <span style="color:orange">volatility</span> to see if it&#8217;s a memory dump then gather information about the image</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>volatility <span class="nt">-f</span> vision imageinfo

  Volatility Foundation Volatility Framework 2.6
  INFO    : volatility.debug    : Determining profile based on KDBG search...
            Suggested Profile<span class="o">(</span>s<span class="o">)</span> : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_24000, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_24000, Win7SP1x64_23418
                       AS Layer1 : WindowsAMD64PagedMemory <span class="o">(</span>Kernel AS<span class="o">)</span>
                       AS Layer2 : FileAddressSpace <span class="o">(</span>.../mind/vision<span class="o">)</span>
                        PAE <span class="nb">type</span> : No PAE
                             DTB : 0x187000L
                            KDBG : 0xf80002c0f0a0L
            Number of Processors : 1
       Image Type <span class="o">(</span>Service Pack<span class="o">)</span> : 1
                  KPCR <span class="k">for </span>CPU 0 : 0xfffff80002c10d00L
               KUSER_SHARED_DATA : 0xfffff78000000000L
             Image <span class="nb">date </span>and <span class="nb">time</span> : 2020-04-10 14:11:55 UTC+0000
       Image <span class="nb">local date </span>and <span class="nb">time</span> : 2020-04-10 22:11:55 +0800</code></pre>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>According to <span style="color:orange"><code>To Wanda.txt</code></span>, "Let&#8217;s go back in time :)" after which we could open his <span style="color:orange">treasures</span> once we complete the secret:</p>
</div>
<div class="paragraph">
<p>In order to gather leads, I first checked what processes were running using <span style="color:orange"><code>pstree</code></span> then find something I could relate to going back in time:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>volatility <span class="nt">-f</span> vision <span class="nt">--dtb</span><span class="o">=</span>0x187000 <span class="nt">--kdbg</span><span class="o">=</span>0xf80002c0f0a0 <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 pstree

  Volatility Foundation Volatility Framework 2.6
  Name                                                  Pid   PPid   Thds   Hnds Time
  <span class="nt">--------------------------------------------------</span> <span class="nt">------</span> <span class="nt">------</span> <span class="nt">------</span> <span class="nt">------</span> <span class="nt">----</span>
  <span class="nt">---omitted---</span>
  <span class="nb">.</span> 0xfffffa80036ff770:cmd.exe                         2484    516      1     22 2020-04-10 14:06:58 UTC+0000
  <span class="nt">---omitted---</span>
   0xfffffa8001d82b30:firefox.exe                      2836   2868     75   1383 2020-04-10 14:08:51 UTC+0000
  <span class="nb">.</span> 0xfffffa80034f8b30:firefox.exe                     2188   2836     25    350 2020-04-10 14:08:54 UTC+0000
  <span class="nb">.</span> 0xfffffa800198cb30:firefox.exe                     2668   2836     11    292 2020-04-10 14:08:53 UTC+0000
  <span class="nb">.</span> 0xfffffa8003021060:firefox.exe                     3116   2836     24     65 2020-04-10 14:12:11 UTC+0000
  <span class="nb">.</span> 0xfffffa8001934b30:firefox.exe                     3296   2836     34    387 2020-04-10 14:09:26 UTC+0000
  <span class="nb">.</span> 0xfffffa8001928b30:firefox.exe                     1332   2836     21    318 2020-04-10 14:08:55 UTC+0000
  <span class="nb">.</span> 0xfffffa8003522b30:firefox.exe                     3000   2836     24    334 2020-04-10 14:12:07 UTC+0000
  <span class="nb">.</span> 0xfffffa80024ab060:firefox.exe                     4060   2836     27    337 2020-04-10 14:12:04 UTC+0000
  <span class="nb">.</span> 0xfffffa800365db30:firefox.exe                     4052   2836     25    353 2020-04-10 14:11:59 UTC+0000
  <span class="nb">.</span> 0xfffffa80034e0b30:firefox.exe                     3460   2836     21    318 2020-04-10 14:08:58 UTC+0000
  <span class="nb">.</span> 0xfffffa8003282b30:firefox.exe                     1960   2836     28    324 2020-04-10 14:11:02 UTC+0000
  <span class="nt">---omitted---</span></code></pre>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The processes&#8201;&#8212;&#8201;<span style="color:orange"><code>cmd.exe</code></span> and <span style="color:orange"><code>firefox.exe</code></span> caught my attention since if going back in time is considered to having "history", then this two should be prime candidates.</p>
</div>
<div class="paragraph">
<p>Next thing I did was to dump the process memory of <span style="color:orange"><code>firefox.exe</code></span> to see if I can find recently accessed webpages:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>volatility <span class="nt">-f</span> vision <span class="nt">--dtb</span><span class="o">=</span>0x187000 <span class="nt">--kdbg</span><span class="o">=</span>0xf80002c0f0a0 <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 memdump <span class="nt">-D</span> ./ <span class="nt">-p</span> 2836

  Volatility Foundation Volatility Framework 2.6
  <span class="nt">------------------------------------------------------------------------</span>
  Writing firefox.exe <span class="o">[</span>  2836] to 2836.dmp

<span class="nv">$ </span>strings 2836.dmp | <span class="nb">grep</span> <span class="nt">-e</span> <span class="s2">"^http.-treasure"</span> | <span class="nb">sort</span> | <span class="nb">uniq

  </span>https://s7.addthis.com/static/sh.f48a1a04fe8dbf021b4cda1d.html#rand<span class="o">=</span>0.7661267717714668&amp;iit<span class="o">=</span>1586527975883&amp;tmr<span class="o">=</span>load%3D1586527971495%26core%3D1586527971558%26main%3D1586527975877%26ifr%3D1586527975893&amp;cb<span class="o">=</span>0&amp;cdn<span class="o">=</span>0&amp;md<span class="o">=</span>0&amp;kw<span class="o">=</span>upload%20files%2Cfile%20hosting%2Cfile%20sharing%2Csend%20files&amp;ab<span class="o">=</span>-&amp;dh<span class="o">=</span>uploadfiles.io&amp;dr<span class="o">=</span>&amp;du<span class="o">=</span>https%3A%2F%2Fuploadfiles.io%2Fkiyqnnt9&amp;href<span class="o">=</span>https%3A%2F%2Fuploadfiles.io%2Fkiyqnnt9&amp;dt<span class="o">=</span>Upload%20files%20for%20free%20-%20my_treasures%20-%20Uploadfiles.io&amp;dbg<span class="o">=</span>0&amp;cap<span class="o">=</span>tc%3D0%26ab%3D0&amp;inst<span class="o">=</span>1&amp;jsl<span class="o">=</span>1&amp;prod<span class="o">=</span>undefined&amp;lng<span class="o">=</span>en&amp;ogt<span class="o">=</span>description%2Cimage%2Ctitle%2Curl%2Csite_name%2Ctype%3DFile%20storage%20and%20sharing&amp;pc<span class="o">=</span>men&amp;pub<span class="o">=</span>ra-56b61b1b0db9758f&amp;ssl<span class="o">=</span>1&amp;sid<span class="o">=</span>5e907ee30dfa06af&amp;srf<span class="o">=</span>0.01&amp;ver<span class="o">=</span>300&amp;xck<span class="o">=</span>0&amp;xtr<span class="o">=</span>0&amp;og<span class="o">=</span><span class="nb">type</span>%3DFile%2520storage%2520and%2520sharing%26site_name%3DUpload%2520Files%26url%3Dhttps%253A%252F%252Fuploadfiles.io%26title%3DUpload%2520files%2520for%2520free%2520-%2520my_treasures%2520-%2520Uploadfiles.io%26image%3Dhttps%253A%252F%252Fuploadfiles.io%252Fassets%252Fimg%252Ficons%252Fwidget.svg%26description%3DUpload%2520files%252C%2520for%2520free%252C%2520securely%252C%2520anonymously%252C%2520without%2520limits.%2520%2540UploadFilesFree&amp;csi<span class="o">=</span>undefined&amp;rev<span class="o">=</span>v8.28.3-wp&amp;ct<span class="o">=</span>1&amp;xld<span class="o">=</span>1&amp;xd<span class="o">=</span>1
  <span class="c"><mark>https://uploadfiles.io/kiyqnnt9</mark>Upload files for free - <mark>my_treasures</mark> - Uploadfiles.iooi.selifdaolpu.</span>
  https://www.google-analytics.com/collect?v<span class="o">=</span>1&amp;_v<span class="o">=</span>j81&amp;a<span class="o">=</span>894596498&amp;t<span class="o">=</span>timing&amp;_s<span class="o">=</span>2&amp;dl<span class="o">=</span>https%3A%2F%2Fuploadfiles.io%2Fkiyqnnt9&amp;ul<span class="o">=</span>en-gb&amp;de<span class="o">=</span>UTF-8&amp;dt<span class="o">=</span>Upload%20files%20for%20free%20-%20my_treasures%20-%20Uploadfiles.io&amp;sd<span class="o">=</span>24-bit&amp;sr<span class="o">=</span>2240x1400&amp;vp<span class="o">=</span>2007x1289&amp;je<span class="o">=</span>0&amp;plt<span class="o">=</span>7996&amp;pdt<span class="o">=</span>0&amp;dns<span class="o">=</span>0&amp;rrt<span class="o">=</span>0&amp;srt<span class="o">=</span>333&amp;tcp<span class="o">=</span>0&amp;dit<span class="o">=</span>6184&amp;clt<span class="o">=</span>7092&amp;_gst<span class="o">=</span>8001&amp;_gbt<span class="o">=</span>8556&amp;_u<span class="o">=</span>AACAAEAB~&amp;jid<span class="o">=</span>&amp;gjid<span class="o">=</span>&amp;cid<span class="o">=</span>1925544683.1586512461&amp;tid<span class="o">=</span>UA-73416834-1&amp;_gid<span class="o">=</span>1259732472.1586512461&amp;z<span class="o">=</span>1308647110</code></pre>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>I found a URL that lets you download a file, <span style="color:orange"><code>my_treasures</code></span>:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="imageblock">
<div class="content">
<img src="./screenshots/mind_my_treasures.png" alt="mind my treasures">
</div>
</div>
<div class="paragraph">
<p>Once downloaded:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>file my_treasures

  my_treasures: Zip archive data, at least v2.0 to extract

<span class="nv">$ </span>unzip my_treasures

  Archive:  my_treasures
  <span class="o">[</span>my_treasures] mytreasures/00b7580c843db8b527c63f0d44496101.raw password:</code></pre>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>It&#8217;s asking for a password but we only have the second part of the secret; however, we haven&#8217;t checked <span style="color:orange"><code>cmd.exe</code></span> yet:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>volatility <span class="nt">-f</span> vision <span class="nt">--dtb</span><span class="o">=</span>0x187000 <span class="nt">--kdbg</span><span class="o">=</span>0xf80002c0f0a0 <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 cmdscan

  Volatility Foundation Volatility Framework 2.6
  <span class="nt">--------------------------------------------------</span>
  CommandProcess: conhost.exe Pid: 2936
  CommandHistory: 0x6d140 Application: cmd.exe Flags: Allocated, Reset
  CommandCount: 5 LastAdded: 4 LastDisplayed: 4
  FirstCommand: 0 CommandCountMax: 50
  ProcessHandle: 0x60
  Cmd <span class="c"><mark>0 @ 0x6bbc0: cd C:\Users</span>
  Cmd <span class="c">#1 @ 0x6bbe0: cd vshade</span>
  Cmd <span class="c">#2 @ 0x6bc00: cd Desktop</span>
  Cmd <span class="c">#3 @ 0x4d050: echo "<mark>MUlPdVg1dTsybDJldW9MPSg/SkJGIy11bURKc2AvQDdHMyU3ODczKEByMg==</mark>"</span>
  Cmd <span class="c">#4 @ 0x4d2f0: winpmem-2.1.post4.exe -o output.aff4</span>
  Cmd <span class="c">#15 @ 0x30158: </span>
  Cmd <span class="c">#16 @ 0x6c2b0: </span>
  <span class="nt">--------------------------------------------------</span>
  CommandProcess: conhost.exe Pid: 2936
  CommandHistory: 0x71e00 Application: winpmem-2.1.post4.exe Flags: Allocated
  CommandCount: 0 LastAdded: <span class="nt">-1</span> LastDisplayed: <span class="nt">-1</span>
  FirstCommand: 0 CommandCountMax: 50
  ProcessHandle: 0x8c

<span class="nv">$ </span><span class="nb">echo </span>MUlPdVg1dTsybDJldW9MPSg/SkJGIy11bURKc2AvQDdHMyU3ODczKEByMg<span class="o">==</span> | <span class="nb">base64</span> <span class="nt">-d</span>

  1IOuX5u<span class="p">;</span><span class="nv">2l2euoL</span><span class="o">=(</span>?JBF</mark>-umDJs<span class="sb">`</span>/@7G3%7873<span class="o">(</span>@r2</code></pre>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The decoded base64 is gibberish but we almost forgot that there was a given <span style="color:orange"><code>hint.txt</code></span> in this challenge:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span><span class="nb">cat </span>hint.txt

  def -&gt; 58 -&gt; 85 -&gt; 64 -&gt; ?</code></pre>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Since the one we found at the memory dump was base64 encoded and the last number in the string is 64, this must be the process on how the first part of the secret was encoded:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="imageblock">
<div class="content">
<img src="./screenshots/mind_hint.png" alt="mind hint">
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>We now have the first and second halves of the secret&#8201;&#8212;&#8201;<span style="color:orange"><code>sc4rl37_w1tch_my_l0v3</code></span>!!</p>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="part-4-getting-the-flag">PART 4 : GETTING THE FLAG</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using the secret to extract the contents of <span style="color:orange"><code>my_treasures</code></span>:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>unzip my_treasures

  Archive:  my_treasures
  <span class="o">[</span>my_treasures] mytreasures/00b7580c843db8b527c63f0d44496101.raw password: sc4rl37_w1tch_my_l0v3
  <span class="nt">---omitted---</span></code></pre>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>There are a lot of files extracted but one file seems to have a longer filename than the others:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-Al</span>

  <span class="nt">---omitted---</span>
  <span class="nt">-rwxrwxrwx</span> 1 jebidiah jebidiah    9082 Apr 10 16:44 e1eb1281e3015390f37b03f0282b6623.raw
  <span class="nt">-rwxrwxrwx</span> 1 jebidiah jebidiah    1976 Apr 10 16:44 e24ff82569798c5e4b9fa1bb424404e8.raw
  <span class="nt">-rwxrwxrwx</span> 1 jebidiah jebidiah   31287 Apr 10 17:21 <span class="c"><mark>e25463c82c609c52547f8f1523ff47833b6</mark>.raw</span>
  <span class="nt">-rwxrwxrwx</span> 1 jebidiah jebidiah  279411 Apr 10 17:24 e26bbe7ada21e4e5e18bbc9bd974796c.raw
  <span class="nt">-rwxrwxrwx</span> 1 jebidiah jebidiah    6695 Apr 10 16:44 e2899df66e8851d71d599f3576d41894.raw
  <span class="nt">---omitted---</span></code></pre>
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>When opened, it gives us an egg with a QR code:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="imageblock">
<div class="content">
<img src="./screenshots/e25463c82c609c52547f8f1523ff47833b6.raw" alt="e25463c82c609c52547f8f1523ff47833b6">
</div>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Which when scanned gives us the flag!!</p>
</div>
<hr>
<div style="width:100%;overflow-x:auto"><h2>FLAG : <strong>rc_easter{y0u_c0uld_n3veR_huRt_m3_I_ju57_f33l_y0u}</strong></h2></div>
</div>
</div></section>
       </div>
    </div>

    <script>
      function openNav() {
        document.getElementById("sidebar").style.width = "250px";
        document.getElementById("content").style.marginLeft = "250px";
      }
      function closeNav() {
        document.getElementById("sidebar").removeAttribute("style");
        document.getElementById("content").removeAttribute("style");
      } 
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'true', 'auto');
        ga('send', 'pageview');
      </script>
    
  </body>
</html>
